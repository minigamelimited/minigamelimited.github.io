System.register("chunks:///_virtual/AdManager.ts",["cc","./MsgHints.ts","./NetControl.ts","./AudioMgr.ts"],(function(o){var e,i,t,n,a;return{setters:[function(o){e=o.cclegacy,i=o.sys},function(o){t=o.default},function(o){n=o.default},function(o){a=o.AudioMgr}],execute:function(){e._RF.push({},"01ed5KGsiRAmqPTbyAl4/km","AdManager",void 0);var d=window.wx||window.uc||window.tt,r=o("default",function(){function o(){}return o.share=function(e,t){void 0===e&&(e=null),void 0===t&&(t=!0),i.isBrowser?e(0):i.platform==i.Platform.WECHAT_GAME&&(d.shareAppMessage({title:"一起来消灭僵尸，拯救世界吧！",imageUrl:t?"":"icon.png",success:function(){},fail:function(){}}),o.onShowGame(e))},o.onShowGame=function(e){var i=this;console.log("---游戏回到前台---------------"),o.shareStartTimeSecond=performance.now();window.wx.onShow((function n(a){var d=!1;if(i.shareStartTimeSecond<=0);else{var r=performance.now()-i.shareStartTimeSecond;if(i.shareStartTimeSecond=-1,r>=3e3)d=!0;else{var s=Math.floor(Math.random()*o.msgs.length);t.show(o.msgs[s])}}e(d?0:-1),window.wx.offShow(n)}))},o.onShow=function(o){i.platform==i.Platform.WECHAT_GAME&&d.onShow((function(){o&&o()}))},o.showShareMenu=function(){window.wx&&(d.showShareMenu({menus:["shareAppMessage","shareTimeline"],withShareTicket:!0}),d.onShareAppMessage((function(){return{}})))},o.jump=function(o){window.wx&&d.navigateToMiniProgram({appId:o,path:"",extraData:null,envVersion:"release",success:function(o){console.log("跳转成功")}})},o.showTip=function(o){window.wx&&d.showToast({title:o,icon:"none",duration:1500})},o.initInterstitialAd=function(){var o=this;if(d&&d.createInterstitialAd){if(window.tt&&(this.CHAPIN_ID="2949g04fr05d8hr3bj"),this.interstitialAd=d.createInterstitialAd({adUnitId:this.CHAPIN_ID}),!this.interstitialAd)return;this.interstitialAd.onLoad((function(){console.log("插屏初始化成功"),o.showInterstitialAd()})),this.interstitialAd.onError((function(o){console.log("interstitialAd onError event emit",o)})),this.interstitialAd.onClose((function(o){console.log("interstitialAd onClose event emit",o)}))}},o.showInterstitialAd=function(){this.interstitialAd&&Date.now()-this.lastshowmaregame>9e4&&(this.lastshowmaregame=Date.now(),this.interstitialAd.show())},o.initGridAd=function(){var o=this;if(window.tt){var e=d.getSystemInfoSync(),i=d.createBannerAd({adUnitId:"253b14fjwljn3gkuir",style:{top:e.windowHeight-90,left:(e.windowWidth-290)/2}});i.onLoad((function(){console.log("banner 加载完毕"),i.show()})),i.onError((function(o){console.log("banner 错误",o)}))}else if(window.wx){var t=d.getSystemInfoSync();if(d.createGridAd){var n=d.createCustomAd({adUnitId:this.GRID_ID,adIntervals:30,style:{top:t.windowHeight-120,left:0}});n.onError((function(e){console.log("格子广告初始化错误",e),e.errCode>=1e3&&e.errCode<=1008&&(o.gridAdLoaded=!1)})),n.show().catch((function(o){console.error("格子广告显示错误",o)}))}var a=d.createCustomAd({adUnitId:this.GRID_ID2,adIntervals:30,style:{top:t.windowHeight-120,left:t.windowWidth-80}});a.onError((function(e){console.log("格子广告初始化错误",e),e.errCode>=1e3&&e.errCode<=1008&&(o.gridAdLoaded=!1)})),a.show().catch((function(o){console.error("格子广告显示错误",o)}));var r=d.getSystemInfoSync();this.gridAdMoreGame=d.createCustomAd({adUnitId:this.AD_MORE_GAME_ID,adIntervals:30,style:{top:r.windowHeight/4,left:0}}),this.gridAdMoreGame.onError((function(o){console.log("格子广告初始化错误",o)})),setTimeout((function(){}),15e4)}else if(window.uc){var s=d.createBannerAd({style:{gravity:7}});s.onLoad((function(){s.show()}))}},o.showMoreGame=function(o){void 0===o&&(o=0),this.gridAdMoreGame&&Date.now()-this.lastshowmaregame>3e4&&(this.lastshowmaregame=Date.now(),this.gridAdMoreGame.show()),o>0&&setTimeout((function(){}),o)},o.hideMoreGame=function(){null!=this.gridAdMoreGame&&this.gridAdMoreGame.hide()},o.showVideo=function(e){var i=this;this.videoCall=e,this.videoAd&&this.videoAd.show().catch((function(){i.videoAd.load().then((function(){return i.videoAd.show()})).catch((function(e){console.log("激励视频 广告显示失败",e),i.showTip("暂无视频可用！"),o.share((function(o){i.videoCall&&i.videoCall(o)}))}))}))},o.initVideo=function(){var o=this;if(window.uc){if(null!=this.videoAd)return;console.log("创建广告2");var e=d.createRewardVideoAd();this.videoAd=e,e.onLoad((function(){console.log("激励视频 广告加载成功")})),e.onError((function(e){console.log(e),o.videoCall&&o.videoCall(-1)})),e.onClose((function(e){e&&e.isEnded||void 0===e?o.videoCall&&o.videoCall(0):o.videoCall&&o.videoCall(-1)}))}else if(window.tt){if(null!=this.videoAd)return;console.log("创建广告2");var i=d.createRewardedVideoAd({adUnitId:"2212g3h92b7e4kd3le"});this.videoAd=i,i.onLoad((function(){console.log("激励视频 广告加载成功")})),i.onError((function(e){console.log(e),o.videoCall&&o.videoCall(-1)})),i.onClose((function(e){e&&e.isEnded||void 0===e?o.videoCall&&o.videoCall(0):o.videoCall&&o.videoCall(-1)}))}else if(window.wx){if(null!=this.videoAd)return;console.log("创建广告2");var t=d.createRewardedVideoAd({adUnitId:this.VIDEO_ID});this.videoAd=t,t.onLoad((function(){console.log("激励视频 广告加载成功")})),t.onError((function(e){console.log(e),o.videoCall&&o.videoCall(-1)})),t.onClose((function(e){e&&e.isEnded||void 0===e?o.videoCall&&o.videoCall(0):o.videoCall&&o.videoCall(-1)}))}},o.autoVide=function(o){if(!n.isContrilVersion()){if(Date.now()-this.lastautovideo<1e5)return;this.lastautovideo=Date.now(),this.showVideo(o)}},o.vibrateShort=function(){d&&a.Instance().vibrate&&d.vibrateShort()},o.vibrateLong=function(){d&&a.Instance().vibrate&&d.vibrateLong()},o}());r.bannerAd=null,r.videoAd=null,r.interstitialAd=null,r.gridAdLoaded=!0,r.gridAdMoreGame=null,r.gridBottom=null,r.VIDEO_ID="adunit-0a040b02a2532538",r.CHAPIN_ID="adunit-9e561f8f6ee4daf3",r.GRID_ID="adunit-f3cd4338e8e6fcb0",r.GRID_ID2="adunit-f3cd4338e8e6fcb0",r.AD_MORE_GAME_ID="adunit-dfdbba8928604d41",r.AD_BOTTOM_ID="adunit-335a7325587aaa5f",r.APPID="wxe41f506957fd4a0c",r.shareStartTimeSecond=0,r.msgs=["分享失败:需要分享到不同的群!","分享失败:请再尝试一下哦!",,"分享失败:请不要一直打扰一个群!"],r.lastshowmaregame=0,r.videoCall=null,r.lastautovideo=0,e._RF.pop()}}}));

System.register("chunks:///_virtual/AreaConfig.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ConfigAuto.ts"],(function(n){var t,e,o;return{setters:[function(n){t=n.inheritsLoose},function(n){e=n.cclegacy},function(n){o=n.AreaConfigAuto}],execute:function(){e._RF.push({},"28198n33p9HHZEJOqjOK+69","AreaConfig",void 0);n("default",function(n){function e(){return n.apply(this,arguments)||this}return t(e,n),e.prototype.getByName=function(n,t){return this.values.filter((function(e){return-1!=n.indexOf(e.room_name)&&e.map==t}))},e}(o));e._RF.pop()}}}));

System.register("chunks:///_virtual/AreaUnlockUI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./MeshText.ts","./Model.ts","./EventManager.ts","./Global.ts","./AudioMgr.ts","./Component.ts","./GameConst.ts","./GuideManager.ts"],(function(e){var t,n,a,o,r,s,i,c,u,l,h,m;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,a=e._decorator,o=e.v3},function(e){r=e.default},function(e){s=e.default},function(e){i=e.EventManager},function(e){c=e.Global},function(e){u=e.AudioMgr},function(e){l=e.default},function(e){h=e.default},function(e){m=e.default}],execute:function(){var d;n._RF.push({},"7dc3eGM3alPfaUMzs8iNaEk","AreaUnlockUI",void 0);var g=a.ccclass;a.property,e("AreaUnlockUI",g("AreaUnlockUI")(d=function(e){function n(){for(var t,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(t=e.call.apply(e,[this].concat(a))||this).meshtext=null,t.progress=null,t.area=null,t.putcashtime=0,t._bupgraded=!1,t}t(n,e);var a=n.prototype;return a.setMapItem=function(e){this.area=e,this.meshtext=this.node.getComponentInChildren(r),this.refreshUI()},a.refreshUI=function(){var e,t=this.area.id;s.game.roomUnlockPut[t]||(s.game.roomUnlockPut[t]=0),e=s.game.roomUnlockPut[t]/this.area.unlock_coin,this.meshtext.text=this.area.unlock_coin-s.game.roomUnlockPut[t]+"",this.progress&&this.progress.setScale(o(1,1,e))},a.putCash=function(){if(Date.now()-this.putcashtime<50)return!1;var e=this.area.id;this.putcashtime=Date.now(),s.game.roomUnlockPut[e]||(s.game.roomUnlockPut[e]=0);var t=0,n=this.area.unlock_coin-s.game.roomUnlockPut[e],a=Math.floor(n/10);return a>50&&(a=50),s.game.money>=a&&(t=a),a>s.game.money&&(t=s.game.money),a<10&&s.game.money>=10&&(t=10),a<1&&s.game.money>=1&&(t=1),a<1&&s.game.money>=1&&(t=1),t?(s.game.roomUnlockPut[e]+=t,s.game.money-=t,u.Instance().vibrateShort(),u.Instance().playSFX("papercup_edit"),this.refreshUI(),c.game.playMoneyAni(c.player.node.worldPosition.clone(),this.node.worldPosition.clone(),1)):i.Inst.event(h.EventType.NotEnoughMoney),s.game.roomUnlockPut[e]>=this.area.unlock_coin},a.playerStay=function(){this._bupgraded||this.putCash()&&(u.Instance().playSFX("UnlockSystem"),this._bupgraded=!0,-1==s.game.unlockAreaIds.indexOf(this.area.id)&&(s.game.unlockAreaIds.push(this.area.id),s.task.unlockArea(this.area.id),s.save(),i.Inst.event(h.EventType.EVT_UNLOCK_MAPITEM,this.area.id),m.Instance().onEventTrigger("unlockArea"+this.area.id)))},a.playerExit=function(){this._bupgraded=!1,s.save(),this.node.setScale(o(1.5,1.5,1.5))},a.playerEnter=function(){this._bupgraded=!1,this.node.setScale(o(1.8,1.8,1.8))},n}(l))||d);n._RF.pop()}}}));

System.register("chunks:///_virtual/AssetPool.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Singleton.ts","./ResHelper.ts","./Component.ts"],(function(e){var t,r,n,o,a,s,i,c,l,u,f;return{setters:[function(e){t=e.inheritsLoose,r=e.asyncToGenerator,n=e.regeneratorRuntime},function(e){o=e.cclegacy,a=e.instantiate,s=e.warn,i=e.NodePool,c=e.Prefab},function(e){l=e.default},function(e){u=e.default},function(e){f=e.default}],execute:function(){o._RF.push({},"be051UEjD1KrYkC682flmmr","AssetPool",void 0);e("default",function(e){function o(){for(var t,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(t=e.call.apply(e,[this].concat(n))||this).pools=new Map,t.prefabs=new Map,t}t(o,e);var l=o.prototype;return l.addPrefab=function(e,t){this.prefabs.has(t)||(e.addRef(),this.pools.has(t)||this.createPool(t),this.getPool(t).put(a(e)),this.prefabs.set(t,e))},l.clear=function(e){var t=this.getPool(e);t&&t.clear()},l.clearPrefabs=function(){var e=this;this.prefabs.forEach((function(t,r){t.decRef();var n=e.pools.get(r);n&&(n.clear(),e.pools.delete(r))})),this.prefabs.clear()},l.createObjAsync=function(){var e=r(n().mark((function e(t,r){var o;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.getPrefab(r)){e.next=6;break}return e.next=4,u.loadResSync(t,"game",c);case 4:o=e.sent,this.addPrefab(o,r);case 6:return e.abrupt("return",this.createObjWithPrefab(o,r));case 7:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),l.createObjWithPrefab=function(e,t){var r=this.get(t);if(r)return r;var n=a(e);return n.__pool__=t,n},l.createObject=function(e){var t=this.get(e);if(t)return t;var r=this.getPrefab(e);return r?(s(" createObject pool is empty, createObjWithPrefab",e),this.createObjWithPrefab(r,e)):(s("Can't createObject prefab is null",e),null)},l.createPool=function(e){console.log("创建对象池",e);var t=new i;return this.pools.set(e,t),t},l.get=function(e,t,r){void 0===t&&(t=null),void 0===r&&(r=null);var n=this.getPool(e,r),o=null;return n.size()>0&&((o=n.get(t)).__pool__=e),o},l.getPool=function(e,t){var r=this.pools.get(e);return r||(r=this.createPool(e)),r},l.getPrefab=function(e){return this.prefabs.get(e)},l.put=function(e){e instanceof f&&(e=e.node);var t=e.__pool__;if(t){var r=this.getPool(t);r&&r.put(e)}},l.removePool=function(e){this.pools.has(e)&&this.pools.delete(e)},o}(l));o._RF.pop()}}}));

System.register("chunks:///_virtual/AudioMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Singleton.ts","./ResHelper.ts","./Utils.ts"],(function(t){var i,o,u,e,n,s,r,c,d,a;return{setters:[function(t){i=t.inheritsLoose,o=t.createClass},function(t){u=t.cclegacy,e=t.Node,n=t.director,s=t.AudioSource,r=t.AudioClip},function(t){c=t.default},function(t){d=t.default},function(t){a=t.default}],execute:function(){u._RF.push({},"ed0870JtCdGf7Ss5iehiXNf","AudioMgr",void 0);t("AudioMgr",function(t){function u(){for(var i,o=arguments.length,u=new Array(o),e=0;e<o;e++)u[e]=arguments[e];return(i=t.call.apply(t,[this].concat(u))||this).bgmAudioSource=void 0,i.sfxAudioSource=void 0,i._music=1,i._vibrate=1,i._sound=1,i}i(u,t);var c=u.prototype;return c.init=function(){this.music=Number(a.getCache("music")||"1"),this.vibrate=Number(a.getCache("vibrate")||"1"),this.sound=Number(a.getCache("sound")||"1");var t=new e("AudioNode");n.getScene().addChild(t),this.bgmAudioSource=t.addComponent(s),this.bgmAudioSource.loop=!0,this.bgmAudioSource.volume=1,this.sfxAudioSource=t.addComponent(s),this.sfxAudioSource.volume=1},c.playBGM=function(t){var i=this;this.music&&this.loadAudio(t,(function(t){i.bgmAudioSource.clip=t,i.bgmAudioSource.play()}))},c.stopBGM=function(){var t;null==(t=this.bgmAudioSource)||t.stop()},c.playSFX=function(t,i){var o=this;void 0===i&&(i=1),this.sound&&this.loadAudio(t,(function(t){o.sfxAudioSource.clip=t,o.sfxAudioSource.playOneShot(t,i)}))},c.stopSFXAll=function(){this.sfxAudioSource.stop()},c.loadAudio=function(t,i,o){void 0===o&&(o="sounds"),d.loadRes(t,o,r,(function(o,u){o?console.error("Failed to load audio clip: "+t):i(u)}))},c.vibrateShort=function(){this.vibrate&&window.wx&&window.wx.vibrateShort({})},o(u,[{key:"sound",get:function(){return this._sound},set:function(t){this._sound=t,a.setCache("sound",t.toString())}},{key:"music",get:function(){return this._music},set:function(t){this._music=t,t?this.playBGM("Bgm"):this.stopBGM(),a.setCache("music",t.toString())}},{key:"vibrate",get:function(){return this._vibrate},set:function(t){this._vibrate=t,a.setCache("vibrate",t.toString())}}]),u}(c));u._RF.pop()}}}));

System.register("chunks:///_virtual/Barricade.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameConst.ts","./Global.ts","./AssetPool.ts","./Component.ts","./Config.ts","./Model.ts","./EventManager.ts","./AudioMgr.ts","./Room.ts","./RegionalEditor.ts","./BrokenAni.ts"],(function(e){var t,n,i,r,a,o,s,c,h,l,p,u,d,f,m,v,g,k,y;return{setters:[function(e){t=e.inheritsLoose,n=e.asyncToGenerator,i=e.regeneratorRuntime},function(e){r=e.cclegacy,a=e._decorator,o=e.v3,s=e.Vec3},function(e){c=e.UpgradeType,h=e.default},function(e){l=e.Global},function(e){p=e.default},function(e){u=e.default},function(e){d=e.default},function(e){f=e.default},function(e){m=e.EventManager},function(e){v=e.AudioMgr},function(e){g=e.Room},function(e){k=e.default},function(e){y=e.BrokenAni}],execute:function(){var b;r._RF.push({},"61568uhwX5L0ZJnVeq9IbeV","Barricade",void 0);var I=a.ccclass,B=(a.property,o());e("Barricade",I("Barricade")(b=function(e){function r(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).enemys=void 0,t.hp=0,t.maxHp=0,t.breakHp=0,t.breakCount=0,t.repairIcon=void 0,t.id=0,t.collider=void 0,t.bFirst=!1,t}t(r,e);var a=r.prototype;return a.onLoad=function(){var e=n(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l.map.barricades.push(this),this.collider=this.node.getChildByName("Collider"),e.next=4,p.Instance().createObjAsync("prefabs/game/TipNode","TipNode");case 4:(t=e.sent).parent=this.node,this.repairIcon=t,this.showRepairIcon();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),a.start=function(){var e=this.node.parent.getComponent(g);this.id=e.getRoomId();var t=f.game.upgradeLvInfo[c.BARRICADE],n=d.upgrade.get(c.BARRICADE).value[t-1];this.hp=this.maxHp=n;var i=this.GetGameObject("Planks");this.breakHp=Math.floor(this.maxHp/i.children.length);var r=f.game.barricadeHp[this.id];console.log(this.maxHp,this.breakHp,this.hp,r,this.id,f.game.barricadeHp,"--------------------------------"),null!=r&&(this.hp=r,this.initPlanks(),this.showRepairIcon(),0==this.hp&&this.removeBlock())},a.initPlanks=function(){console.log("initP");var e=this.GetGameObject("Planks");this.breakHp=Math.floor(this.maxHp/e.children.length);for(var t=0;t<e.children.length;t++){var n=e.children[t];this.hp>=(e.children.length-t)*this.breakHp?n.active=!0:n.active=!1}},a.update=function(e){this.repairIcon&&this.repairIcon.active&&!l.game.running&&(s.subtract(B,this.node.worldPosition,l.player.node.worldPosition),B.lengthSqr()<6&&(this.repairIcon.active=!1,this.repair()))},a.setEnemys=function(e){var t=this;if(this.node.activeInHierarchy){var n=f.game.upgradeLvInfo[c.BARRICADE],i=d.upgrade.get(c.BARRICADE).value[n-1];this.maxHp=i,this.enemys=e,this.bFirst=!0,this.breakCount=0,1==f.game.level&&1==f.game.currentWave?this.createEnemy():this.scheduleOnce((function(){t.createEnemy()}),2*Math.random()+1);var r=this.GetGameObject("Planks");this.breakHp=Math.floor(this.maxHp/r.children.length)}},a.createEnemy=function(){var e=n(i().mark((function e(){var t,n,r,a=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.enemys.pop(),n=this.node.parent.getChildByName("ZombieSpawnerArc").worldPosition,r=o(n.x+2*Math.random()-1,n.y,n.z+2*Math.random()-1),e.next=5,l.game.createEnemy(t,r,this,this.bFirst);case 5:this.bFirst=!1,this.enemys.length>0&&this.scheduleOnce((function(){a.createEnemy()}),.2*Math.random()+.1);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),a.damage=function(){if(0!=this.hp){this.hp--;for(var e=this.GetGameObject("Planks"),t=0;t<e.children.length;t++){var n=e.children[t];n.active&&this.hp<=(e.children.length-t-1)*this.breakHp&&this.playPlankBrokenAni(n)}0==this.hp&&(this.removeBlock(),this.node.emit(h.EventType.RemoveBarricade,this),v.Instance().playSFX("Barricade_Destruction_SFX"))}},a.playPlankBrokenAni=function(e){var t=e.children[0];(t.getComponent(y)||t.addComponent(y)).play(),v.Instance().playSFX("Barricade_Impact_SFX")},a.removeBlock=function(){this.GetGameObject("Mesh").getComponent(k).resetBlock(!1)},a.addBlock=function(){this.GetGameObject("Mesh").getComponent(k).resetBlock(!0)},a.repair=function(e){var t=this;void 0===e&&(e=!0),this.repairIcon.active=!1,this.hp=100;for(var n=this.GetGameObject("Planks"),i=function(i){t.scheduleOnce((function(){n.children[i].active=!0,n.children[i].children.forEach((function(e){e.setPosition(o()),e.setRotationFromEuler(0,0,0)})),e&&v.Instance().playSFX("Plank_Repair_SFX"),i==n.children.length-1&&m.Inst.event(h.EventType.onRepair)}),.1*i+.02)},r=0;r<n.children.length;r++)i(r);this.addBlock()},a.showRepairIcon=function(){if(this.repairIcon){this.repairIcon.active=!1;for(var e=this.GetGameObject("Planks"),t=0;t<e.children.length;t++)if(!e.children[t].active)return this.repairIcon.active=!0,!0;return!1}},a.checkNeedRepair=function(){for(var e=this.GetGameObject("Planks"),t=0;t<e.children.length;t++)if(!e.children[t].active)return!0;return!1},a.hideRepairIcon=function(){this.repairIcon.active=!1},a.isAlive=function(){return this.hp>0},a.updateBlock=function(){this.hp>0?this.addBlock():this.removeBlock()},r}(u))||b);r._RF.pop()}}}));

System.register("chunks:///_virtual/BarricadeIndicator.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Global.ts","./Component.ts"],(function(e){var t,r,a,i,n,o,c,s,d,l;return{setters:[function(e){t=e.inheritsLoose},function(e){r=e.cclegacy,a=e._decorator,i=e.v3,n=e.Camera,o=e.find,c=e.view,s=e.Vec3},function(e){d=e.Global},function(e){l=e.default}],execute:function(){var h;r._RF.push({},"16214d2gTlL5oXnPplaB5aw","BarricadeIndicator",void 0);var u=a.ccclass,v=(a.property,i()),p=i(),g=i();e("BarricadeIndicator",u("BarricadeIndicator")(h=function(e){function r(){for(var t,r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(t=e.call.apply(e,[this].concat(a))||this).bID=0,t.arrow=void 0,t.barricade=void 0,t}t(r,e);var a=r.prototype;return a.start=function(){},a.setBarricadeId=function(e){this.bID=e,this.arrow.active=!1,this.barricade=d.map.getBarricadeById(e)},a.checkInOutScreen=function(){d.camera.camera.getComponent(n).convertToUINode(this.barricade.node.worldPosition,o("Canvas"),v);var e=c.getVisibleSize().width,t=c.getVisibleSize().height;return v.x<.5*-e||v.x>.5*e||v.y<.5*-t||v.y>.5*t},a.update=function(e){if(d.game.running)this.arrow.active=!1;else if(this.barricade.checkNeedRepair()&&this.checkInOutScreen()){d.camera.camera.getComponent(n).convertToUINode(this.barricade.node.worldPosition,this.node.parent,v),s.subtract(p,v,g);var t=p.length();v.normalize();var r=180*Math.atan2(v.y,v.x)/Math.PI;this.arrow.angle=r+90,v.multiplyScalar(t);var a=c.getVisibleSize().width,i=c.getVisibleSize().height;v.x>.5*a-20?v.x=.5*a-20:v.x<.5*-a+20&&(v.x=.5*-a+20),v.y>.5*i-20?v.y=.5*i-20:v.y<.5*-i+20&&(v.y=.5*-i+20),this.node.setPosition(v),this.arrow.active=!0}else this.arrow.active=!1},r}(l))||h);r._RF.pop()}}}));

System.register("chunks:///_virtual/BaseCfg.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Utils.ts"],(function(n){var t,e,s,a,o;return{setters:[function(n){t=n.createClass},function(n){e=n.cclegacy,s=n.warn,a=n.JsonAsset},function(n){o=n.default}],execute:function(){e._RF.push({},"0b319K2eJxCnaFtTd0jcJAO","BaseCfg",void 0);n("default",function(){function n(){this._values=null,this.cfg=null,this.map=new Map,this._name=""}var e=n.prototype;return e.get=function(n){var t=this.map.get(n);return t||(s(n,"can not find",this._name),null)},e.load=function(n){var t=this;return this._name=n,new Promise((function(e,s){o.loadRes("configs/"+n,"game",a,(function(s,a){t.cfg=a.json,t.setData(t.cfg),console.log(n+"------------------------------loaded-------------"),e(null),t.onLoad()}))}))},e.onLoad=function(){},e.setData=function(n){},t(n,[{key:"values",get:function(){var n;return null!=(n=this._values)?n:this._values=Array.from(this.map.values())}}]),n}());e._RF.pop()}}}));

System.register("chunks:///_virtual/BasePanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./WindowManager.ts","./Component.ts"],(function(n){var t,e,o,c,a;return{setters:[function(n){t=n.inheritsLoose},function(n){e=n.cclegacy,o=n._decorator},function(n){c=n.default},function(n){a=n.default}],execute:function(){var i;e._RF.push({},"ff49cRscU5CRpveZdjuIATA","BasePanel",void 0);var r=o.ccclass;o.property,n("default",r("BasePanel")(i=function(n){function e(){for(var t,e=arguments.length,o=new Array(e),c=0;c<e;c++)o[c]=arguments[c];return(t=n.call.apply(n,[this].concat(o))||this).winInfo=void 0,t.data=void 0,t}t(e,n);var o=e.prototype;return o.onCreate=function(n){this.data=n},o.onShow=function(n){},o.onHide=function(){},o.close=function(n){void 0===n&&(n=!0),c.Instance().removeWindow(this.winInfo,n)},o.onRecycle=function(){},e}(a))||i);e._RF.pop()}}}));

System.register("chunks:///_virtual/BrokenAni.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(i){var t,n,o,e,s,r;return{setters:[function(i){t=i.inheritsLoose},function(i){n=i.cclegacy,o=i._decorator,e=i.v3,s=i.Vec3,r=i.Component}],execute:function(){var a;n._RF.push({},"0bb3dtaKRhF9Z9j29FhZcv7","BrokenAni",void 0);var l=o.ccclass,h=(o.property,e());i("BrokenAni",l("BrokenAni")(a=function(i){function n(){for(var t,n=arguments.length,o=new Array(n),e=0;e<n;e++)o[e]=arguments[e];return(t=i.call.apply(i,[this].concat(o))||this).rz=0,t.gravity=9.8,t.minY=.2,t.duration=3,t.elapsedTime=0,t._playing=!1,t.moveSpeed=3,t}t(n,i);var o=n.prototype;return o.start=function(){},o.play=function(){this._playing||(this._playing=!0,this.elapsedTime=0,h=e(-50,0,0))},o.update=function(i){this._playing&&(s.multiplyScalar(h,h,this.moveSpeed*i),h.y-=this.gravity*i,s.add(h,this.node.position,h),h.x*=.99,this.rz+=10*i,this.node.setRotationFromEuler(e(0,0,this.rz)),this.node.setPosition(h),this.node.worldPosition.y<this.minY&&(h.x=h.y=h.z=0,this.node.parent.active=!1,this._playing=!1,this.node.setWorldPosition(this.node.worldPosition.x,this.minY,this.node.worldPosition.z)),this.elapsedTime+=i)},n}(r))||a);n._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet.ts",["cc","./Utils.ts","./Global.ts","./AudioMgr.ts"],(function(t){var i,e,o,s,n,a;return{setters:[function(t){i=t.cclegacy,e=t.v3,o=t.Vec3},function(t){s=t.default},function(t){n=t.Global},function(t){a=t.AudioMgr}],execute:function(){i._RF.push({},"100bcHZDA1EYoIgoMjLlrTg","Bullet",void 0);var r=t("AttackMode",function(t){return t[t.Single=0]="Single",t[t.Area=1]="Area",t[t.Penetration=2]="Penetration",t[t.Fan=3]="Fan",t[t.Bounce=4]="Bounce",t}({})),h=e();t("Bullet",function(){function t(t,i,e,n,a){this.node=void 0,this.prefabName=void 0,this.initPos=void 0,this.mode=void 0,this.prop=void 0,this.sound=void 0,this.hitFX=void 0,this.beatBack=0,this.damage=1,this.targetZombie=void 0,this.speed=20,this.targetP=void 0,this.dir=void 0,this.velocity=void 0,this.worldPosition=void 0,this.lastPosition=void 0,this.hitTriggered=!1,this.delayTime=0,this.moveDisSQ=0,this.destroy=!1,this.hitedZombies=void 0,this.mode=t.attack_mode,this.prop=t.attack_prop,this.sound=t.ene_sound,this.hitFX=t.ene_particle,this.beatBack=t.break,this.targetZombie=e,this.speed=t.bullet_speed,this.prefabName=t.bullet_prefab,this.initPos=n,this.dir=a.clone(),o.normalize(this.dir,this.dir),this.targetP=this.targetZombie.node.worldPosition.clone(),this.targetP.y=.7,this.damage=i,o.add(this.targetP,new o(s.getRandom(-.2,.2),s.getRandom(.4,.7),s.getRandom(-.2,.2)),this.targetP),this.worldPosition=n.clone(),this.lastPosition=this.worldPosition.clone()}var i=t.prototype;return i.move=function(t){if(null!=this.node){if(this.delayTime>0&&(this.delayTime-=t),null==this.velocity&&(o.subtract(h,this.targetP,this.worldPosition),o.normalize(h,h),o.multiplyScalar(h,h,this.speed),this.velocity=h.clone()),o.multiplyScalar(h,this.velocity,t),this.lastPosition.x=this.worldPosition.x,this.lastPosition.y=this.worldPosition.y,this.lastPosition.z=this.worldPosition.z,this.worldPosition.x+=h.x,this.worldPosition.z+=h.z,this.worldPosition.y+=h.y,null!=this.node){if(this.mode==r.Bounce){var i=this.node.eulerAngles.clone();i.y+=9600*t,this.node.eulerAngles=i}this.node.worldPosition=this.worldPosition}this.moveDisSQ+=Math.sqrt(h.x*h.x+h.z*h.z)}},i.checkDestroy=function(){var t=20;return this.mode==r.Penetration&&(t=this.prop),this.destroy||this.moveDisSQ>=t},i.checkHit=function(){if(null==this.node)return!0;if(!this.targetZombie.isValid)return!0;var t=this.node.worldPosition.x-this.targetP.x,i=this.node.worldPosition.z-this.targetP.z;return t*t+i*i<.25},i.hitTarget=function(){var t=this;switch(this.mode){case r.Single:this.destroy=!0,this.targetZombie.isValid&&(this.targetZombie.onExplore(this.beatBack),this.targetZombie.onHit(this.damage));break;case r.Area:this.destroy=!0,n.game.getTargetZombies(this.worldPosition,this.prop).forEach((function(i){t.targetZombie.isValid&&(i.onExplore(t.beatBack,t.worldPosition.clone()),i.onHit(t.damage))})),a.Instance().vibrateShort();break;case r.Penetration:var i=n.game.getSegmentLineTouchZombies(this.lastPosition,this.worldPosition);this.hitedZombies=this.hitedZombies||[],i.forEach((function(i){t.hitedZombies.indexOf(i)<0&&(t.hitedZombies.push(i),i.onExplore(t.beatBack,t.initPos.clone()),i.onHit(t.damage))})),a.Instance().vibrateShort();break;case r.Fan:this.destroy=!0,n.game.getTargetFanZombies(n.player.node.worldPosition,5,this.prop,this.dir).forEach((function(i){i.onExplore(t.beatBack),i.onHit(t.damage)})),this.beatBack>=2&&a.Instance().vibrateShort();break;case r.Bounce:if(this.targetZombie.isValid&&(this.targetZombie.onHit(this.damage),this.targetZombie.onExplore(this.beatBack),this.prop--),this.prop>0){var e=n.game.getTargetZombies(this.worldPosition,5);if(null==e||0==e.length)this.destroy=!0;else{s.shuffle(e);var h=e[0];this.targetZombie=h,this.targetP=h.node.worldPosition.clone(),o.add(this.targetP,new o(s.getRandom(-.2,.2),s.getRandom(.5,.7),s.getRandom(-.2,.2)),this.targetP),this.moveDisSQ=0,this.velocity=null,this.delayTime=.2}}else this.destroy=!0}},t}());i._RF.pop()}}}));

System.register("chunks:///_virtual/BulletShell.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AssetPool.ts"],(function(t){var n,e,o,i,s,a,l,r;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator,i=t.randomRange,s=t.v3,a=t.tween,l=t.Component},function(t){r=t.default}],execute:function(){var u;e._RF.push({},"7f0b4RZz/xE7ZQDvb5l5Gq3","BulletShell",void 0);var c=o.ccclass;o.property,t("default",c(u=function(t){function e(){return t.apply(this,arguments)||this}return n(e,t),e.prototype.playDropAnimation=function(){var t=this,n=this.node.position,e=i(-1,1),o=i(-1,1),l=s(n.x+e,.03,n.z+o),u=l.clone();u.y=.03;var c=i(.5,.8);u.x+=e*c,u.z+=o*c;var p=u.clone().subtract(this.node.position).normalize(),h=Math.atan2(p.z,p.x);this.node.eulerAngles=s(0,180*-h/Math.PI,0),a(this.node).to(.3,{position:l},{easing:"sineIn"}).to(c+.5,{position:u},{easing:"sineOut"}).delay(.5).call((function(){r.Instance().put(t.node)})).start()},e}(l))||u);e._RF.pop()}}}));

System.register("chunks:///_virtual/BusyLoading.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,o,r,a,c,i;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,o=t._decorator,r=t.UIOpacity,a=t.tween,c=t.Tween,i=t.Component}],execute:function(){var s;n._RF.push({},"1ddc6UJScVI26dHuUma6MKs","BusyLoading",void 0);var u=o.ccclass;o.property,t("default",u(s=function(t){function n(){return t.apply(this,arguments)||this}return e(n,t),n.prototype.onEnable=function(){var t=this.node.getComponent(r);t.opacity=0,a(t).to(1,{opacity:255}).start();var e=this.node.getChildByName("node_circle");c.stopAllByTarget(e),a(e).by(1,{angle:-360}).repeatForever().start()},n}(i))||s);n._RF.pop()}}}));

System.register("chunks:///_virtual/BusyLoadingManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ResHelper.ts","./GameConst.ts","./WindowManager.ts"],(function(t){var i,n,e,s,a,u,o,r,l,c;return{setters:[function(t){i=t.createClass},function(t){n=t.cclegacy,e=t.Prefab,s=t.instantiate,a=t.Label,u=t.warn,o=t.isValid},function(t){r=t.default},function(t){l=t.E_UILAYER},function(t){c=t.default}],execute:function(){n._RF.push({},"20da07ITSRO35kKoKuf2Jo+","BusyLoadingManager",void 0);var h=t("BUSY_TYPE",function(t){return t[t.NET=0]="NET",t[t.RES=1]="RES",t}({}));t("default",function(){function t(){this.busyMap=new Map,this.loadingUI=void 0,this.timerID=null,this.delay=300}var n=t.prototype;return n.init=function(){var t=this;r.loadRes("prefabs/common/BusyLoading","game",e,(function(i,n){t.loadingUI=s(n),t.loadingUI.setSiblingIndex(999)}))},n.addBusy=function(t,i){if(void 0===i&&(i=""),null!=this.loadingUI){""==i&&(i=t==h.NET?"请稍后...":"正在加载资源..."),this.loadingUI.getChildByName("lbl_text").getComponent(a).string=i;var n=this.busyMap.get(t);n?this.busyMap.set(t,n+1):this.busyMap.set(t,1),this.checkBusy()}else this.init()},n.removeBusy=function(t){var i=this.busyMap.get(t);i?this.busyMap.set(t,i-1):u("error",t),this.checkBusy()},n.checkBusy=function(){var t=this;if(null!=this.loadingUI&&o(this.loadingUI))if(this.getBusyCount()>0){var i=this,n=function(){t.getBusyCount()>0?i.updateTips():u("error 0"),t.timerID=null};this.timerID?(clearTimeout(this.timerID),this.timerID=setTimeout(n,this.delay)):this.loadingUI.parent?this.updateTips():(this.loadingUI.parent=c.Instance().getLayer(l.top),this.timerID=setTimeout(n,this.delay))}else this.timerID&&(clearTimeout(this.timerID),this.timerID=0),this.loadingUI.parent&&this.loadingUI.removeFromParent();else this.init()},n.updateTips=function(){},n.getBusyCount=function(){var t=0;return this.busyMap.forEach((function(i,n){t+=i})),t},i(t,null,[{key:"ins",get:function(){return null==t.instance&&(t.instance=new t),t.instance}}]),t}()).instance=null,n._RF.pop()}}}));

System.register("chunks:///_virtual/CCEx.ts",["cc","./AudioMgr.ts"],(function(){var t,n,o;return{setters:[function(o){t=o.cclegacy,n=o.Button},function(t){o=t.AudioMgr}],execute:function(){t._RF.push({},"43379vrVqRF/aQOfg3o5e69","CCEx",void 0);var c=n.prototype._onTouchEnded;n.prototype._onTouchEnded=function(t){o.Instance().playSFX("Button"),c.call(this,t)},t._RF.pop()}}}));

System.register("chunks:///_virtual/Cell.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var s,o,i,e;return{setters:[function(t){s=t.createClass},function(t){o=t.cclegacy,i=t._decorator,e=t.Vec2}],execute:function(){o._RF.push({},"c030eEm5m1FWZo663UT6VSX","Cell",void 0);i.ccclass,i.property,t("Cell",function(){function t(t,s,o){this.wp=void 0,this.row=void 0,this.col=void 0,this.cost=1,this.bestCost=void 0,this.bestDir=void 0,this.wp=t,this.row=s,this.col=o,this.cost=1,this.bestCost=255,this.bestDir=e.ZERO}var o=t.prototype;return o.increaseCost=function(t){255!=this.cost&&(this.cost+t>255?this.cost=255:this.cost+=t)},o.clone=function(){var s=new t(this.wp.clone(),this.row,this.col);return s.cost=this.cost,s.bestCost=this.bestCost,s.bestDir=this.bestDir.clone(),s},s(t,[{key:"isBlock",get:function(){return 255==this.cost}}]),t}());o._RF.pop()}}}));

System.register("chunks:///_virtual/Coin.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Global.ts","./AssetPool.ts","./AudioMgr.ts"],(function(o){var t,n,e,i,r,s,a,l,d,c,u;return{setters:[function(o){t=o.inheritsLoose},function(o){n=o.cclegacy,e=o._decorator,i=o.v3,r=o.quat,s=o.tween,a=o.Vec3,l=o.Component},function(o){d=o.Global},function(o){c=o.default},function(o){u=o.AudioMgr}],execute:function(){var p;n._RF.push({},"30e0fDiYKRH4ZdDdYqwBaGD","Coin",void 0);var h=e.ccclass,f=(e.property,i()),y=i();r(),r(),o("Coin",h("Coin")(p=function(o){function n(){for(var t,n=arguments.length,e=new Array(n),r=0;r<n;r++)e[r]=arguments[r];return(t=o.call.apply(o,[this].concat(e))||this).bol=!1,t.speed=20,t.rSpeed=i(),t.lastPlaySound=0,t}t(n,o);var e=n.prototype;return e.start=function(){},e.startUp=function(o){var t=this;this.rSpeed.set(1440*Math.random()-720,1440*Math.random()-720,1440*Math.random()-720),s(this.node).to(.25,{worldPosition:o.clone(),eulerAngles:this.rSpeed.clone()}).call((function(){t.bol=!0})).start()},e.update=function(o){if(this.bol){if(a.squaredDistance(d.player.node.worldPosition.clone().add(i(0,1,0)),this.node.worldPosition)<.1)return c.Instance().put(this.node),void(performance.now()-this.lastPlaySound>300&&("coin"==this.node.name?u.Instance().playSFX("Get_Coin"):u.Instance().playSFX("GetGem"),this.lastPlaySound=performance.now()));a.subtract(f,d.player.node.worldPosition.clone().add(i(0,1,0)),this.node.worldPosition),a.normalize(f,f),a.multiplyScalar(y,this.rSpeed,o),a.add(y,this.node.eulerAngles,y),this.node.setRotationFromEuler(y),a.multiplyScalar(f,f,this.speed*o),a.add(f,this.node.worldPosition,f),this.node.worldPosition=this.node.worldPosition.lerp(f,.5)}},n}(l))||p);n._RF.pop()}}}));

System.register("chunks:///_virtual/CoinUI.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var n,o,r,e;return{setters:[function(t){n=t.inheritsLoose},function(t){o=t.cclegacy,r=t._decorator,e=t.Component}],execute:function(){var i;o._RF.push({},"8d7a58x2ypBa6jDt1f8jxZ8","CoinUI",void 0);var c=r.ccclass;r.property,t("CoinUI",c("CoinUI")(i=function(t){function o(){return t.apply(this,arguments)||this}n(o,t);var r=o.prototype;return r.start=function(){},r.update=function(t){},o}(e))||i);o._RF.pop()}}}));

System.register("chunks:///_virtual/Component.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./ResHelper.ts","./LinkPrefab.ts","./List.ts"],(function(t){var e,n,o,i,s,r,a,c,l,h,u,m,g,p,f,d,b,v,C,j,_,G,k,S,B;return{setters:[function(t){e=t.inheritsLoose,n=t.createForOfIteratorHelperLoose},function(t){o=t.cclegacy,i=t._decorator,s=t.Component,r=t.js,a=t.Button,c=t.ScrollView,l=t.PageView,h=t.ToggleContainer,u=t.Toggle,m=t.sp,g=t.Sprite,p=t.Label,f=t.ProgressBar,d=t.assetManager,b=t.SpriteFrame,v=t.isValid,C=t.find,j=t.EditBox,_=t.Slider},function(t){G=t.EventManager},function(t){k=t.default},function(t){S=t.default},function(t){B=t.List}],execute:function(){var E;o._RF.push({},"83eb40zxF1MTozaSqrbjM4K","Component",void 0);var F=i.ccclass;i.property,t("default",F("BaseComponent")(E=function(t){function o(){var e;return(e=t.call(this)||this).m_objects=new Map,e.inject(),e}e(o,t);var i=o.prototype;return i.inject=function(){var t=this,e=this.onLoad;this.onLoad=function(){t.autoMapping(t.node),e&&e.call(t)};var n=this.onDisable;this.onDisable=function(){t.RemoveAllEventTrigger(),n&&n.call(t)}},i.AddEvent=function(t,e){G.Inst.on(t,this,e)},i.RemoveEventTrigger=function(t,e){G.Inst.off(t,this,e)},i.RemoveAllEventTrigger=function(){G.Inst.offAllCaller(this)},i.addClick=function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=null);var o=new s.EventHandler;o.target=this.node,o.component=r.getClassName(this),o.handler=e||"onBtnClicked",o.customEventData=n||t.name;var i=t.getComponent(a).clickEvents;i.length=0,i.push(o)},i.autoMapping=function(t){var e=t.name.split("_");if(e.length>1){var o=t.name;switch(e[0]){case"btn":this[o]=t.getComponent(a),this[o]&&this.addClick(t);break;case"progress":this[o]=t.getComponent(f);break;case"txt":case"lbl":this[o]=t.getComponent(p);break;case"sp":this[o]=t.getComponent(g);break;case"spine":this[o]=t.getComponent(m.Skeleton);break;case"link":this[o]=t.getComponent(S);break;case"toggle":case"tog":if(this[o]=t.getComponent(u),this[o]){var i=new s.EventHandler;i.target=this.node,i.component=r.getClassName(this),i.handler="onBtnClicked",i.customEventData=o;var d=t.getComponent(u).clickEvents;d.length=0,d.push(i)}break;case"toc":this[o]=t.getComponent(h);break;case"page":this[o]=t.getComponent(l);break;case"list":this[o]=t.getComponent(c);break;case"vlist":this[o]=t.getComponent(B);break;case"node":default:this[o]=t}}else null==this[t.name]&&(this[t.name]=t);for(var b,v=n(t.children);!(b=v()).done;){var C=b.value;this.autoMapping(C)}},i.setSpriteUrl=function(t,e){d.loadRemote(e,(function(e,n){e||(t.spriteFrame=n)}))},i._findInChildren=function(t,e){var n=t.getChildByName(e);if(n)return n;if(0==t.children.length)return null;for(var o=0;o<t.children.length;++o){var i=this._findInChildren(t.children[o],e);if(i)return i}return null},i.setSpriteFrame=function(t,e,n,o){return void 0===o&&(o=null),k.loadResSync(e,n,b).then((function(e){t.isValid&&(t.spriteFrame=e),o&&o()}))},i.GetGameObject=function(t,e,n){if(void 0===e&&(e=null),void 0===n&&(n=!1),e||(e=this.node),!v(e))return null;if(!n){if(this.m_objects&&this.m_objects.has(t))return this.m_objects[t];if(t==e.name)return e}var o;return-1!=t.indexOf("/")?((o=C(t,e))&&(this.m_objects[t]=o),o):((o=this._findInChildren(e,t))&&(this.m_objects[t]=o),o)},i.GetGameObjects=function(t,e){void 0===e&&(e=null),e||(e=this.node);var n=[];return this._getNodes(e,t,n),n},i._getNodes=function(t,e,n){t.name==e&&n.push(t);for(var o=0;o<t.children.length;++o)t.children[o].name==e?n.push(t.children[o]):this._getNodes(t.children[o],e,n)},i.GetSkeleton=function(t){if(this.m_objects&&this.m_objects.has(t))return this.m_objects[t].getComponent(m.Skeleton);var e=this.GetGameObject(t);return e?e.getComponent(m.Skeleton):null},i.GetSprite=function(t){if(this.m_objects&&this.m_objects.has(t))return this.m_objects[t].getComponent(g);var e=this.GetGameObject(t);return e?e.getComponent(g):null},i.GetText=function(t){if(this.m_objects&&this.m_objects.has(t))return this.m_objects[t].getComponent(p);var e=this.GetGameObject(t);return e?e.getComponent(p):null},i.GetProgressBar=function(t){if(this.m_objects&&this.m_objects.has(t))return this.m_objects[t].getComponent(f);var e=this.GetGameObject(t);return e?e.getComponent(f):null},i.GetButton=function(t){if(this.m_objects&&this.m_objects.has(t))return this.m_objects[t].getComponent(a);var e=this.GetGameObject(t);return e?e.getComponent(a):null},i.GetInputField=function(t){if(this.m_objects&&this.m_objects.has(t))return this.m_objects[t].getComponent(j);var e=this.GetGameObject(t);return e?e.getComponent(j):null},i.GetSlider=function(t){if(this.m_objects&&this.m_objects.has(t))return this.m_objects[t].getComponent(_);var e=this.GetGameObject(t);return e?e.getComponent(_):null},i.SetText=function(t,e){this.GetText(t)&&(this.GetText(t).string=e)},i.SetInputText=function(t,e){this.GetInputField(t)&&(this.GetInputField(t).string=e)},i.SetProgressBar=function(t,e){this.GetProgressBar(t)&&(this.GetProgressBar(t).progress=e)},i.getChildByName=function(t,e){return C(t,e||this.node)},o}(s))||E);o._RF.pop()}}}));

System.register("chunks:///_virtual/Config.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AreaConfig.ts","./EnemyConfig.ts","./MissionConfig.ts","./ObstacleConfig.ts","./SkinConfig.ts","./TaskConfig.ts","./UpgradeConfig.ts","./WeaponConfig.ts"],(function(n){var e,t,a,o,u,s,i,r,f,c,l;return{setters:[function(n){e=n.asyncToGenerator,t=n.regeneratorRuntime},function(n){a=n.cclegacy},function(n){o=n.default},function(n){u=n.default},function(n){s=n.default},function(n){i=n.default},function(n){r=n.default},function(n){f=n.default},function(n){c=n.default},function(n){l=n.default}],execute:function(){a._RF.push({},"b58a5waD8xEhJiU2Jox58+R","Config",void 0);var p=n("default",function(){function n(){}return n.load=function(){var a=e(t().mark((function e(){var a;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=[]).push(n.area.load("area")),a.push(n.enemy.load("enemy")),a.push(n.mission.load("mission")),a.push(n.obstacle.load("obstacle")),a.push(n.skin.load("skin")),a.push(n.task.load("task")),a.push(n.upgrade.load("upgrade")),a.push(n.weapon.load("weapon")),e.abrupt("return",Promise.all(a));case 10:case"end":return e.stop()}}),e)})));return function(){return a.apply(this,arguments)}}(),n}());p.area=new o,p.enemy=new u,p.mission=new s,p.obstacle=new i,p.skin=new r,p.task=new f,p.upgrade=new c,p.weapon=new l,a._RF.pop()}}}));

System.register("chunks:///_virtual/ConfigAuto.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseCfg.ts"],(function(t){var i,o,n,e;return{setters:[function(t){i=t.inheritsLoose,o=t.createForOfIteratorHelperLoose},function(t){n=t.cclegacy},function(t){e=t.default}],execute:function(){n._RF.push({},"c95bbomiVhMP4XN+g7lZB9/","ConfigAuto",void 0);var s=t("MissionObj",function(){function t(){this.id=void 0,this.level=void 0,this.mapID=void 0,this.total=void 0,this.probability=void 0,this.costMoney=void 0}return t.prototype.setData=function(t){for(var i in t)this[i]=t[i]},t}()),a=(t("MissionConfigAuto",function(t){function n(){return t.apply(this,arguments)||this}return i(n,t),n.prototype.setData=function(t){for(var i,n=o(t);!(i=n()).done;){var e=i.value,a=new s;a.setData(e),this.map.set(e.id,a)}},n}(e)),t("EnemyObj",function(){function t(){this.id=void 0,this.viewUrl=void 0,this.name=void 0,this.moveSpeed=void 0,this.atkRange=void 0,this.size=void 0,this.atk=void 0,this.hp=void 0,this.gold=void 0,this.mass=void 0}return t.prototype.setData=function(t){for(var i in t)this[i]=t[i]},t}())),r=(t("EnemyConfigAuto",function(t){function n(){return t.apply(this,arguments)||this}return i(n,t),n.prototype.setData=function(t){for(var i,n=o(t);!(i=n()).done;){var e=i.value,s=new a;s.setData(e),this.map.set(e.id,s)}},n}(e)),t("ObstacleObj",function(){function t(){this.id=void 0,this.hp=void 0,this.type=void 0,this.name=void 0}return t.prototype.setData=function(t){for(var i in t)this[i]=t[i]},t}())),d=(t("ObstacleConfigAuto",function(t){function n(){return t.apply(this,arguments)||this}return i(n,t),n.prototype.setData=function(t){for(var i,n=o(t);!(i=n()).done;){var e=i.value,s=new r;s.setData(e),this.map.set(e.id,s)}},n}(e)),t("WeaponObj",function(){function t(){this.id=void 0,this.name=void 0,this.icon=void 0,this.weapon_prefab=void 0,this.has_bullet_shell=void 0,this.bullet_prefab=void 0,this.bullet_speed=void 0,this.weapon_point=void 0,this.weapon_sound=void 0,this.ene_sound=void 0,this.ene_particle=void 0,this.idle=void 0,this.shoot=void 0,this.run_forward=void 0,this.run_backward=void 0,this.strafe_left=void 0,this.strafe_right=void 0,this.death=void 0,this.unlock_diamonds=void 0,this.atk=void 0,this.move_attack=void 0,this.fire_rate=void 0,this.break=void 0,this.attack_radius=void 0,this.attack_mode=void 0,this.attack_prop=void 0,this.upgrade_coin=void 0,this.upgrade_coin_add=void 0,this.upgrade_atk=void 0,this.golden_diamonds=void 0}return t.prototype.setData=function(t){for(var i in t)this[i]=t[i]},t}())),u=(t("WeaponConfigAuto",function(t){function n(){return t.apply(this,arguments)||this}return i(n,t),n.prototype.setData=function(t){for(var i,n=o(t);!(i=n()).done;){var e=i.value,s=new d;s.setData(e),this.map.set(e.id,s)}},n}(e)),t("AreaObj",function(){function t(){this.id=void 0,this.map=void 0,this.room_name=void 0,this.next_room=void 0,this.unlock_coin=void 0}return t.prototype.setData=function(t){for(var i in t)this[i]=t[i]},t}())),h=(t("AreaConfigAuto",function(t){function n(){return t.apply(this,arguments)||this}return i(n,t),n.prototype.setData=function(t){for(var i,n=o(t);!(i=n()).done;){var e=i.value,s=new u;s.setData(e),this.map.set(e.id,s)}},n}(e)),t("SkinObj",function(){function t(){this.id=void 0,this.skin_prefab=void 0,this.key=void 0,this.name=void 0,this.value=void 0,this.unlock_diamonds=void 0}return t.prototype.setData=function(t){for(var i in t)this[i]=t[i]},t}())),v=(t("SkinConfigAuto",function(t){function n(){return t.apply(this,arguments)||this}return i(n,t),n.prototype.setData=function(t){for(var i,n=o(t);!(i=n()).done;){var e=i.value,s=new h;s.setData(e),this.map.set(e.id,s)}},n}(e)),t("TaskObj",function(){function t(){this.id=void 0,this.task_desc=void 0,this.condition=void 0,this.reward_type=void 0,this.reward_value=void 0}return t.prototype.setData=function(t){for(var i in t)this[i]=t[i]},t}())),f=(t("TaskConfigAuto",function(t){function n(){return t.apply(this,arguments)||this}return i(n,t),n.prototype.setData=function(t){for(var i,n=o(t);!(i=n()).done;){var e=i.value,s=new v;s.setData(e),this.map.set(e.id,s)}},n}(e)),t("UpgradeObj",function(){function t(){this.id=void 0,this.name=void 0,this.key=void 0,this.value=void 0,this.cost=void 0}return t.prototype.setData=function(t){for(var i in t)this[i]=t[i]},t}()));t("UpgradeConfigAuto",function(t){function n(){return t.apply(this,arguments)||this}return i(n,t),n.prototype.setData=function(t){for(var i,n=o(t);!(i=n()).done;){var e=i.value,s=new f;s.setData(e),this.map.set(e.id,s)}},n}(e));n._RF.pop()}}}));

System.register("chunks:///_virtual/CountDownUI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Component.ts"],(function(t){var n,o,e,r,s,a;return{setters:[function(t){n=t.inheritsLoose},function(t){o=t.cclegacy,e=t._decorator,r=t.Tween,s=t.tween},function(t){a=t.default}],execute:function(){var i;o._RF.push({},"561e7ikdXVOyovFCsZe4oXV","CountDownUI",void 0);var c=e.ccclass;e.property,t("CountDownUI",c("CountDownUI")(i=function(t){function o(){for(var n,o=arguments.length,e=new Array(o),r=0;r<o;r++)e[r]=arguments[r];return(n=t.call.apply(t,[this].concat(e))||this).sp_bar=void 0,n}n(o,t);var e=o.prototype;return e.start=function(){},e.update=function(t){},e.play=function(t){r.stopAllByTarget(this.sp_bar),this.sp_bar.fillRange=0,s(this.sp_bar).to(2.5,{fillRange:1}).call((function(){t()})).start()},e.stop=function(){r.stopAllByTarget(this.sp_bar),this.sp_bar.fillRange=0},o}(a))||i);o._RF.pop()}}}));

System.register("chunks:///_virtual/debug-view-runtime-control.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,o,i,n,s,l,r,a,g,h,p,c,C,d,m,u,L;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.inheritsLoose,i=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){s=t.cclegacy,l=t._decorator,r=t.Node,a=t.Color,g=t.Canvas,h=t.UITransform,p=t.instantiate,c=t.Label,C=t.RichText,d=t.Toggle,m=t.Button,u=t.director,L=t.Component}],execute:function(){var f,M,b,v,T,S,x,E,I;s._RF.push({},"b2bd1+njXxJxaFY3ymm06WU","debug-view-runtime-control",void 0);var A=l.ccclass,y=l.property;t("DebugViewRuntimeControl",(f=A("internal.DebugViewRuntimeControl"),M=y(r),b=y(r),v=y(r),f((x=e((S=function(t){function e(){for(var e,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return e=t.call.apply(t,[this].concat(s))||this,i(e,"compositeModeToggle",x,n(e)),i(e,"singleModeToggle",E,n(e)),i(e,"EnableAllCompositeModeButton",I,n(e)),e._single=0,e.strSingle=["No Single Debug","Vertex Color","Vertex Normal","Vertex Tangent","World Position","Vertex Mirror","Face Side","UV0","UV1","UV Lightmap","Project Depth","Linear Depth","Fragment Normal","Fragment Tangent","Fragment Binormal","Base Color","Diffuse Color","Specular Color","Transparency","Metallic","Roughness","Specular Intensity","IOR","Direct Diffuse","Direct Specular","Direct All","Env Diffuse","Env Specular","Env All","Emissive","Light Map","Shadow","AO","Fresnel","Direct Transmit Diffuse","Direct Transmit Specular","Env Transmit Diffuse","Env Transmit Specular","Transmit All","Direct Internal Specular","Env Internal Specular","Internal All","Fog"],e.strComposite=["Direct Diffuse","Direct Specular","Env Diffuse","Env Specular","Emissive","Light Map","Shadow","AO","Normal Map","Fog","Tone Mapping","Gamma Correction","Fresnel","Transmit Diffuse","Transmit Specular","Internal Specular","TT"],e.strMisc=["CSM Layer Coloration","Lighting With Albedo"],e.compositeModeToggleList=[],e.singleModeToggleList=[],e.miscModeToggleList=[],e.textComponentList=[],e.labelComponentList=[],e.textContentList=[],e.hideButtonLabel=void 0,e._currentColorIndex=0,e.strColor=["<color=#ffffff>","<color=#000000>","<color=#ff0000>","<color=#00ff00>","<color=#0000ff>"],e.color=[a.WHITE,a.BLACK,a.RED,a.GREEN,a.BLUE],e}o(e,t);var s=e.prototype;return s.start=function(){if(this.node.parent.getComponent(g)){var t=this.node.parent.getComponent(h),e=.5*t.width,o=.5*t.height,i=.1*e-e,n=o-.1*o,s=this.node.getChildByName("MiscMode"),l=p(s);l.parent=this.node,l.name="Buttons";var r=p(s);r.parent=this.node,r.name="Titles";for(var u=0;u<2;u++){var L=p(this.EnableAllCompositeModeButton.getChildByName("Label"));L.setPosition(i+(u>0?450:150),n,0),L.setScale(.75,.75,.75),L.parent=r;var f=L.getComponent(c);f.string=u?"----------Composite Mode----------":"----------Single Mode----------",f.color=a.WHITE,f.overflow=0,this.labelComponentList[this.labelComponentList.length]=f}n-=20;for(var M=0,b=0;b<this.strSingle.length;b++,M++){b===this.strSingle.length>>1&&(i+=200,M=0);var v=b?p(this.singleModeToggle):this.singleModeToggle;v.setPosition(i,n-20*M,0),v.setScale(.5,.5,.5),v.parent=this.singleModeToggle.parent;var T=v.getComponentInChildren(C);T.string=this.strSingle[b],this.textComponentList[this.textComponentList.length]=T,this.textContentList[this.textContentList.length]=T.string,v.on(d.EventType.TOGGLE,this.toggleSingleMode,this),this.singleModeToggleList[b]=v}i+=200,this.EnableAllCompositeModeButton.setPosition(i+15,n,0),this.EnableAllCompositeModeButton.setScale(.5,.5,.5),this.EnableAllCompositeModeButton.on(m.EventType.CLICK,this.enableAllCompositeMode,this),this.EnableAllCompositeModeButton.parent=l;var S=this.EnableAllCompositeModeButton.getComponentInChildren(c);this.labelComponentList[this.labelComponentList.length]=S;var x=p(this.EnableAllCompositeModeButton);x.setPosition(i+90,n,0),x.setScale(.5,.5,.5),x.on(m.EventType.CLICK,this.changeTextColor,this),x.parent=l,(S=x.getComponentInChildren(c)).string="TextColor",this.labelComponentList[this.labelComponentList.length]=S;var E=p(this.EnableAllCompositeModeButton);E.setPosition(i+200,n,0),E.setScale(.5,.5,.5),E.on(m.EventType.CLICK,this.hideUI,this),E.parent=this.node.parent,(S=E.getComponentInChildren(c)).string="Hide UI",this.labelComponentList[this.labelComponentList.length]=S,this.hideButtonLabel=S,n-=40;for(var I=0;I<this.strMisc.length;I++){var A=p(this.compositeModeToggle);A.setPosition(i,n-20*I,0),A.setScale(.5,.5,.5),A.parent=s;var y=A.getComponentInChildren(C);y.string=this.strMisc[I],this.textComponentList[this.textComponentList.length]=y,this.textContentList[this.textContentList.length]=y.string,A.getComponent(d).isChecked=!!I,A.on(d.EventType.TOGGLE,I?this.toggleLightingWithAlbedo:this.toggleCSMColoration,this),this.miscModeToggleList[I]=A}n-=150;for(var D=0;D<this.strComposite.length;D++){var B=D?p(this.compositeModeToggle):this.compositeModeToggle;B.setPosition(i,n-20*D,0),B.setScale(.5,.5,.5),B.parent=this.compositeModeToggle.parent;var w=B.getComponentInChildren(C);w.string=this.strComposite[D],this.textComponentList[this.textComponentList.length]=w,this.textContentList[this.textContentList.length]=w.string,B.on(d.EventType.TOGGLE,this.toggleCompositeMode,this),this.compositeModeToggleList[D]=B}}else console.error("debug-view-runtime-control should be child of Canvas")},s.isTextMatched=function(t,e){var o=new String(t),i=o.search(">");return-1===i?t===e:(o=(o=o.substr(i+1)).substr(0,o.search("<")))===e},s.toggleSingleMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strSingle.length;i++)this.isTextMatched(o.string,this.strSingle[i])&&(e.singleMode=i)},s.toggleCompositeMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strComposite.length;i++)this.isTextMatched(o.string,this.strComposite[i])&&e.enableCompositeMode(i,t.isChecked)},s.toggleLightingWithAlbedo=function(t){u.root.debugView.lightingWithAlbedo=t.isChecked},s.toggleCSMColoration=function(t){u.root.debugView.csmLayerColoration=t.isChecked},s.enableAllCompositeMode=function(t){var e=u.root.debugView;e.enableAllCompositeMode(!0);for(var o=0;o<this.compositeModeToggleList.length;o++){this.compositeModeToggleList[o].getComponent(d).isChecked=!0}var i=this.miscModeToggleList[0].getComponent(d);i.isChecked=!1,e.csmLayerColoration=!1,(i=this.miscModeToggleList[1].getComponent(d)).isChecked=!0,e.lightingWithAlbedo=!0},s.hideUI=function(t){var e=this.node.getChildByName("Titles"),o=!e.active;this.singleModeToggleList[0].parent.active=o,this.miscModeToggleList[0].parent.active=o,this.compositeModeToggleList[0].parent.active=o,this.EnableAllCompositeModeButton.parent.active=o,e.active=o,this.hideButtonLabel.string=o?"Hide UI":"Show UI"},s.changeTextColor=function(t){this._currentColorIndex++,this._currentColorIndex>=this.strColor.length&&(this._currentColorIndex=0);for(var e=0;e<this.textComponentList.length;e++)this.textComponentList[e].string=this.strColor[this._currentColorIndex]+this.textContentList[e]+"</color>";for(var o=0;o<this.labelComponentList.length;o++)this.labelComponentList[o].color=this.color[this._currentColorIndex]},s.onLoad=function(){},s.update=function(t){},e}(L)).prototype,"compositeModeToggle",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=e(S.prototype,"singleModeToggle",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(S.prototype,"EnableAllCompositeModeButton",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=S))||T));s._RF.pop()}}}));

System.register("chunks:///_virtual/DirArrow.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Component.ts"],(function(t){var o,i,r,n,e,s,a;return{setters:[function(t){o=t.inheritsLoose,i=t.createClass},function(t){r=t.cclegacy,n=t._decorator,e=t.v3,s=t.Vec3},function(t){a=t.default}],execute:function(){var c;r._RF.push({},"48d1dSRXsZORoP01Ux5sc9Y","DirArrow",void 0);var l=n.ccclass,u=(n.property,e());t("DirArrow",l("DirArrow")(c=function(t){function r(){for(var o,i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return(o=t.call.apply(t,[this].concat(r))||this).node_arrow=null,o._target=void 0,o.d=0,o._aimPos=null,o}o(r,t);var n=r.prototype;return n.start=function(){this.node_arrow.active=!1},n.update=function(t){},n.lateUpdate=function(t){this._target&&(this.node.setPosition(this.target.node.getWorldPosition().clone().add(e(0,3,0))),null!=this._aimPos&&(this.node.lookAt(this._aimPos),s.subtract(u,this._aimPos,this.node.worldPosition),this.node_arrow.active=u.length()>3,u.normalize(),s.multiplyScalar(u,u,.5*Math.sin(this.d)),this.d+=3*t,this.d>2*Math.PI&&(this.d=0),s.add(u,this.node.worldPosition,u),this.node.setWorldPosition(u)))},i(r,[{key:"target",get:function(){return this._target},set:function(t){this._target=t}},{key:"aimPos",get:function(){return this._aimPos},set:function(t){this._aimPos=t}}]),r}(a))||c);r._RF.pop()}}}));

System.register("chunks:///_virtual/Drone.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Global.ts","./EventManager.ts","./FSM.ts","./GameConst.ts","./Config.ts","./Bullet.ts","./Component.ts","./AudioMgr.ts"],(function(t){var e,n,i,s,o,a,r,h,l,c,d,u,f,y,p,m,P,E,g,A;return{setters:[function(t){e=t.inheritsLoose,n=t.createClass},function(t){i=t.cclegacy,s=t._decorator,o=t.v3,a=t.quat,r=t.SkeletalAnimation,h=t.Vec3,l=t.Quat,c=t.isValid,d=t.tween},function(t){u=t.Global},function(t){f=t.EventManager},function(t){y=t.default,p=t.FSMAction},function(t){m=t.default},function(t){P=t.default},function(t){E=t.Bullet},function(t){g=t.default},function(t){A=t.AudioMgr}],execute:function(){var L;i._RF.push({},"885bfCPizJJYJFicfyVYjDt","Drone",void 0);var w=s.ccclass,v=(s.property,function(t){return t[t.FOLLOW_ENEMY=0]="FOLLOW_ENEMY",t[t.FOLLOW_PLAYER=1]="FOLLOW_PLAYER",t[t.BACK_PLAYER=2]="BACK_PLAYER",t[t.ATTACK=3]="ATTACK",t}(v||{})),R=o(),k=a(),C=a();t("Drone",w("Drone")(L=function(t){function i(){for(var e,n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))||this).fsm=void 0,e.targetEnemy=void 0,e.enemyPos=h.ZERO,e.playerPos=h.ZERO,e.attackCount=0,e.ani=void 0,e.curAni=void 0,e.maxRange=64,e.startSearchRange=4,e.trackingRange=15,e.attackRange=10,e.speed=4,e.followSpeed=4,e.fastSpeed=10,e.WeaponHolder=null,e}e(i,t);var s=i.prototype;return s.onLoad=function(){this.initFsm(),this.ani=this.getComponent(r),f.Inst.on(m.EventType.PlayerHpChange,this,this.onHpChange)},s.onHpChange=function(){u.player.isAlive()?this.fsm.setRunning(!0):this.fsm.setRunning(!1)},s.initFsm=function(){this.fsm=this.node.addComponent(y),this.fsm.init(this),this.fsm.addState(new p(this,v.FOLLOW_ENEMY,this.onFollowEnemyEnter,this.onFollowEnemyUpdte)),this.fsm.addState(new p(this,v.FOLLOW_PLAYER,this.onFollowPlayerEnter,this.onFollowPlayerUpdte)),this.fsm.addState(new p(this,v.BACK_PLAYER,this.onBackPlayerEnter,this.onBackPlayerUpdte)),this.fsm.addState(new p(this,v.ATTACK,this.onAttackEnter,this.onAttackUpdate))},s.start=function(){},s.pause=function(){this.fsm.pause()},s.reset=function(){this.fsm.enterState(v.FOLLOW_PLAYER)},s.update=function(t){this.syncPlayerPos(),this.syncEnemyPos(),this.fsm.isInState(v.FOLLOW_ENEMY)?this.updateMove(t,this.enemyPos):(this.fsm.isInState(v.FOLLOW_PLAYER)||this.fsm.isInState(v.BACK_PLAYER)||this.fsm.isInState(v.BACK_PLAYER))&&this.updateMove(t,this.playerPos),this.updateAni(t)},s.updateMove=function(t,e){if(!(this.getXZDis(e,this.node.worldPosition)<.1)){h.subtract(R,e,this.node.worldPosition),h.normalize(R,R);var n=180*Math.atan2(R.x,R.z)/Math.PI;l.fromEuler(k,0,n,0),l.slerp(C,this.node.rotation,k,.2),this.node.setRotation(C),h.multiplyScalar(R,R,this.speed*t),h.add(R,this.node.worldPosition,R),this.node.worldPosition=this.node.worldPosition.lerp(R,.5)}},s.onFollowEnemyEnter=function(){this.speed=this.fastSpeed},s.onFollowEnemyUpdte=function(t){var e=this.getXZDis(this.playerPos,this.node.worldPosition);e>this.maxRange?this.fsm.changeState(v.BACK_PLAYER):(e=this.getXZDis(this.enemyPos,this.node.worldPosition))<this.attackRange&&this.fsm.changeState(v.ATTACK)},s.onFollowPlayerEnter=function(){this.speed=this.followSpeed},s.onFollowPlayerUpdte=function(t){u.player&&(this.getXZDis(this.playerPos,this.node.worldPosition)<this.startSearchRange&&this.searchEnemy())},s.onBackPlayerEnter=function(){this.speed=this.fastSpeed},s.onBackPlayerUpdte=function(t){u.player&&(this.getXZDis(this.playerPos,this.node.worldPosition)<this.startSearchRange&&this.searchEnemy())},s.onAttackEnter=function(){this.attackCount=1},s.onAttackUpdate=function(t){this.attackCount+=t,h.subtract(R,this.enemyPos,this.node.worldPosition),h.normalize(R,R);var e=180*Math.atan2(R.x,R.z)/Math.PI;if(l.fromEuler(k,0,e,0),l.slerp(C,this.node.rotation,k,.2),this.node.setRotation(C),this.attackCount>=this.attackDelay){if(this.attackCount-=this.attackDelay,!c(this.targetEnemy)||!this.targetEnemy.isAlive())return void this.searchEnemy();var n=this.getXZDis(this.enemyPos,this.node.worldPosition);if(n<this.attackRange){d(this.node).to(.25,{scale:o(1.1,1.1,1.1)}).to(.25,{scale:o(1,1,1)}).start();var i=this.node.forward.clone();i.negative();var s=this.WeaponHolder.worldPosition.clone(),a=P.weapon.get(5),r=new E(a,this.damage,this.targetEnemy,s,i);f.Inst.event(m.EventType.CREATE_BULLET,r);var u=1-n/5;if(u<=0)return;u>1&&(u=1),A.Instance().playSFX(a.weapon_sound,u)}else this.attackCount=this.attackDelay,this.searchEnemy()}},s.searchEnemy=function(){this.targetEnemy=u.game.getTargetZombie(this.node.worldPosition,this.trackingRange),this.targetEnemy&&this.targetEnemy.isAlive()?(this.syncEnemyPos(),this.fsm.changeState(v.FOLLOW_ENEMY)):this.fsm.changeState(v.FOLLOW_PLAYER)},s.syncEnemyPos=function(){this.targetEnemy&&(this.enemyPos=this.targetEnemy.node.worldPosition.clone(),this.enemyPos.y=2.8,this.enemyPos.x-=1.5)},s.syncPlayerPos=function(){this.playerPos=u.player.node.worldPosition.clone(),this.playerPos.y=2.8,this.playerPos.x-=1.5},s.updateAni=function(t){},s.playAni=function(t,e){if(this.ani){if(this.curAni===t)return;this.curAni=t,this.ani.play(t)}},s.getXZDis=function(t,e){var n=t.x-e.x,i=t.z-e.z;return n*n+i*i},n(i,[{key:"damage",get:function(){return 10}},{key:"attackDelay",get:function(){return.1}}]),i}(g))||L);i._RF.pop()}}}));

System.register("chunks:///_virtual/DroneWin.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BasePanel.ts"],(function(n){var e,t,o,r;return{setters:[function(n){e=n.inheritsLoose},function(n){t=n.cclegacy,o=n._decorator},function(n){r=n.default}],execute:function(){var c;t._RF.push({},"980965z9OJB96MQS/24UWQq","DroneWin",void 0);var i=o.ccclass;o.property,n("DroneWin",i("DroneWin")(c=function(n){function t(){return n.apply(this,arguments)||this}return e(t,n),t.prototype.onBtnClicked=function(n,e){"btn_close"==e&&this.close(!0)},t}(r))||c);t._RF.pop()}}}));

System.register("chunks:///_virtual/Enemy.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Global.ts","./FSM.ts","./Role.ts","./AudioMgr.ts","./GameConst.ts","./HpBar.ts","./Model.ts","./AssetPool.ts","./AdManager.ts"],(function(t){var e,i,o,n,s,a,r,h,d,l,c,f,p,u,m,g,y,v,w,P,A,b,E,C,D;return{setters:[function(t){e=t.inheritsLoose,i=t.createForOfIteratorHelperLoose,o=t.createClass},function(t){n=t.cclegacy,s=t._decorator,a=t.v3,r=t.quat,h=t.v4,d=t.SkeletalAnimation,l=t.SkinnedMeshRenderer,c=t.Vec3,f=t.Quat,p=t.Vec2,u=t.ParticleSystem,m=t.tween},function(t){g=t.Global},function(t){y=t.default,v=t.FSMAction},function(t){w=t.Role},function(t){P=t.AudioMgr},function(t){A=t.default},function(t){b=t.HpBar},function(t){E=t.default},function(t){C=t.default},function(t){D=t.default}],execute:function(){var S,k;n._RF.push({},"d7f6dDdUTpObqFRfIBR3rBX","Enemy",void 0);var I=t("EnemyAction",function(t){return t[t.SEARCH=0]="SEARCH",t[t.ATTACK=1]="ATTACK",t[t.IDLE=2]="IDLE",t[t.DEATH=3]="DEATH",t}({})),M=s.ccclass,R=(s.property,window.SAT),T=R.Vector,_=R.Polygon,H=a(),x=r(),B=r(),z=a(),F=a(),Z=a();a(.5,0,.5),t("Enemy",M("Enemy")(((k=function(t){function n(){for(var e,i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];return(e=t.call.apply(t,[this].concat(o))||this)._barricade=void 0,e._bar=null,e.ownBarricadeID=0,e.first=!1,e.cfg=void 0,e.fsm=void 0,e.checkDis=1,e.oldMass=0,e.lastCell=null,e.response=new R.Response,e.polygon1=new _(new T(0,0),[]),e.targetCellPos=a(),e.skinnedMeshRenderer=null,e.defaultColor=h(0,.576,.322,1),e.ani=void 0,e.curAni=void 0,e.hitDamp=1,e.stepCounter=0,e.stepHp=1,e.planks=[],e._hp=1,e._lasthitTime=0,e}e(n,t);var s=n.prototype;return s.isAlive=function(){return this.hp>0},s.onLoad=function(){this.ani=this.node.getComponentInChildren(d),this.skinnedMeshRenderer=this.node.getComponentInChildren(l),this.defaultColor=this.skinnedMeshRenderer.material.getProperty("mainColor"),this.initFsm(),this._bar=this.getComponentInChildren(b)},s.initFsm=function(){this.fsm=this.node.addComponent(y),this.fsm.init(this),this.fsm.addState(new v(this,I.SEARCH,this.onSearchEnter,this.onSearchUpdate)),this.fsm.addState(new v(this,I.ATTACK,this.onAttackEnter,this.onAttackUpdate)),this.fsm.addState(new v(this,I.IDLE,this.onIdleEnter,this.onIdleUpdate)),this.fsm.addState(new v(this,I.DEATH,this.onDeathEnter,this.onDeathUpdate))},s.start=function(){},s.setData=function(t){this.cfg=t,this.hp=this.cfg.hp,this.mass=this.oldMass=t.mass,this.radius=t.size,this.checkDis=2*Math.random()+1,this.first=!1,this.fsm.enterState(I.SEARCH),this.skinnedMeshRenderer.material.setProperty("mainColor",this.defaultColor)},s.update=function(e){g.game.pause||g.player.isAlive()&&(t.prototype.update.call(this,e),g.game.collideWithOther(this),this.updateMove(e),this.updateCollide(),this.offsetX=this.offsetZ=0,this.updateCircle(),this.updateHpBar())},s.updateCollideWithObstacle=function(){for(var t=g.map.obstacle,e=0;e<t.length;++e){var i=t[e];if(i.node.activeInHierarchy){this.polygon1.setPoints(i.worldVertexXZ),this.updateCircle();var o=this.response;o.clear(),R.testCirclePolygon(this.circle,this.polygon1,o)&&(this.node.getWorldPosition(z),z.x+=o.overlapV.x,z.z+=o.overlapV.y,this.node.setWorldPosition(z))}}},s.updateHpBar=function(){if(this._bar&&this.cfg){this._bar.setProgress(this.hp/this.cfg.hp);var t=c.subtract(F,this.node.worldPosition,g.camera.node.worldPosition).length();this._bar.node.active=this.hp>0&&this.hp<this.cfg.hp&&t<10}},s.onIdleEnter=function(){this.playAni("Zombie_Idle")},s.onIdleUpdate=function(t){g.player.hp>0&&this.fsm.changeState(I.SEARCH)},s.onSearchEnter=function(){this.playAni("Zombie_run"),this.mass=this.oldMass},s.updateMove=function(t){if(this.fsm.isInState(I.SEARCH))if(null!=this.barricade){if(H.set(this.barricade.collider.worldPosition.x,0,this.barricade.collider.worldPosition.z),c.subtract(z,H,this.node.worldPosition),z.length()<this.checkDis)return void(this.barricade.isAlive()?this.fsm.changeState(I.ATTACK):this.barricade=null);c.normalize(z,z);var e=180*Math.atan2(z.x,z.z)/Math.PI;f.fromEuler(x,0,e,0),f.slerp(B,this.node.rotation,x,.2),this.node.setRotation(B),this.node.worldPosition.y,c.multiplyScalar(z,z,this.speed*t),c.add(z,this.node.worldPosition,z),this.node.worldPosition=z}else{var i=g.followFiled.getCellByPositon(this.node.worldPosition.clone());if(i&&!i.bestDir.equals(p.ZERO)){if(z.set(i.bestDir.y,0,i.bestDir.x),this.targetCellPos=i.wp.clone().add(z),H.set(g.player.node.worldPosition.x,0,g.player.node.worldPosition.z),c.subtract(z,H,this.node.worldPosition),z.length()<this.checkDis)return void this.fsm.changeState(I.ATTACK);c.subtract(z,this.targetCellPos,this.node.worldPosition),c.normalize(z,z);var o=180*Math.atan2(z.x,z.z)/Math.PI;f.fromEuler(x,0,o,0),f.slerp(B,this.node.rotation,x,.2),this.node.setRotation(B),c.multiplyScalar(z,z,this.speed*t),c.add(z,this.node.worldPosition,z),this.node.worldPosition=z}}},s.onSearchUpdate=function(t){0==g.player.hp&&this.fsm.changeState(I.IDLE)},s.onAttackEnter=function(){var t=this;this.mass=100+Math.random(),this.playAni("Zombie_attack"),this.scheduleOnce((function(){t.attack()}),.1),this.scheduleOnce((function(){t.fsm.isInState(I.DEATH)||t.fsm.changeState(I.SEARCH)}),1)},s.onAttackUpdate=function(){},s.attack=function(){this.barricade&&this.barricade.hp>0?this.barricade.damage():(c.subtract(z,this.node.worldPosition,g.player.node.worldPosition),z.length()<this.checkDis&&(g.player.hp>0?g.player.damage(this.cfg.atk):this.fsm.changeState(I.IDLE)))},s.onDeathEnter=function(){var t=this;this.playAni("Zombie_dead"),this.skinnedMeshRenderer.material.setProperty("albedo",h(0,0,0,.5)),setTimeout((function(){g.game.removeEnemy(t)}),2e3)},s.onDeathUpdate=function(t){var e=this.node.position.clone();e.y-=.005,this.node.position=e},s.updateCollide=function(){Z.set(this.offsetX,0,this.offsetZ),c.add(z,this.node.worldPosition,Z),z.y=0,this.node.getWorldPosition(F),F=F.lerp(z,.3);var t=g.followFiled.getCellByPositon(F.clone());t&&!t.isBlock&&(this.node.worldPosition=F)},s.playAni=function(t,e){if(this.ani){if(this.curAni===t)return;this.curAni=t,this.ani.play(t)}},s.onExplore=function(t,e){void 0===t&&(t=1),void 0===e&&(e=null),e=e||g.player.node.worldPosition.clone();var i=a(0,0,0);c.subtract(i,this.node.worldPosition,e),c.normalize(i,i);var o=this.cfg.id>2?2:4;this.offsetX+=i.x*t*o*this.hitDamp,this.offsetZ+=i.z*t*o*this.hitDamp,this.hitDamp*=.95},s.onHit=function(t,e){if(void 0===e&&(e=!0),!this.fsm.isInState(I.DEATH)&&!(Date.now()-this._lasthitTime<300)&&(this._lasthitTime=Date.now(),this.hp-=t,D.vibrateShort(),this.hp<=0)){if(this.fsm.changeState(I.DEATH),3==this.cfg.id){for(var o,s=g.game.getTargetZombies(this.node.worldPosition,1.5),r=i(s);!(o=r()).done;){var h=o.value;h.onExplore(.5,this.node.worldPosition),h.onHit(this.cfg.atk,!1)}P.Instance().playSFX("effect_bullet_hit_ground"),e&&this.playExpEffect()}if(Date.now()-n.lastplayDeathsound>300&&(P.Instance().playSFX("EnemyDeath"),n.lastplayDeathsound=Date.now()),6==this.cfg.id)E.game.getGem+=5,g.game.dropDiamond(this.node.worldPosition.clone().add(a(0,1,0)),5);else if(E.game.getMoney+=5,g.game.dropCoin(this.node.worldPosition.clone().add(a(0,1,0)),5),Math.random()<.2){var d=Math.floor(2*Math.random()+1);E.game.getGem+=d,g.game.dropDiamond(this.node.worldPosition.clone().add(a(0,1,0)),d)}E.task.killEnemy(this.cfg.id,1,E.game.currentWeapon)}},s.playExpEffect=function(){var t=this;C.Instance().createObjAsync("prefabs/bullets/explosion","explosion").then((function(e){t.node.addChild(e),e.name="exp",e.setWorldPosition(t.node.worldPosition.clone()),e.getComponentsInChildren(u).forEach((function(t){t.play()})),m(e).delay(1).call((function(){C.Instance().put(e)})).start()}))},s.onRemoveBarricade=function(){this.isValid&&this.barricade&&(this.barricade.node.off(A.EventType.RemoveBarricade,this.onRemoveBarricade,this),this.barricade=null)},o(n,[{key:"barricade",get:function(){return this._barricade},set:function(t){this._barricade=t,t&&(t.node.on(A.EventType.RemoveBarricade,this.onRemoveBarricade,this),this.ownBarricadeID=t.id)}},{key:"speed",get:function(){return this.cfg.moveSpeed}},{key:"playerPolygon",get:function(){var t=[],e=this.node.worldPosition;return t.push(new T(e.x-.6,e.z-.6)),t.push(new T(e.x+.6,e.z-.6)),t.push(new T(e.x+.6,e.z+.6)),t.push(new T(e.x-.6,e.z+.6)),t.reverse()}},{key:"hp",get:function(){return this._hp},set:function(t){this._hp=t}}]),n}(w)).lastplayDeathsound=0,S=k))||S);n._RF.pop()}}}));

System.register("chunks:///_virtual/EnemyConfig.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ConfigAuto.ts"],(function(n){var e,t,o;return{setters:[function(n){e=n.inheritsLoose},function(n){t=n.cclegacy},function(n){o=n.EnemyConfigAuto}],execute:function(){t._RF.push({},"edb0eDMbS5GIqqeCeYRCd5/","EnemyConfig",void 0);n("default",function(n){function t(){return n.apply(this,arguments)||this}return e(t,n),t}(o));t._RF.pop()}}}));

System.register("chunks:///_virtual/EnemyIndicator.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Global.ts","./Component.ts"],(function(t){var e,r,n,a,i,o,c,s,l;return{setters:[function(t){e=t.inheritsLoose},function(t){r=t.cclegacy,n=t._decorator,a=t.v3,i=t.Camera,o=t.Vec3,c=t.view},function(t){s=t.Global},function(t){l=t.default}],execute:function(){var u;r._RF.push({},"55616MiLWFI04Xq+78/+RgK","EnemyIndicator",void 0);var h=n.ccclass,d=(n.property,a()),v=a(),y=a();t("EnemyIndicator",h("EnemyIndicator")(u=function(t){function r(){for(var e,r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this).bID=0,e.checkCount=0,e.checkDelay=.05,e.arrow=void 0,e}e(r,t);var n=r.prototype;return n.start=function(){},n.setBarricadeId=function(t){this.bID=t,this.arrow.active=!1},n.update=function(t){this.checkCount+=t,this.checkCount=0;var e=s.game.getOutScreenZombieByBarricadeId(this.bID);if(e){s.camera.camera.getComponent(i).convertToUINode(e.node.worldPosition,this.node.parent,d),o.subtract(v,d,y);var r=v.length();d.normalize();var n=180*Math.atan2(d.y,d.x)/Math.PI;this.arrow.angle=n+90,d.multiplyScalar(r);var a=c.getVisibleSize().width,l=c.getVisibleSize().height;d.x>.5*a-20?d.x=.5*a-20:d.x<.5*-a+20&&(d.x=.5*-a+20),d.y>.5*l-20?d.y=.5*l-20:d.y<.5*-l+20&&(d.y=.5*-l+20),this.node.setPosition(d),this.arrow.active=!0}else this.arrow.active=!1},r}(l))||u);r._RF.pop()}}}));

System.register("chunks:///_virtual/EventDispatcher.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Handler.ts"],(function(e){var t,n,r;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy},function(e){r=e.Handler}],execute:function(){n._RF.push({},"04653SDHkdJHZ8+1LKE8yJY","EventDispatcher",void 0);e("EventDispatcher",function(){function e(){this._events=void 0}var t=e.prototype;return t.hasListener=function(e){return!!(this._events&&this._events[e])},t.event=function(e,t){if(void 0===t&&(t=null),!this._events||!this._events[e])return!1;var n=this._events[e];if(n.run)n.once&&delete this._events[e],null!=t?n.runWith(t):n.run();else{for(var r=0,i=n.length;r<i;r++){var s=n[r];s&&(null!=t?s.runWith(t):s.run()),s&&!s.once||(n.splice(r,1),r--,i--)}0===n.length&&this._events&&delete this._events[e]}return!0},t.on=function(e,t,n,r){return void 0===r&&(r=null),this._createListener(e,t,n,r,!1)},t.once=function(e,t,n,r){return void 0===r&&(r=null),this._createListener(e,t,n,r,!0)},t._createListener=function(e,t,n,r,s,o){void 0===o&&(o=!0),o&&this.off(e,t,n,s);var l=i.create(t||this,n,r,s);this._events||(this._events={});var u=this._events;return u[e]?u[e].run?u[e]=[u[e],l]:u[e].push(l):u[e]=l,this},t.off=function(e,t,n,r){if(void 0===r&&(r=!1),!this._events||!this._events[e])return this;var i=this._events[e];if(null!=i)if(i.run)t&&i.caller!==t||null!=n&&i.method!==n||r&&!i.once||(delete this._events[e],i.recover());else{for(var s=0,o=0,l=i.length;o<l;o++){var u=i[o];u?!u||t&&u.caller!==t||null!=n&&u.method!==n||r&&!u.once||(s++,i[o]=null,u.recover()):s++}s===l&&delete this._events[e]}return this},t.offAll=function(e){void 0===e&&(e=null);var t=this._events;if(!t)return this;if(e)this._recoverHandlers(t[e]),delete t[e];else{for(var n in t)this._recoverHandlers(t[n]);this._events=null}return this},t.offAllCaller=function(e){if(e&&this._events)for(var t in this._events)this.off(t,e,null);return this},t._recoverHandlers=function(e){if(e)if(e.run)e.recover();else for(var t=e.length-1;t>-1;t--)e[t]&&(e[t].recover(),e[t]=null)},e}());var i=function(e){function n(t,n,r,i){return e.call(this,t,n,r,i)||this}return t(n,e),n.prototype.recover=function(){this._id>0&&(this._id=0,n._pool.push(this.clear()))},n.create=function(e,t,r,i){return void 0===r&&(r=null),void 0===i&&(i=!0),n._pool.length?n._pool.pop().setTo(e,t,r,i):new n(e,t,r,i)},n}(r);i._pool=[],n._RF.pop()}}}));

System.register("chunks:///_virtual/EventManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventDispatcher.ts"],(function(n){var t,e,i;return{setters:[function(n){t=n.createClass},function(n){e=n.cclegacy},function(n){i=n.EventDispatcher}],execute:function(){e._RF.push({},"7204fiGrV1BhrrgnLsMzvDM","EventManager",void 0),n("EventManager",function(){function n(){this._ed=new i}var e=n.prototype;return e.event=function(n){for(var t=arguments.length,e=new Array(t>1?t-1:0),i=1;i<t;i++)e[i-1]=arguments[i];this._ed.event(n,e)},e.on=function(n,t,e){this._ed.on(n,t,e)},e.off=function(n,t,e){this._ed.off(n,t,e)},e.offAllCaller=function(n){this._ed.offAllCaller(n)},t(n,null,[{key:"Inst",get:function(){return null===this.inst&&(this.inst=new n),this.inst}}]),n}()).inst=null,e._RF.pop()}}}));

System.register("chunks:///_virtual/FitUI.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,i,o,r,n,a,l,p,u,s,f,c;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,o=t.initializerDefineProperty,r=t.assertThisInitialized,n=t.createClass},function(t){a=t.cclegacy,l=t._decorator,p=t.Widget,u=t.Enum,s=t.view,f=t.sys,c=t.Component}],execute:function(){var b,h,y,g,m,d,O,I,R,N,v,w,L,T,A,z,D,S,P,E,C,F,k,H,V,W,B,_,U,Z,j,x,M;a._RF.push({},"b88d5WHo0JKWLWAOk8ocpaW","FitUI",void 0);var q=l.ccclass,J=l.property,K=l.executeInEditMode,G=l.menu,Q=l.requireComponent,X=t("FitUIPlatform",function(t){return t[t.ANDROID=0]="ANDROID",t[t.IOS=1]="IOS",t[t.OTHER=2]="OTHER",t}({})),Y=t("FitUIOrientation",function(t){return t[t.HORIZONTAL=0]="HORIZONTAL",t[t.VERTICAL=1]="VERTICAL",t}({})),$=function(){return this.orientation==Y.HORIZONTAL},tt=function(){return this.orientation==Y.VERTICAL};t("default",(b=G("公用组件/FitUI"),h=Q(p),y=J({displayName:"适配方向",type:u(Y)}),g=J({displayName:"安卓设备",type:u(X)}),m=J({displayName:"left",visible:$}),d=J({displayName:"right",visible:$}),O=J({displayName:"top",visible:tt}),I=J({displayName:"bottom",visible:tt}),R=J({displayName:"苹果设备",type:u(X)}),N=J({displayName:"left",visible:$}),v=J({displayName:"right",visible:$}),w=J({displayName:"top",visible:tt}),L=J({displayName:"bottom",visible:tt}),T=J({displayName:"其它设备",type:u(X)}),A=J({displayName:"left",visible:$}),z=J({displayName:"right",visible:$}),D=J({displayName:"top",visible:tt}),S=J({displayName:"bottom",visible:tt}),q(P=b(P=K(P=h((C=e((E=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return e=t.call.apply(t,[this].concat(n))||this,o(e,"orientation",C,r(e)),o(e,"left",F,r(e)),o(e,"right",k,r(e)),o(e,"top",H,r(e)),o(e,"bottom",V,r(e)),o(e,"iLeft",W,r(e)),o(e,"iRight",B,r(e)),o(e,"iTop",_,r(e)),o(e,"iBottom",U,r(e)),o(e,"oLeft",Z,r(e)),o(e,"oRight",j,r(e)),o(e,"oTop",x,r(e)),o(e,"oBottom",M,r(e)),e}i(e,t);var a=e.prototype;return a.onLoad=function(){this.applySettings()},a.applySettings=function(){var t=s.getVisibleSize(),e=f.platform,i=t.width/t.height;if((i=this.orientation==Y.VERTICAL?i:1/i)>=.5)this.updateFitStrategy(!0,!0);else{this.orientation==Y.VERTICAL&&this.updateFitStrategy(!0,!1),this.orientation==Y.HORIZONTAL&&this.updateFitStrategy(!1,!0);var o={top:this.top,left:this.left,right:this.right,bottom:this.bottom},r={top:this.iTop,left:this.iLeft,right:this.iRight,bottom:this.iBottom},n={top:this.oTop,left:this.oLeft,right:this.oRight,bottom:this.oBottom};switch(e){case f.Platform.ANDROID:this.fitPhone(o);break;case f.Platform.IOS:this.fitPhone(r);break;default:switch(f.os){case f.OS.IOS:this.fitPhone(r);break;case f.OS.ANDROID:this.fitPhone(o);break;default:this.fitPhone(n)}}}},a.fitPhone=function(t){var e=s.getVisibleSize(),i=this.orientation==Y.VERTICAL?e.height:e.width,o=44*i/812,r=34*i/812;switch(this.orientation){case Y.VERTICAL:t.top&&this.updateWidget("top",o),t.bottom&&this.updateWidget("bottom",r);break;case Y.HORIZONTAL:t.left&&this.updateWidget("left",r),t.right&&this.updateWidget("right",o)}},a.updateWidget=function(t,e){var i=this.getComponent(p);i&&(i["default_"+t]||(i["default_"+t]=i[""+t]),i[""+t]=i["default_"+t]+e)},a.updateFitStrategy=function(t,e){},n(e,[{key:"a",get:function(){return X.ANDROID}},{key:"i",get:function(){return X.IOS}},{key:"o",get:function(){return X.OTHER}}]),e}(c)).prototype,"orientation",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Y.VERTICAL}}),e(E.prototype,"a",[g],Object.getOwnPropertyDescriptor(E.prototype,"a"),E.prototype),F=e(E.prototype,"left",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),k=e(E.prototype,"right",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),H=e(E.prototype,"top",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),V=e(E.prototype,"bottom",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),e(E.prototype,"i",[R],Object.getOwnPropertyDescriptor(E.prototype,"i"),E.prototype),W=e(E.prototype,"iLeft",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),B=e(E.prototype,"iRight",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_=e(E.prototype,"iTop",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),U=e(E.prototype,"iBottom",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),e(E.prototype,"o",[T],Object.getOwnPropertyDescriptor(E.prototype,"o"),E.prototype),Z=e(E.prototype,"oLeft",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),j=e(E.prototype,"oRight",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),x=e(E.prototype,"oTop",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),M=e(E.prototype,"oBottom",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),P=E))||P)||P)||P)||P));a._RF.pop()}}}));

System.register("chunks:///_virtual/FollowCamera.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Global.ts","./Component.ts","./GameConst.ts","./EventManager.ts"],(function(t){var o,e,a,i,n,r,s,l,c,u,h,d,f,p,m;return{setters:[function(t){o=t.applyDecoratedDescriptor,e=t.inheritsLoose,a=t.initializerDefineProperty,i=t.assertThisInitialized,n=t.createClass},function(t){r=t.cclegacy,s=t._decorator,l=t.quat,c=t.Vec3,u=t.v3,h=t.Quat},function(t){d=t.Global},function(t){f=t.default},function(t){p=t.default},function(t){m=t.EventManager}],execute:function(){var _,g,k;r._RF.push({},"d964791v0ZGD4GjyqvgerDR","FollowCamera",void 0);var v=s.ccclass,I=s.property,L=(l(),l());t("FollowCamera",v("FollowCamera")((k=o((g=function(t){function o(){for(var o,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(o=t.call.apply(t,[this].concat(n))||this)._camera_init_pos=null,o._camera_init_rot=null,o.camera=null,o.camera1=null,o.camera2=null,o.camera3=null,o.flag=!1,o._target=null,o.offset=new c(0,0,0),a(o,"followSpeed",k,i(o)),o.aidTime=0,o.queue=[],o.curLookInfo=null,o}e(o,t);var r=o.prototype;return r.start=function(){this._camera_init_pos=this.camera.position.clone(),this._camera_init_rot=this.camera.rotation.clone()},r.onEnable=function(){var t=this;m.Inst.on(p.EventType.KEYCODE_SPACE,this,(function(){t.queue.length=0,t.addLookAtNode(d.player.node,t.flag?t.camera2:t.camera1,9999),t.flag=!t.flag})),m.Inst.on(p.EventType.ENTER_SKIN_CAMERA,this,(function(){t.queue.length=0,console.log("ENTER_SKIN_CAMERA"),t.addLookAtNode(d.player.node,t.camera3,9999)})),m.Inst.on(p.EventType.EXIT_SKIN_CAMERA,this,(function(){t.queue.length=0,console.log("EXIT_SKIN_CAMERA"),t.addLookAtNode(d.player.node,t.camera1,9999)}))},r.lateUpdate=function(t){if(this.target&&this.target.isValid){var o=this.target;this.queue.length>0&&(this.curLookInfo=this.queue[0],o=this.curLookInfo.node);var e=u();c.add(e,o.worldPosition,this.offset);var a=this.node.worldPosition,i=u();c.lerp(i,a,e,.1),this.node.setWorldPosition(i);var n=u();this.curLookInfo&&c.subtract(n,this.node.worldPosition,e).length()<.1&&(this.aidTime+=t,this.aidTime>this.curLookInfo.lookTime&&(this.queue.shift(),this.curLookInfo.callback&&this.curLookInfo.callback(),this.curLookInfo=null,this.aidTime=0)),this.curLookInfo&&this.curLookInfo.cameraLerpNode?(this.camera.position=c.lerp(n,this.camera.position,this.curLookInfo.cameraLerpNode.position,.1),this.camera.rotation=h.slerp(L,this.camera.rotation,this.curLookInfo.cameraLerpNode.rotation,.1)):(this.camera.position=c.lerp(n,this.camera.position,this._camera_init_pos,.1),this.camera.rotation=h.slerp(L,this.camera.rotation,this._camera_init_rot,.1))}},r.addLookAtNode=function(t,o,e,a){void 0===o&&(o=null),void 0===e&&(e=.5),void 0===a&&(a=null),this.queue.push({node:t,cameraLerpNode:o,lookTime:e,callback:a})},n(o,[{key:"target",get:function(){return this._target},set:function(t){this._target=t}}]),o}(f)).prototype,"followSpeed",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),_=g))||_);r._RF.pop()}}}));

System.register("chunks:///_virtual/FollowField.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Cell.ts"],(function(t){var i,e,s,r,o,h,l;return{setters:[function(t){i=t.createForOfIteratorHelperLoose},function(t){e=t.cclegacy,s=t._decorator,r=t.v3,o=t.v2,h=t.warn},function(t){l=t.Cell}],execute:function(){e._RF.push({},"7c4bfysp4VPL7RW5e0w1srB","FollowField",void 0);s.ccclass,s.property,t("FollowField",function(){function t(t,i){this.grid=[],this.gridSize=void 0,this.cellRadius=void 0,this.targetCell=void 0,this.debug=void 0,this.offset=void 0,this.dirs=[[0,1],[0,-1],[1,0],[-1,0]],this.dirsAll=[[0,0],[0,1],[0,-1],[1,0],[-1,0],[1,-1],[1,1],[-1,1],[-1,-1]],this.debug=t,this.offset=i}var e=t.prototype;return e.createGrid=function(t,i){this.cellRadius=t,this.gridSize=i;for(var e=0;e<i.x;e++){this.grid[e]=[];for(var s=0;s<i.y;s++){var o=r(s*t*2+t-this.offset.x,0,e*t*2+t-this.offset.y),h=new l(o,e,s);this.grid[e][s]=h}}this.debug&&this.debug.createGrid(this.grid,this.offset)},e.createFollowField=function(){for(var t=0;t<this.grid.length;t++)for(var e=0;e<this.grid[t].length;e++)for(var s,r=this.grid[t][e],h=this.getNeighbors(r,this.dirsAll),l=r.bestCost,g=i(h);!(s=g()).done;){var d=s.value;d.bestCost<l&&(l=d.bestCost,r.bestDir=o(d.row-r.row,d.col-r.col))}this.debug&&this.debug.createFollowField(this.grid)},e.setBlock=function(t,i){t<0||i<0||t>=this.grid.length||i>=this.grid[0].length||(this.grid[t][i].increaseCost(255),this.debug&&this.debug.setBlock(t,i))},e.removeBlock=function(t,i){t<0||i<0||t>=this.grid.length||i>=this.grid[0].length||(this.grid[t][i].cost=1,this.debug&&this.debug.removeBlock(t,i),28==t&&46==i&&console.log("28x46","--------------------1"))},e.resetBestCost=function(){for(var t=0;t<this.grid.length;t++)for(var i=0;i<this.grid[t].length;i++){var e=this.grid[t][i];e.bestCost=255,e.bestDir=o(0,0)}},e.setFollowTarget=function(t){var i=Math.floor(t.x+this.offset.x),e=Math.floor(t.z+this.offset.y);if(e<0||i<0||e>=this.grid.length||i>=this.grid[0].length)h("设置目标格子错误");else{if(255==this.grid[e][i].cost)for(var s=1;s<=4;s++){for(var r=e-s,o=i-s,l=i+s,g=!1,d=e+s;d>=r;d--){for(var n=o;n<=l;n++)if(d>=0&&n>=0&&d<this.grid.length&&n<this.grid[0].length&&this.grid[d][n].cost<255){e=d,i=n,g=!0;break}if(g)break}if(g)break}this.createIntegrationField(this.grid[e][i]),this.debug&&this.debug.setFollowTarget(this.grid,e,i)}},e.createIntegrationField=function(t){this.targetCell=t,t.bestCost=0;var e=[];for(e.push(t);e.length>0;)for(var s,r=e.shift(),o=this.getNeighbors(r),h=i(o);!(s=h()).done;){var l=s.value;255!=l.cost&&(l.cost+r.bestCost<l.bestCost&&(l.bestCost=l.cost+r.bestCost,e.push(l)))}},e.getNeighbors=function(t,e){void 0===e&&(e=this.dirs);for(var s,r=[],o=i(e);!(s=o()).done;){var h=s.value,l=h[0]+t.row,g=h[1]+t.col;l<0||g<0||l>=this.grid.length||g>=this.grid[0].length||r.push(this.grid[l][g])}return r},e.getCellByPositon=function(t){var i=Math.floor(t.x+this.offset.x),e=Math.floor(t.z+this.offset.y);return e<0||i<0||e>=this.grid.length||i>=this.grid[0].length?null:this.grid[e][i]},t}());e._RF.pop()}}}));

System.register("chunks:///_virtual/FSM.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var i,n,r,s,e;return{setters:[function(t){i=t.inheritsLoose,n=t.createClass},function(t){r=t.cclegacy,s=t._decorator,e=t.Component}],execute:function(){var u;r._RF.push({},"5dbbbgQcf1C5IRp3rlWtnFF","FSM",void 0);var h=s.ccclass;s.property,t("FSMAction",(function(t,i,n,r,s){void 0===n&&(n=null),void 0===r&&(r=null),void 0===s&&(s=null),this.onUpdate=null,this.onExit=null,this.onEnter=null,this.id=null,this.thisObj=null,this.thisObj=t,this.id=i,this.onUpdate=r,this.onEnter=n,this.onExit=s})),t("default",h(u=function(t){function r(){for(var i,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(i=t.call.apply(t,[this].concat(r))||this).curr=null,i.prev=null,i._target=null,i.timeElapsed=0,i.states={},i._isPaused=!1,i._running=!0,i}i(r,t);var s=r.prototype;return s.pause=function(){this._isPaused=!0},s.resume=function(){this._isPaused=!1},s.setRunning=function(t){this._running=t},s.init=function(t){this.states={},this.curr=null,this.prev=null,this._target=t,this.timeElapsed=0},s.getState=function(t){return this.states[t]},s.getCurrState=function(){return this.curr},s.getPrevState=function(){return this.prev},s.addState=function(t){this.states[t.id]=t},s.enterState=function(t,i){void 0===i&&(i=null),this.timeElapsed=0;var n=this.states[t];this.curr=n,n.onEnter&&n.onEnter.call(n.thisObj,i)},s.resetCurrState=function(){this.timeElapsed=0,this.curr.onExit&&this.curr.onExit.call(this.curr.thisObj),this.curr.onEnter&&this.curr.onEnter.call(this.curr.thisObj)},s.changeState=function(t,i){void 0===i&&(i=!1);var n=this.states[t];if(null==n){var r,s;(null==(r=this.curr)?void 0:r.onExit)&&(null==(s=this.curr)||s.onExit.call(this.curr.thisObj)),this.prev=this.curr,this.curr=null}else{var e,u;if(this.curr&&this.curr.id==t&&!i)return;this.timeElapsed=0,(null==(e=this.curr)?void 0:e.onExit)&&(null==(u=this.curr)||u.onExit.call(this.curr.thisObj)),this.prev=this.curr,this.curr=n,this.curr.onEnter&&this.curr.onEnter.call(this.curr.thisObj)}},s.changeNoneStateDelayCall=function(t,i){this.changeState(-999),this.scheduleOnce((function(){i()}),t)},s.revertState=function(){this.changeState(this.prev.id)},s.isInState=function(t){return this.curr==this.states[t]},s.onEnable=function(){this.schedule(this.fixedUpdate.bind(this))},s.onDisable=function(){this.unscheduleAllCallbacks()},s.fixedUpdate=function(t){this._running&&(this._isPaused||(this.timeElapsed+=t,this.curr&&this.curr.onUpdate&&this.curr.onUpdate.call(this.curr.thisObj,t)))},n(r,[{key:"target",get:function(){return this._target}}]),r}(e))||u);r._RF.pop()}}}));

System.register("chunks:///_virtual/GameConst.ts",["cc"],(function(e){var a;return{setters:[function(e){a=e.cclegacy}],execute:function(){a._RF.push({},"432affC3gVA5KUj8McNSpun","GameConst",void 0);var n=e("E_UILAYER",function(e){return e.bg="bg",e.title="title",e.popup="popup",e.dialog="dialog",e.top="top",e}({})),E=e("default",(function(){}));E.winPath={IndicatorWin:{name:"IndicatorWin",path:"prefabs/game/",bundle:"game",layer:n.bg},GameWin:{name:"GameWin",path:"prefabs/game/",bundle:"game",layer:n.bg},LoseWin:{name:"LoseWin",path:"prefabs/result/",bundle:"game",layer:n.popup},ReliveWin:{name:"ReliveWin",path:"prefabs/result/",bundle:"game",layer:n.popup},PassWin:{name:"PassWin",path:"prefabs/result/",bundle:"game",layer:n.popup},WeaponWin:{name:"WeaponWin",path:"prefabs/game/",bundle:"game",layer:n.popup},LoadingWin:{name:"LoadingWin",path:"prefabs/loading/",bundle:"game",layer:n.popup},GuideWin:{name:"GuideWin",path:"prefabs/guide/",bundle:"game",layer:n.top},UpgradeWin:{name:"UpgradeWin",path:"ui/",bundle:"prefabs",layer:n.popup},BoostWin:{name:"BoostWin",path:"ui/",bundle:"prefabs",layer:n.popup},SpecialOrderWin:{name:"SpecialOrderWin",path:"ui/",bundle:"prefabs",layer:n.popup},SkinWin:{name:"SkinWin",path:"prefabs/game/",bundle:"game",layer:n.dialog},TaskWin:{name:"TaskWin",path:"prefabs/game/",bundle:"game",layer:n.dialog},SettingWin:{name:"SettingWin",path:"prefabs/game/",bundle:"game",layer:n.popup},DroneWin:{name:"DroneWin",path:"prefabs/game/",bundle:"game",layer:n.popup},UnlockWeaponWin:{name:"UnlockWeaponWin",path:"prefabs/game/",bundle:"game",layer:n.popup}},E.EventType={GameShow:"GameShow",GameHide:"GameHide",EDIT_MAP:"EDIT_MAP",PropChange:"PropChange",JoystickStart:"JoystickStart",JoystickMove:"JoystickMove",JoystickStop:"JoystickStop",EVT_UNLOCK_MAPITEM:"EVT_UNLOCK_MAPITEM",CHANGE_SKIN:"ChangeSkin",NotEnoughMoney:"NotEnoughMoney",SWITCH_WEAPON:"SWITCH_WEAPON",CREATE_BULLET:"CREATE_BULLET",PlayerHpChange:"PlayerHpChange",KEYCODE_SPACE:"KEYCODE_SPACE",KEYCODE_F:"KEYCODE_F",GuideChange:"GuideChange",Remove:"Remove",UpdateHeadTip:"UpdateHeadTip",RemoveSleepState:"RemoveSleepState",GameStart:"GameStart",RemoveBarricade:"RemoveBarricade",onPass:"onPass",onLose:"onLose",NewWave:"NewWave",NewScene:"NewScene",onRepair:"onRepair",WeaponUnlock:"WeaponUnlock",MoneyChange:"MoneyChange",ENTER_SKIN_CAMERA:"ENTER_SKIN_CAMERA",EXIT_SKIN_CAMERA:"EXIT_SKIN_CAMERA",ENTER_PLAYER_UPGRADE:"ENTER_PLAYER_UPGRADE",EXIT_PLAYER_UPGRADE:"EXIT_PLAYER_UPGRADE",ENTER_BARRICADE_TRAP_UPGRADE:"ENTER_BARRICADE_TRAP_UPGRADE",EXIT_BARRICADE_TRAP_UPGRADE:"EXIT_BARRICADE_TRAP_UPGRADE",UpdateFightingProgress:"UpdateFightingProgress",ENTER_TURRET_UNLOCK_AREA:"ENTER_TURRET_UNLOCK_AREA",EXIT_TURRET_UNLOCK_AREA:"EXIT_TURRET_UNLOCK_AREA",ENTER_TRAP_UNLOCK_AREA:"ENTER_TRAP_UNLOCK_AREA",EXIT_TRAP_UNLOCK_AREA:"EXIT_TRAP_UNLOCK_AREA",RefreshWeaponHolder:"RefreshWeaponHolder"};e("ItemType",function(e){return e[e.Money=1]="Money",e[e.Burger=2]="Burger",e[e.Package=3]="Package",e[e.Litter=4]="Litter",e}({})),e("UpgradeType",function(e){return e[e.PLAYER_HP=1]="PLAYER_HP",e[e.PLAYER_SPEED=2]="PLAYER_SPEED",e[e.BARRICADE=3]="BARRICADE",e[e.TRAP=4]="TRAP",e}({})),e("FacilityAreaType",function(e){return e[e.DEFAULT=0]="DEFAULT",e[e.UNLOCK=1]="UNLOCK",e[e.UPGRADE=2]="UPGRADE",e[e.WEAPON_UPGRADE=3]="WEAPON_UPGRADE",e[e.PLAYER_UPGRADE=4]="PLAYER_UPGRADE",e[e.SKIN=5]="SKIN",e[e.BARRICADE_UPGRADE=6]="BARRICADE_UPGRADE",e[e.TRAP=7]="TRAP",e[e.TURRET_AREA=8]="TURRET_AREA",e[e.TRAP_AREA=9]="TRAP_AREA",e[e.GROUND_WEAPON=10]="GROUND_WEAPON",e}({}));a._RF.pop()}}}));

System.register("chunks:///_virtual/GameManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameConst.ts","./Global.ts","./AssetPool.ts","./Config.ts","./Model.ts","./EventManager.ts","./WindowManager.ts","./AudioMgr.ts","./Utils.ts","./GuideManager.ts","./MapManager.ts","./Enemy.ts","./FollowCamera.ts","./Player.ts","./Component.ts","./Drone.ts","./Coin.ts","./BulletShell.ts","./AdManager.ts"],(function(e){var n,t,r,a,o,i,s,l,c,u,f,h,p,d,m,v,g,y,w,b,I,C,P,x,E,M,A,D,k,T,B,F,S,N,_,G;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,r=e.initializerDefineProperty,a=e.assertThisInitialized,o=e.asyncToGenerator,i=e.regeneratorRuntime,s=e.createClass},function(e){l=e.cclegacy,c=e._decorator,u=e.Node,f=e.v3,h=e.Vec3,p=e.Camera,d=e.find,m=e.view,v=e.ParticleSystem,g=e.tween},function(e){y=e.default},function(e){w=e.Global},function(e){b=e.default},function(e){I=e.default},function(e){C=e.default},function(e){P=e.EventManager},function(e){x=e.default},function(e){E=e.AudioMgr},function(e){M=e.default},function(e){A=e.default},function(e){D=e.MapManager},function(e){k=e.Enemy},function(e){T=e.FollowCamera},function(e){B=e.Player},function(e){F=e.default},function(e){S=e.Drone},function(e){N=e.Coin},function(e){_=e.default},function(e){G=e.default}],execute:function(){var L,W,R,O,z,j,V,U,Z;l._RF.push({},"7a3e5gf5olOR72QKYtzmfjG","GameManager",void 0);var X=c.ccclass,H=c.property,q=window.SAT,K=new q.Response;e("GameManager",(L=X("GameManager"),W=H(u),R=H(u),O=H(T),L((V=n((j=function(e){function n(){for(var n,t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return n=e.call.apply(e,[this].concat(o))||this,r(n,"node_container",V,a(n)),r(n,"uiNode",U,a(n)),r(n,"camera",Z,a(n)),n.sceneNode=null,n.map=null,n.createTimer=0,n.createInterval=2.5,n.roles=[],n.coins=[],n.totalEnemyCount=0,n.enemyCount=0,n.running=!1,n.bulletNode=void 0,n.flyBullets=[],n._pause=!1,n.followDealy=0,n.tmp=f(),n}t(n,e);var l=n.prototype;return l.start=function(){var e=o(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.load();case 2:C.loadData(),G.initVideo(),G.initGridAd(),G.initInterstitialAd(),G.showShareMenu(),w.camera=this.camera,w.game=this,x.Instance().register(this.uiNode),E.Instance().init(),this.addListener(),this.bulletNode=new u("BulletNode"),this.node.addChild(this.bulletNode),this.newLevel();case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.addListener=function(){P.Inst.on(y.EventType.CREATE_BULLET,this,this.onCreateBullet),P.Inst.on(y.EventType.GameStart,this,this.newWave),P.Inst.on(y.EventType.onLose,this,this.onReset),P.Inst.on(y.EventType.onPass,this,this.onReset),P.Inst.on(y.EventType.NewScene,this,this.newLevel)},l.preLoad=function(){var e=this;x.Instance().open(y.winPath.LoadingWin,{callback:function(){e.onPredLoadComplete()}})},l.onPredLoadComplete=function(){var e=o(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.createGame();case 2:x.Instance().open(y.winPath.GameWin),x.Instance().open(y.winPath.IndicatorWin);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.onCreateBullet=function(){var e=o(i().mark((function e(n){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.prefabName){e.next=8;break}return e.next=3,b.Instance().createObjAsync("prefabs/bullets/"+n.prefabName,n.prefabName);case 3:(t=e.sent).worldPosition=n.initPos,this.node.addChild(t),n.node=t,t.lookAt(n.targetP,h.UP);case 8:this.flyBullets.push(n);case 9:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}(),l.removeAll=function(){this.reset(),w.player&&b.Instance().put(w.player.node),w.drone&&b.Instance().put(w.drone.node),this.sceneNode&&(this.sceneNode.destroy(),this.sceneNode=null),x.Instance().closeAll(null)},l.newLevel=function(){this.removeAll(),this.preLoad(),2==C.game.level&&0==C.game.unlockDrone&&(x.Instance().open(y.winPath.DroneWin),C.game.unlockDrone=!0,C.save())},l.reset=function(){var e;null==(e=this.map)||e.reset(),this.roles.forEach((function(e){b.Instance().put(e.node)})),this.coins.forEach((function(e){b.Instance().put(e.node)})),this.roles.length=0,this.coins.length=0,this.running=!1,w.player&&(w.player.isAlive()||w.player.node.setWorldPosition(f()),w.player.relive()),C.game.getMoney=0,C.game.getGem=0},l.onReset=function(){this.reset()},l.newWave=function(){var e;this.reset(),null==(e=w.map)||e.hideRepairIcon(),this.running=!0,console.log("开始游戏"),this.checkCreateEnemys()},l.update=function(e){this._pause||(this.updateBullets(e),this.running&&this.updateFollowField(e))},l.updateBullets=function(e){for(var n=this,t=function(){var t=n.flyBullets[r];t.move(e),t.checkHit()&&(t.sound&&E.Instance().playSFX(t.sound),t.hitFX&&b.Instance().createObjAsync("prefabs/bullets/"+t.hitFX,t.hitFX).then((function(e){n.node.addChild(e),t.worldPosition.y=0,e.setWorldPosition(t.targetZombie.node.worldPosition),e.getComponentsInChildren(v).forEach((function(e){e.play()})),g(e).delay(1).call((function(){b.Instance().put(e)}))})),t.hitTarget()),t.checkDestroy()&&(n.flyBullets.splice(r,1),null!=t.node&&b.Instance().put(t.node))},r=this.flyBullets.length-1;r>=0;r--)t()},l.updateFollowField=function(e){if(this.followDealy+=e,this.followDealy>.1){if(this.followDealy=0,!w.player||!w.followFiled)return;w.followFiled.resetBestCost(),w.followFiled.setFollowTarget(w.player.node.worldPosition.clone()),w.followFiled.createFollowField()}},l.checkCreateEnemys=function(){var e=I.mission.loadLevel(C.game.level,C.game.currentWave);M.shuffle(e),this.enemyCount=this.totalEnemyCount=e.length,P.Inst.event(y.EventType.UpdateFightingProgress,1),console.log("enemy count: "+this.enemyCount);var n=[];if(w.map.barricades.forEach((function(e){e.node.activeInHierarchy&&n.push(e)})),1!=n.length){for(var t=Math.round(.5*e.length),r=[],a=0,o=0;o<n.length;o++){var i=0==o?t:Math.round((e.length-a)/(n.length-o));r.push(e.slice(a,a+i)),a+=i}M.shuffle(r);for(o=0;o<n.length;o++)n[o].setEnemys(r[o])}else n[0].setEnemys(e)},l.createGame=function(){var e=o(i().mark((function e(){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.createScene();case 2:return n=f(0,0,0),e.next=5,this.createPlayer(n);case 5:if(2!=C.game.level){e.next=8;break}return e.next=8,this.createDrone(n);case 8:A.Instance().startGuide();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.createScene=function(){var e=this,n="Level"+I.mission.getWaveData(C.game.level,C.game.currentWave).mapID;return new Promise(o(i().mark((function t(r,a){var o;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=null,t.next=3,b.Instance().createObjAsync("level/"+n,n);case 3:(o=t.sent).parent=e.node_container,e.sceneNode=o,e.map=o.getComponent(D)||o.addComponent(D),r(null);case 8:case"end":return t.stop()}}),t)}))))},l.createPlayer=function(e){var n=this;return new Promise(o(i().mark((function t(r,a){var o,s;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b.Instance().createObjAsync("prefabs/entity/Player","Player");case 2:(o=t.sent).parent=n.node_container,o.position=e,s=o.getComponent(B)||o.addComponent(B),console.log("playerPos",o.position),w.player=s,s.setData(),n.camera.target=o,r(null);case 11:case"end":return t.stop()}}),t)}))))},l.createDrone=function(e){var n=this;return new Promise(o(i().mark((function t(r,a){var o,s;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b.Instance().createObjAsync("prefabs/entity/Drone","Drone");case 2:(o=t.sent).parent=n.node_container,o.position=e,s=o.getComponent(S),w.drone=s,s.reset(),r(null);case 9:case"end":return t.stop()}}),t)}))))},l.createEnemy=function(e,n,t,r){var a=this;return void 0===r&&(r=!1),new Promise(o(i().mark((function o(s,l){var c,u,f;return i().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return c=I.enemy.get(e),o.next=3,b.Instance().createObjAsync(c.viewUrl,c.viewUrl);case 3:(u=o.sent).parent=a.node_container,f=u.getComponent(k),u.position=n,f.barricade=t,f.setData(c),f.first=r,a.roles.push(f),s(u);case 12:case"end":return o.stop()}}),o)}))))},l.removeEnemy=function(e){var n=this,t=this.roles.findIndex((function(n){return n==e}));if(-1!=t&&(this.roles.splice(t,1),b.Instance().put(e.node),this.enemyCount--,P.Inst.event(y.EventType.UpdateFightingProgress,this.enemyCount/this.totalEnemyCount),0==this.enemyCount)){P.Inst.event(y.EventType.ENTER_SKIN_CAMERA),this.running=!1,this.pause=!0,C.game.currentWave++,w.player.playAni("Character_Skin_Idle_Vip");var r=!1;C.game.currentWave>I.mission.getTotalWaveByLevel(C.game.level)?(r=!0,C.game.level++,C.game.currentWave=1,C.game.barricadeHp={}):w.map.saveBarricadeHP(),C.save(),this.scheduleOnce((function(){n.pause=!1,x.Instance().open(y.winPath.PassWin,{level:C.game.level,wave:C.game.currentWave,new:r})}),1)}},l.dropCoin=function(){var e=o(i().mark((function e(n,t){var r,a,o,s,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=0;case 1:if(!(r<t)){e.next=15;break}return e.next=4,b.Instance().createObjAsync("prefabs/entity/Coin","Coin");case 4:(a=e.sent).parent=this.node,a.position=n,a.name="coin",o=6.28*Math.random(),s=1*Math.random()+1,l=f(Math.cos(o)*s+n.x,.1,Math.sin(o)*s+n.z),a.getComponent(N).startUp(l);case 12:r++,e.next=1;break;case 15:case"end":return e.stop()}}),e,this)})));return function(n,t){return e.apply(this,arguments)}}(),l.dropDiamond=function(){var e=o(i().mark((function e(n,t){var r,a,o,s,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=0;case 1:if(!(r<t)){e.next=15;break}return e.next=4,b.Instance().createObjAsync("prefabs/entity/Gem","Gem");case 4:(a=e.sent).parent=this.node,a.position=n,a.name="gem",o=6.28*Math.random(),s=1*Math.random()+1,l=f(Math.cos(o)*s+n.x,.1,Math.sin(o)*s+n.z),a.getComponent(N).startUp(l);case 12:r++,e.next=1;break;case 15:case"end":return e.stop()}}),e,this)})));return function(n,t){return e.apply(this,arguments)}}(),l.createBulletShell=function(){var e=o(i().mark((function e(n){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.Instance().createObjAsync("prefabs/bullets/BulletShell","BulletShell");case 2:(t=e.sent).parent=w.map.node,t.worldPosition=n,t.name="BulletShell",t.getComponent(_).playDropAnimation();case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),l.collideWithOther=function(e){this.getRolesInRadius(e,8).forEach((function(n){if(q.testCircleCircle(e.circle,n.circle,K)){var t=.18*Math.random()-.09,r=.18*Math.random()-.09;K.overlapV.x+=t,K.overlapV.y+=r;var a=e.mass/(e.mass+n.mass),o=1-a;e.offsetX-=o*K.overlapV.x,e.offsetZ-=o*K.overlapV.y,n.offsetX+=a*K.overlapV.x,n.offsetZ+=a*K.overlapV.y}}))},l.getRolesInRadius=function(e,n){return void 0===n&&(n=4),this.roles.filter((function(t){var r=Math.abs(t.node.worldPosition.x-e.node.worldPosition.x),a=Math.abs(t.node.worldPosition.z-e.node.worldPosition.z);return r<=n&&a<=n&&t!==e&&t.isAlive()}))},l.getTargetZombie=function(e,n){if(0==this.roles.length)return null;var t=1/0,r=null;return this.roles.forEach((function(a){var o=h.squaredDistance(e,a.node.worldPosition);o<=n*n&&o<t&&a.isAlive()&&(t=o,r=a)})),r},l.getTargetZombies=function(e,n){if(0==this.roles.length)return[];var t=[];return this.roles.forEach((function(r){h.squaredDistance(e,r.node.worldPosition)<=n*n&&r.isAlive()&&t.push(r)})),t},l.getSegmentLineTouchZombies=function(e,n){var t=[];return this.roles.forEach((function(r){M.pointToSegmentDist(r.node.worldPosition,e,n)<=1&&r.isAlive()&&t.push(r)})),t},l.getTargetFanZombies=function(e,n,t,r){var a=this;if(0==this.roles.length)return[];var o=this.getTargetZombies(e,n),i=[];return o.forEach((function(n){h.subtract(a.tmp,n.node.worldPosition,e),M.angle(a.tmp,r)<.5*t&&n.isAlive()&&i.push(n)})),i},l.getOutScreenZombieByBarricadeId=function(e){if(0==this.roles.length)return null;var n=1/0,t=null;return this.roles.forEach((function(r){var a=r;if(a.ownBarricadeID==e&&a.first){var o=f();w.camera.camera.getComponent(p).convertToUINode(a.node.worldPosition,d("Canvas"),o);var i=m.getVisibleSize().width,s=m.getVisibleSize().height;if(o.x<.5*-i||o.x>.5*i||o.y<.5*-s||o.y>.5*s){var l=h.squaredDistance(w.player.node.worldPosition,r.node.worldPosition);l<n&&r.isAlive()&&(n=l,t=r)}}})),t},l.playMoneyAni=function(e,n,t){},s(n,[{key:"pause",get:function(){return this._pause},set:function(e){this._pause=e}}]),n}(F)).prototype,"node_container",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=n(j.prototype,"uiNode",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=n(j.prototype,"camera",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=j))||z));l._RF.pop()}}}));

System.register("chunks:///_virtual/GameModel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameConst.ts","./MsgHints.ts","./Config.ts","./EventManager.ts","./ModelBase.ts"],(function(e){var n,t,r,i,o,a,u,l,c,f,p,s;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,r=e.initializerDefineProperty,i=e.assertThisInitialized,o=e.createClass},function(e){a=e.cclegacy},function(e){u=e.default},function(e){l=e.default},function(e){c=e.default},function(e){f=e.EventManager},function(e){p=e.default,s=e.save}],execute:function(){var b,g,y,d,m,v,h,w,k,I,z,_,M,W,D,L,U;a._RF.push({},"909f3hZff1N/LoWxa4yOjMn","GameModel",void 0);e("default",(g=n((b=function(e){function n(){for(var n,t=arguments.length,o=new Array(t),a=0;a<t;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o))||this,r(n,"level",g,i(n)),r(n,"unlockDrone",y,i(n)),r(n,"currentWave",d,i(n)),r(n,"currentWeapon",m,i(n)),r(n,"guideID",v,i(n)),r(n,"currentSkin",h,i(n)),r(n,"skinIds",w,i(n)),r(n,"weaponInfos",k,i(n)),r(n,"upgradeLvInfo",I,i(n)),r(n,"turretUnlockIds",z,i(n)),r(n,"trapUnlockIds",_,i(n)),r(n,"barricadeHp",M,i(n)),n.getMoney=0,n.getGem=0,r(n,"roomUnlockPut",W,i(n)),r(n,"unlockAreaIds",D,i(n)),r(n,"_money",L,i(n)),r(n,"_gem",U,i(n)),n}t(n,e);var a=n.prototype;return a.upgrade=function(e){var n=this.upgradeLvInfo[e];if(n>=c.upgrade.get(e).value.length)return l.show("已经满级"),!1;var t=c.upgrade.get(e).cost[n-1];return this.money<t?(l.show("金币不足"),!1):(this.money-=t,this.upgradeLvInfo[e]++,!0)},a.getWeapon=function(e){var n=this.weaponInfos.find((function(n){return n.id==e}));if(n)return n;var t={id:e,unlock:!1,level:0};return 0==c.weapon.get(e).unlock_diamonds&&(t.unlock=!0),this.weaponInfos.push(t),t},a.upgradeWeapon=function(e){var n=this.getWeapon(e);n.unlock?n.level++:(n.unlock=!0,f.Inst.event(u.EventType.WeaponUnlock,e))},o(n,[{key:"money",get:function(){return this._money},set:function(e){this._money=e,f.Inst.event(u.EventType.MoneyChange)}},{key:"gem",get:function(){return this._gem},set:function(e){this._gem=e,f.Inst.event(u.EventType.MoneyChange)}}]),n}(p)).prototype,"level",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),y=n(b.prototype,"unlockDrone",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d=n(b.prototype,"currentWave",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),m=n(b.prototype,"currentWeapon",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),v=n(b.prototype,"guideID",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),h=n(b.prototype,"currentSkin",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),w=n(b.prototype,"skinIds",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[1]}}),k=n(b.prototype,"weaponInfos",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),I=n(b.prototype,"upgradeLvInfo",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{1:1,2:1,3:1,4:1}}}),z=n(b.prototype,"turretUnlockIds",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),_=n(b.prototype,"trapUnlockIds",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),M=n(b.prototype,"barricadeHp",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),W=n(b.prototype,"roomUnlockPut",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),D=n(b.prototype,"unlockAreaIds",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),L=n(b.prototype,"_money",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),U=n(b.prototype,"_gem",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),b));a._RF.pop()}}}));

System.register("chunks:///_virtual/GameWin.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameConst.ts","./BasePanel.ts","./EventManager.ts","./WindowManager.ts","./Model.ts","./Config.ts","./Global.ts","./MsgHints.ts","./GuideManager.ts","./SkinWin.ts"],(function(e){var t,n,a,r,i,o,s,l,c,d,u,_,p,v,h,g,f,E,A,m;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,a=e._decorator,r=e.v3,i=e.tween,o=e.Label,s=e.Sprite,l=e.color,c=e.Tween},function(e){d=e.default,u=e.UpgradeType},function(e){_=e.default},function(e){p=e.EventManager},function(e){v=e.default},function(e){h=e.default},function(e){g=e.default},function(e){f=e.Global},function(e){E=e.default},function(e){A=e.default},function(e){m=e.SkinWin}],execute:function(){var b;n._RF.push({},"e9fe7A8YoZGho1oZPUq0CTp","GameWin",void 0);var T=a.ccclass;a.property,e("GameWin",T("GameWin")(b=function(e){function n(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this).node_dots=void 0,t.txt_level=void 0,t.txt_map=void 0,t.normal=void 0,t.fighting=void 0,t.txt_now=void 0,t.txt_next=void 0,t.sp_bar=void 0,t.btn_player_hp=null,t.btn_player_speed=null,t.lbl_unlock_turret=null,t.lbl_unlock_trap=null,t.currTurretArea=null,t.currTrapArea=null,t.node_turret=null,t.node_trap=null,t.btn_barricade=null,t.btn_trap=null,t.node_upgrade=null,t.node_upgrade2=null,t.btn_setting=null,t.node_top=null,t.node_left_menu=null,t.btn_task=null,t.btn_skin=null,t.btn_start=null,t.btn_player2=null,t.txt_repair_cost=null,t.lbl_level=null,t.lbl_coin=null,t.lbl_gem=null,t}t(n,e);var a=n.prototype;return a.onShow=function(){this.btn_start.node.active=4!=A.Instance().currentGuideId,this.btn_player2.node.active=!1,this.btn_task.node.active=!0,this.node_upgrade.active=!1,this.node_upgrade2.active=!1,this.node_turret.active=!1,this.normal.active=!0,this.fighting.active=!1,this.node_trap.active=!1,this.updateLevelInfo()},a.start=function(){this.updateLevelInfo(),this.onMoneyChange(),this.checkStartBtn(),this.updateRepair()},a.onEnable=function(){var e=this;this.AddEvent(d.EventType.MoneyChange,this.onMoneyChange),this.AddEvent(d.EventType.GuideChange,this.checkStartBtn),this.AddEvent(d.EventType.ENTER_SKIN_CAMERA,(function(){e.node_top.active=!1,e.node_left_menu.active=!1,e.btn_start.node.active=!1,e.btn_setting.node.active=!0})),this.AddEvent(d.EventType.EXIT_SKIN_CAMERA,(function(){e.node_top.active=!0,e.node_left_menu.active=!0,e.btn_start.node.active=!f.game.running,e.btn_setting.node.active=!1})),this.AddEvent(d.EventType.ENTER_BARRICADE_TRAP_UPGRADE,(function(){e.node_upgrade2.active=!0,e.refreshUpgradeInfo(e.btn_barricade.node,u.BARRICADE),e.refreshUpgradeInfo(e.btn_trap.node,u.TRAP)})),this.AddEvent(d.EventType.EXIT_BARRICADE_TRAP_UPGRADE,(function(){e.node_upgrade2.active=!1})),this.AddEvent(d.EventType.ENTER_PLAYER_UPGRADE,(function(){e.node_upgrade.active=!0,e.refreshUpgradeInfo(e.btn_player_hp.node,u.PLAYER_HP),e.refreshUpgradeInfo(e.btn_player_speed.node,u.PLAYER_SPEED)})),this.AddEvent(d.EventType.EXIT_PLAYER_UPGRADE,(function(){e.node_upgrade.active=!1})),this.AddEvent(d.EventType.ENTER_TURRET_UNLOCK_AREA,(function(t){e.node_turret.active=!0,e.node_turret.scale=r(0,0,0),i(e.node_turret).to(.1,{scale:r(1.1,1.1,1.1)}).to(.1,{scale:r(1,1,1)}).start(),e.currTurretArea=t,e.lbl_unlock_turret.string=t.unlockCoin+""})),this.AddEvent(d.EventType.EXIT_TURRET_UNLOCK_AREA,(function(t){i(e.node_turret).to(.1,{scale:r(0,0,0)}).call((function(){e.node_turret.active=!1})).start(),e.currTurretArea=null})),this.AddEvent(d.EventType.ENTER_TRAP_UNLOCK_AREA,(function(t){e.node_trap.active=!0,e.node_trap.scale=r(0,0,0),i(e.node_trap).to(.1,{scale:r(1.1,1.1,1.1)}).to(.1,{scale:r(1,1,1)}).start(),e.currTrapArea=t,e.lbl_unlock_trap.string=t.unlockCoin+""})),this.AddEvent(d.EventType.EXIT_TRAP_UNLOCK_AREA,(function(t){i(e.node_trap).to(.1,{scale:r(0,0,0)}).call((function(){e.node_trap.active=!1})).start(),e.currTrapArea=null})),this.AddEvent(d.EventType.UpdateFightingProgress,(function(t){var n=1-t,a=Math.max(0,Math.min(1,n));e.sp_bar.fillRange=a,e.txt_next.string=f.game.totalEnemyCount-f.game.enemyCount+"/"+f.game.totalEnemyCount})),this.AddEvent(d.EventType.onPass,(function(){e.updateLevelInfo(),e.reset()})),this.AddEvent(d.EventType.onLose,(function(){e.reset()})),this.AddEvent(d.EventType.onRepair,(function(){e.updateRepair()})),this.AddEvent(d.EventType.GameStart,(function(){e.node_trap.active=!1,e.node_upgrade2.active=!1,e.node_turret.active=!1,e.node_upgrade.active=!1}))},a.onBtnClicked=function(e,t){if("btn_start"==t)this.btn_start.node.active=!1,this.btn_player2.node.active=!1,this.btn_task.node.active=!1,p.Inst.event(d.EventType.GameStart),this.normal.active=!1,this.fighting.active=!0,this.txt_repair_cost.node.parent.active=!1;else if("btn_weapon"==t)v.Instance().open(d.winPath.WeaponWin);else if("btn_setting"==t)v.Instance().open(d.winPath.SettingWin);else if("btn_skin"==t)v.Instance().open(d.winPath.SkinWin);else if("btn_task"==t)v.Instance().open(d.winPath.TaskWin);else if("btn_player2"==t);else if("btn_player_hp"==t)h.game.upgrade(u.PLAYER_HP)&&(this.refreshUpgradeInfo(this.btn_player_hp.node,u.PLAYER_HP),h.save());else if("btn_player_speed"==t)h.game.upgrade(u.PLAYER_SPEED)&&(this.refreshUpgradeInfo(this.btn_player_speed.node,u.PLAYER_SPEED),h.save());else if("btn_barricade"==t)h.game.upgrade(u.BARRICADE)&&(this.refreshUpgradeInfo(this.btn_barricade.node,u.BARRICADE),h.save());else if("btn_trap"==t)h.game.upgrade(u.TRAP)&&(this.refreshUpgradeInfo(this.btn_trap.node,u.TRAP),h.save());else if("btn_unlock_turret"==t){if(this.currTurretArea){if(h.game.money<this.currTurretArea.unlockCoin)return void E.show("金币不足");h.game.money-=this.currTurretArea.unlockCoin,h.game.turretUnlockIds.push(this.currTurretArea.areaid),this.currTurretArea.refreshArea(),this.node_turret.active=!1,h.save()}}else if("btn_unlock_trap"==t){if(this.currTrapArea){if(h.game.money<this.currTrapArea.unlockCoin)return void E.show("金币不足");h.game.money-=this.currTrapArea.unlockCoin,h.game.trapUnlockIds.push(this.currTrapArea.areaid),this.currTrapArea.refreshArea(),this.node_trap.active=!1,h.save()}}else if("btn_repair"==t){var n=f.map.getNeedRepairCount();if(n>0){var a=n*g.mission.getWaveData(h.game.level,h.game.currentWave).costMoney;h.game.money>=a?(h.game.money-=a,h.save(),f.map.repair(),this.txt_repair_cost.node.parent.active=!1):E.show("金币不足!")}}},a.update=function(){this.btn_task.node.children[0]&&(this.btn_task.node.children[0].active=h.task.hongdian()),this.btn_skin.node.children[0]&&(this.btn_skin.node.children[0].active=m.hongdian())},a.refreshUpgradeInfo=function(e,t){void 0===e&&(e=null);var n=h.game.upgradeLvInfo[t],a=g.upgrade.get(t).value.length,r=this.GetGameObject("lbl_up_name",e,!0).getComponent(o),i=this.GetGameObject("lbl_up_cost",e,!0).getComponent(o),s=this.GetGameObject("node_up_cost",e,!0);n>=a?(i.string="已满级",s.children[0].active=!1):(i.string=g.upgrade.getPlayerHpCostByLv(n)+"",s.children[0].active=!0);var l="";t==u.PLAYER_HP?l="生命":t==u.PLAYER_SPEED?l="速度":t==u.BARRICADE?l="路障":t==u.TRAP&&(l="陷阱"),r.string=l+"Lv."+n},a.reset=function(){this.normal.active=!0,this.fighting.active=!1,this.btn_task.node.active=!0,this.checkStartBtn(),this.updateRepair()},a.updateRepair=function(){var e=f.map.getNeedRepairCount();if(e>0){this.txt_repair_cost.node.parent.active=!0;var t=g.mission.getWaveData(h.game.level,h.game.currentWave);this.txt_repair_cost.string=Math.floor(t.costMoney*e)+""}else this.txt_repair_cost.node.parent.active=!1},a.updateLevelInfo=function(){var e=g.mission.getTotalWaveByLevel(h.game.level);this.txt_level.string="关卡 "+h.game.currentWave+"/"+e,this.txt_map.string="场景"+h.game.level;for(var t=this.node_dots.children.length,n=1;n<=t;n++){var a=this.node_dots.children[n-1];if(n<=e){var r=a.getComponent(s);a.active=!0,n<h.game.currentWave?r.color=l(19,141,58):n==h.game.currentWave?r.color=l(0,204,255):r.color=l(255,255,255)}else a.active=!1}this.txt_now.string="第"+h.game.currentWave+"关"},a.updateFightingInfo=function(){},a.onMoneyChange=function(){this.lbl_coin.string=h.game.money+"",this.lbl_gem.string=h.game.gem+""},a.checkStartBtn=function(){this.btn_start.node.active=-1==[1,4,5,6,7].indexOf(h.game.guideID)&&this.normal.active,c.stopAllByTarget(this.btn_start.node.getChildByName("Icon-start")),this.btn_start.node.active&&i(this.btn_start.node.getChildByName("Icon-start")).to(.5,{scale:r(.6,.6,1)}).to(.5,{scale:r(.5,.5,1)}).union().repeatForever().start()},n}(_))||b);n._RF.pop()}}}));

System.register("chunks:///_virtual/Global.ts",["cc"],(function(o){var e;return{setters:[function(o){e=o.cclegacy}],execute:function(){e._RF.push({},"727dbKuWldIf6eXSMp3A4Iq","Global",void 0);var i=o("Global",(function(){}));i.player=void 0,i.drone=void 0,i.camera=void 0,i.game=void 0,i.map=void 0,i.followFiled=void 0,e._RF.pop()}}}));

System.register("chunks:///_virtual/GridManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./FollowField.ts","./TestEnemy.ts"],(function(e){var t,o,r,i,n,l,a,d,s,c,h,u,g,w,p,F,m,y,f,v;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inheritsLoose,r=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){n=e.cclegacy,l=e._decorator,a=e.Graphics,d=e.Node,s=e.v2,c=e.instantiate,h=e.UITransform,u=e.v3,g=e.Color,w=e.Label,p=e.misc,F=e.Sprite,m=e.color,y=e.Component},function(e){f=e.FollowField},function(e){v=e.TestEnemy}],execute:function(){var N,C,b,T,M,B,L,S,x;n._RF.push({},"b85ceE5mWxLr630tQiP+8LR","GridManager",void 0);var z=l.ccclass,E=l.property;e("GridManager",(N=z("GridManager"),C=E(a),b=E(d),T=E(d),N((L=t((B=function(e){function t(){for(var t,o=arguments.length,n=new Array(o),l=0;l<o;l++)n[l]=arguments[l];return(t=e.call.apply(e,[this].concat(n))||this).curFollowField=void 0,r(t,"drawNode",L,i(t)),r(t,"cellNode",S,i(t)),r(t,"enemyNode",x,i(t)),t.target=void 0,t}o(t,e);var n=t.prototype;return n.start=function(){var e=this;this.curFollowField=new f,this.curFollowField.createGrid(30,s(20,10)),this.node.on(d.EventType.TOUCH_START,this.onTouchStart,this),this.schedule((function(){e.spawnEnemys()}),.1),this.draw()},n.spawnEnemys=function(){if(null!=this.target){var e=c(this.enemyNode);e.parent=this.drawNode.node;var t=e.addComponent(v);e.setPosition(500*Math.random()+100,200*Math.random()+800,0),t.followField=this.curFollowField}},n.onTouchStart=function(e){var t=e.getUILocation(),o=this.drawNode.node.getComponent(h).convertToNodeSpaceAR(u(t.x,t.y,0)),r=Math.ceil(o.y/60),i=Math.ceil(o.x/60);console.log(r,i),this.curFollowField.resetBestCost();var n=this.curFollowField.grid[r][i];this.curFollowField.createIntegrationField(n),this.target=n,this.curFollowField.createFollowField(),this.draw()},n.draw=function(){this.drawNode.node.removeAllChildren(),this.drawNode.strokeColor=g.BLACK,this.drawNode.lineWidth=3;for(var e=2*this.curFollowField.cellRadius,t=this.curFollowField.gridSize,o=0;o<t.x;o++)for(var r=0;r<t.y;r++){var i=c(this.cellNode);i.parent=this.drawNode.node,i.setPosition(u(r*e,o*e));i.getComponentInChildren(w);var n=this.curFollowField.grid[o][r].bestDir,l=Math.atan2(n.x,n.y),a=p.radiansToDegrees(l);i.getChildByName("arrow").angle=a,this.target&&this.target.row==o&&this.target.col==r?i.getChildByName("bg").getComponent(F).color=m(160,160,0):i.getChildByName("bg").getComponent(F).color=m(160,160,160),this.curFollowField.grid[o][r].cost>=255?(i.getChildByName("bg").getComponent(F).color=m(160,0,0),i.getChildByName("arrow").active=!1):i.getChildByName("arrow").active=!0}},n.update=function(e){},t}(y)).prototype,"drawNode",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=t(B.prototype,"cellNode",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=t(B.prototype,"enemyNode",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=B))||M));n._RF.pop()}}}));

System.register("chunks:///_virtual/GuideArrow.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Component.ts"],(function(t){var o,e,r,n,i,u,s;return{setters:[function(t){o=t.inheritsLoose},function(t){e=t.cclegacy,r=t._decorator,n=t.log,i=t.tween,u=t.v3},function(t){s=t.default}],execute:function(){var c;e._RF.push({},"8693epy0oZIYpGHDxOU+c3P","GuideArrow",void 0);var a=r.ccclass;r.property,t("GuideArrow",a("GuideArrow")(c=function(t){function e(){return t.apply(this,arguments)||this}o(e,t);var r=e.prototype;return r.start=function(){var t=this.node.getChildByName("arrow");n("箭头动画",t),i(t).to(.5,{position:u(0,70)}).to(.5,{position:u(0,40)}).union().repeatForever().start()},r.setRed=function(){},e}(s))||c);e._RF.pop()}}}));

System.register("chunks:///_virtual/GuideArrow3D.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Component.ts"],(function(t){var r,e,o,n,i,u;return{setters:[function(t){r=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator,n=t.tween,i=t.v3},function(t){u=t.default}],execute:function(){var c;e._RF.push({},"3996dOMqdFOhbkYGIyhT4dO","GuideArrow3D",void 0);var s=o.ccclass;o.property,t("GuideArrow3D",s("GuideArrow3D")(c=function(t){function e(){return t.apply(this,arguments)||this}r(e,t);var o=e.prototype;return o.start=function(){n(this.GetGameObject("arrow")).to(.5,{position:i(0,1,0)}).to(.5,{position:i(0,0,0)}).union().repeatForever().start()},o.update=function(t){},e}(u))||c);e._RF.pop()}}}));

System.register("chunks:///_virtual/GuideManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameConst.ts","./Global.ts","./AssetPool.ts","./Model.ts","./EventManager.ts","./Singleton.ts","./WindowManager.ts","./GuideArrow3D.ts"],(function(e){var t,r,n,i,s,o,u,a,c,d,f,g,l,p;return{setters:[function(e){t=e.inheritsLoose,r=e.createClass,n=e.asyncToGenerator,i=e.regeneratorRuntime},function(e){s=e.cclegacy,o=e.v3},function(e){u=e.default},function(e){a=e.Global},function(e){c=e.default},function(e){d=e.default},function(e){f=e.EventManager},function(e){g=e.default},function(e){l=e.default},function(e){p=e.GuideArrow3D}],execute:function(){s._RF.push({},"4853dDw3VhF0LQffSGc4xlA","GuideManager",void 0);e("default",function(e){function s(){var t;(t=e.call(this)||this).guideSteps=[],t._currentGuideId=1,t.currentStep=void 0,t.arrow=void 0;var r=[{id:1,message:"拖曳移动",type:1,triggerNext:"onMove",arrowOffset:o(0,2,0),rollback:-1,focus:!1},{id:2,message:"点击开始战斗",type:2,win:"GameWin",target:"btn_start",arrowOffset:o(0,0,0),rollback:-1,focus:!1},{id:3,message:"",type:0,triggerNext:"onNewLevel2",rollback:-1,focus:!1},{id:4,message:"建造另外一个房间",type:3,triggerNext:"unlockArea2",target:"node_area2",arrowOffset:o(0,1,0),rollback:-1,focus:!0},{id:5,message:"升级武器",type:3,triggerNext:"onOpenWeaponWin",target:"node_lvUp",arrowOffset:o(0,1,0),rollback:-1,focus:!0},{id:6,message:"点击升级",type:2,win:"WeaponWin",target:"btn_upgrade",arrowOffset:o(0,1,0),rollback:5,focus:!1},{id:7,message:"",type:2,win:"WeaponWin",target:"btn_close",arrowOffset:o(0,1,0),rollback:8,focus:!1},{id:8,message:"点击继续战斗!",type:2,win:"GameWin",target:"btn_start",arrowOffset:o(0,2,0),rollback:-1,focus:!1},{id:9,message:"",type:999,triggerNext:"todo",target:"",arrowOffset:o(0,1,0),rollback:-1,focus:!0}];return t.guideSteps=r,t.currentGuideId=d.game.guideID,t.currentStep=t.guideSteps.find((function(e){return e.id==t.currentGuideId})),t.currentStep&&t.currentStep.rollback>0&&(t.currentGuideId=t.currentStep.rollback),t}t(s,e);var g=s.prototype;return g.startGuide=function(){var e=n(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.createArrow();case 2:this.showNextStep();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),g.createArrow=function(){var e=n(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.Instance().createObjAsync("prefabs/guide/GuideArrow3D","GuideArrow3D");case 2:(t=e.sent).parent=a.game.node_container,t.active=!1,this.arrow=t.getComponent(p);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),g.showNextStep=function(){var e=this;this.hideGuide(),this.currentStep=this.guideSteps.find((function(t){return t.id==e.currentGuideId})),this.currentStep&&this.showGuide(this.currentStep)},g.onEventTrigger=function(e,t){void 0===t&&(t=!1),(this.currentStep&&this.currentStep.triggerNext==e||t)&&(this.currentGuideId++,this.saveGuideProgress(),this.showNextStep())},g.showGuide=function(e){l.Instance().open(u.winPath.GuideWin,e)},g.hideGuide=function(){this.arrow.node.active=!1,l.Instance().removeWindow(u.winPath.GuideWin,!0),a.player.setAimPos(null)},g.saveGuideProgress=function(){d.game.guideID=this.currentGuideId,d.save()},r(s,[{key:"currentGuideId",get:function(){return this._currentGuideId},set:function(e){this._currentGuideId=e,d.game.guideID=e,console.log("当前引导ID",this.currentGuideId),f.Inst.event(u.EventType.GuideChange)}}]),s}(g));s._RF.pop()}}}));

System.register("chunks:///_virtual/GuideMove.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var i,e,o,r,n,a,u,s,p,c;return{setters:[function(t){i=t.applyDecoratedDescriptor,e=t.inheritsLoose,o=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){n=t.cclegacy,a=t._decorator,u=t.CCInteger,s=t.Vec3,p=t.tween,c=t.Component}],execute:function(){var d,l,h,f,y,w,v,b,g;n._RF.push({},"7327c1BVrpBXonLEGK1t2Qu","GuideMove",void 0);var m=a.ccclass,z=a.property;t("GuideMove",(d=m("GuideMove"),l=z({type:u}),h=z({type:u}),f=z({type:u}),d((v=i((w=function(t){function i(){for(var i,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return i=t.call.apply(t,[this].concat(n))||this,o(i,"radiusX",v,r(i)),o(i,"radiusY",b,r(i)),o(i,"duration",g,r(i)),i}return e(i,t),i.prototype.start=function(){var t=-this.radiusX,i=this.radiusX,e=this.radiusY,o=-this.radiusY,r=[new s(i,e),new s(i,0),new s(i,o),new s(0,0)],n=[new s(t,e),new s(t,0),new s(t,o),new s(0,0)],a=this.node;p(a).to(this.duration/2,{position:r[0]}).to(this.duration/2,{position:r[1]}).to(this.duration/2,{position:r[2]}).to(this.duration/2,{position:r[3]}).to(this.duration/2,{position:n[0]}).to(this.duration/2,{position:n[1]}).to(this.duration/2,{position:n[2]}).to(this.duration/2,{position:n[3]}).union().repeatForever().start()},i}(c)).prototype,"radiusX",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),b=i(w.prototype,"radiusY",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),g=i(w.prototype,"duration",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),y=w))||y));n._RF.pop()}}}));

System.register("chunks:///_virtual/GuideNode.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n,i,o,r,a,c,s,u;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,a=e._decorator,c=e.Node,s=e.Button,u=e.Component}],execute:function(){var l,d,p;r._RF.push({},"b734dKzUOFGP7y/WNjcy2eX","GuideNode",void 0);var f=a.ccclass,v=a.property;e("GuideNode",f("GuideNode")((p=t((d=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,i(t,"gName",p,o(t)),t}return n(t,e),t.prototype.start=function(){var e=this;this.node.on("guideNodeClick",(function(t){var n=e.gName.split("_")[0];if("node"==n)e.node.emit(c.EventType.TOUCH_START);else if("btn"==n){var i={};i.target=e.node;var o=e.node.getComponent(s),r=o.clickEvents[0].customEventData;o.clickEvents[0].emit([i,r])}t&&t()}),this)},t}(u)).prototype,"gName",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),l=d))||l);r._RF.pop()}}}));

System.register("chunks:///_virtual/GuideWin.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Global.ts","./BasePanel.ts","./WindowManager.ts","./GuideManager.ts","./GuideNode.ts"],(function(e){var t,o,n,r,i,a,s,d,u,c,l,h,f,g,v;return{setters:[function(e){t=e.inheritsLoose,o=e.createForOfIteratorHelperLoose,n=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){i=e.cclegacy,a=e._decorator,s=e.v3,d=e.Vec3,u=e.Tween,c=e.tween},function(e){l=e.Global},function(e){h=e.default},function(e){f=e.default},function(e){g=e.default},function(e){v=e.GuideNode}],execute:function(){var w;i._RF.push({},"d0a3bTu44BKZotoeIEg8k8X","GuideWin",void 0);var p=a.ccclass;a.property,e("GuideWin",p("GuideWin")(w=function(e){function i(){for(var t,o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))||this).node_move=void 0,t.node_arrow=void 0,t.target=void 0,t.node_talk=void 0,t.txt_talk=void 0,t}t(i,e);var a=i.prototype;return a.start=function(){},a.onBtnClicked=function(e,t){},a.onShow=function(){var e=n(r().mark((function e(t){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.data=t,1==t.type?this.showMove():2==t.type?this.showGuideArrow():3==t.type&&this.showGuideArrow3d();case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),a.showMove=function(){this.node_move.active=!0},a.showGuideArrow=function(){var e=this,t=this.data;""!=t.target&&(this.block.active=!0,this.schedule((function(){var o=e.getGuideNode(t);console.log("查找",t.target),o&&(e.unscheduleAllCallbacks(),e.node_arrow.position=o.node.position.clone().add(t.arrowOffset),e.node_arrow.active=!0,e.target=o)}))),t.message&&""!=t.message&&this.showTalk()},a.showGuideArrow3d=function(){var e=this.data;if(""!=e.target){var t=this.getGuideNode3d(e);if(t){g.Instance().arrow.node.worldPosition=t.node.worldPosition.clone().add(e.arrowOffset),g.Instance().arrow.node.active=!0,this.target=t;var o=s();d.add(o,t.node.worldPosition,s(0,3,0)),l.player.setAimPos(o)}}e.message&&""!=e.message&&this.showTalk()},a.showTalk=function(){this.node_talk.active=!0,this.txt_talk.string=this.data.message,u.stopAllByTarget(this.node_talk),c(this.node_talk).to(.5,{scale:s(1.1,1.1,1.1)}).to(.5,{scale:s(.9,.9,.9)}).union().repeatForever().start()},a.getGuideNode=function(e){var t=f.Instance().getWin(e.win);if(t)for(var n,r=t.node.getComponentsInChildren(v),i=o(r);!(n=i()).done;){var a=n.value;if(a.gName==e.target)return a}return null},a.getGuideNode3d=function(e){for(var t,n=l.map.node.getComponentsInChildren(v),r=o(n);!(t=r()).done;){var i=t.value;if(i.gName==e.target)return i}return null},a.clickGuideNode=function(){this.target&&(this.target.node.emit("guideNodeClick"),this.target=null,g.Instance().onEventTrigger("xx",!0))},i}(h))||w);i._RF.pop()}}}));

System.register("chunks:///_virtual/Handler.ts",["cc"],(function(t){var i;return{setters:[function(t){i=t.cclegacy}],execute:function(){i._RF.push({},"1d991j6f2RHBab8uD7yd6Ks","Handler",void 0);var s=t("Handler",function(){function t(t,i,s,e){void 0===t&&(t=null),void 0===i&&(i=null),void 0===s&&(s=null),void 0===e&&(e=!1),this.caller=void 0,this.method=void 0,this.args=void 0,this.once=!1,this._id=0,this.setTo(t,i,s,e)}var i=t.prototype;return i.setTo=function(i,s,e,h){return void 0===h&&(h=!1),this._id=t._gid++,this.caller=i,this.method=s,this.args=e,this.once=h,this},i.run=function(){if(null==this.method)return null;var t=this._id,i=this.method.apply(this.caller,this.args);return this._id===t&&this.once&&this.recover(),i},i.runWith=function(t){if(null==this.method)return null;var i=this._id;if(null==t)var s=this.method.apply(this.caller,this.args);else s=this.args||t.unshift?this.args?this.method.apply(this.caller,this.args.concat(t)):this.method.apply(this.caller,t):this.method.call(this.caller,t);return this._id===i&&this.once&&this.recover(),s},i.clear=function(){return this.caller=null,this.method=null,this.args=null,this},i.recover=function(){this._id>0&&(this._id=0,t._pool.push(this.clear()))},t.create=function(i,s,e,h){return void 0===e&&(e=null),void 0===h&&(h=!0),t._pool.length?t._pool.pop().setTo(i,s,e,h):new t(i,s,e,h)},t}());s._pool=[],s._gid=1,i._RF.pop()}}}));

System.register("chunks:///_virtual/HeadTip.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameConst.ts","./Global.ts","./FSM.ts","./MeshText.ts","./Component.ts"],(function(t){var n,e,o,i,a,s,d,c,h,r,u,f,p,l;return{setters:[function(t){n=t.inheritsLoose,e=t.createClass},function(t){o=t.cclegacy,i=t._decorator,a=t.v3,s=t.MeshRenderer,d=t.v4},function(t){c=t.ItemType,h=t.default},function(t){r=t.Global},function(t){u=t.default,f=t.FSMAction},function(t){p=t.default},function(t){l=t.default}],execute:function(){var _;o._RF.push({},"db54dsPJNFCXJKUq2agcWpF","HeadTip",void 0);var v=i.ccclass,g=(i.property,a(),t("HEAD_TIP_STATE",function(t){return t[t.IDLE=0]="IDLE",t[t.FOOD=1]="FOOD",t[t.NO_SEAT=2]="NO_SEAT",t[t.HAPPY=3]="HAPPY",t[t.ANGRY=4]="ANGRY",t}({})));t("HeadTip",v("HeadTip")(_=function(t){function o(){for(var n,e=arguments.length,o=new Array(e),i=0;i<e;i++)o[i]=arguments[i];return(n=t.call.apply(t,[this].concat(o))||this)._target=void 0,n.node_count=void 0,n.node_food=void 0,n.node_bg=void 0,n.node_happy=void 0,n.node_angry=void 0,n.node_no=void 0,n.node_package=void 0,n.fsm=void 0,n}n(o,t);var i=o.prototype;return i.onLoad=function(){this.node.setRotation(r.camera._camera_init_rot.clone()),this.initFsm()},i.initFsm=function(){this.fsm=this.node.addComponent(u),this.fsm.init(this),this.fsm.addState(new f(this,g.IDLE,this.onIdleEnter)),this.fsm.addState(new f(this,g.FOOD,this.onFoodEnter)),this.fsm.addState(new f(this,g.NO_SEAT,this.onNoFoodEnter)),this.fsm.addState(new f(this,g.HAPPY,this.onHappyEnter)),this.fsm.addState(new f(this,g.ANGRY,this.onAngryEnter))},i.onEnable=function(){},i.onDisable=function(){},i.onRemove=function(){},i.start=function(){this.node_count.getComponent(s).material.setProperty("mainColor",d(0,0,0,1))},i.update=function(t){this.target&&this.node.setPosition(this.target.node.getWorldPosition().clone().add(a(0,2)))},i.onUpdateHeadTip=function(t){this.node_count.getComponent(p).text=t.count+"",t.type==c.Burger?this.node_food.active=!0:t.type==c.Package&&(this.node_package.active=!0)},i.hideAll=function(){this.node_count.getComponent(p).text="",this.node_food.active=!1,this.node_bg.active=!1,this.node_happy.active=!1,this.node_angry.active=!1,this.node_no.active=!1,this.node_package.active=!1},i.onIdleEnter=function(){this.hideAll()},i.onFoodEnter=function(){this.hideAll(),this.node_count.active=!0,this.node_bg.active=!0},i.onNoFoodEnter=function(){this.hideAll(),this.node_bg.active=!0,this.node_no.active=!0},i.onHappyEnter=function(){var t=this;this.hideAll(),this.node_happy.active=!0,this.scheduleOnce((function(){t.fsm.changeState(g.IDLE)}),1.6)},i.onAngryEnter=function(){var t=this;this.hideAll(),this.node_angry.active=!0,this.scheduleOnce((function(){t.fsm.changeState(g.IDLE)}),1.6)},i.changeState=function(t){this.fsm.changeState(t,!0)},e(o,[{key:"target",get:function(){return this._target},set:function(t){this._target=t,this._target.node.on(h.EventType.UpdateHeadTip,this.onUpdateHeadTip,this)}}]),o}(l))||_);o._RF.pop()}}}));

System.register("chunks:///_virtual/HpBar.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Component.ts","./Global.ts"],(function(r){var t,o,e,n,s,a,c;return{setters:[function(r){t=r.inheritsLoose},function(r){o=r.cclegacy,e=r._decorator,n=r.v3,s=r.MeshRenderer},function(r){a=r.default},function(r){c=r.Global}],execute:function(){var i;o._RF.push({},"804584VyYVGU4R+hDxwGz1C","HpBar",void 0);var l=e.ccclass;e.property,r("HpBar",l("HpBar")(i=function(r){function o(){for(var t,o=arguments.length,e=new Array(o),n=0;n<o;n++)e[n]=arguments[n];return(t=r.call.apply(r,[this].concat(e))||this).progress=null,t.r=null,t}t(o,r);var e=o.prototype;return e.setProgress=function(r){this.progress&&this.progress.setScale(n(.117,1,r))},e.update=function(r){var t=c.camera.camera;this.node.lookAt(t.worldPosition)},e.setColor=function(r){this.r.getComponent(s).material.setProperty("mainColor",r)},o}(a))||i);o._RF.pop()}}}));

System.register("chunks:///_virtual/IndicatorWin.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameConst.ts","./Global.ts","./AssetPool.ts","./BasePanel.ts","./BarricadeIndicator.ts","./EnemyIndicator.ts"],(function(e){var n,t,r,a,c,i,o,s,d,u,f,p,l;return{setters:[function(e){n=e.inheritsLoose,t=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){a=e.cclegacy,c=e._decorator,i=e.v3,o=e.Camera},function(e){s=e.default},function(e){d=e.Global},function(e){u=e.default},function(e){f=e.default},function(e){p=e.BarricadeIndicator},function(e){l=e.EnemyIndicator}],execute:function(){var h;a._RF.push({},"a4fefKGjOFI2rw6JASVqd6g","IndicatorWin",void 0);var m=c.ccclass,I=(c.property,i());e("IndicatorWin",m("IndicatorWin")(h=function(e){function a(){for(var n,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(n=e.call.apply(e,[this].concat(r))||this).enemy=void 0,n.barricade=void 0,n}n(a,e);var c=a.prototype;return c.onBtnClicked=function(e,n){},c.start=function(){var e=this;this.AddEvent(s.EventType.GameStart,(function(){e.createIndicators()}))},c.createIndicators=function(){var e=t(r().mark((function e(){var n,t,a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=this.enemy.children.length-1;n>=0;n--)u.Instance().put(this.enemy.children[n]);for(t=this.barricade.children.length-1;t>=0;t--)u.Instance().put(this.barricade.children[t]);a=0;case 3:if(!(a<d.map.barricades.length)){e.next=13;break}return console.log("坐标转换"),d.camera.camera.getComponent(o).convertToUINode(d.map.barricades[a].node.worldPosition,this.node,I),e.next=8,this.createIndicator(I,d.map.barricades[a].id);case 8:return e.next=10,this.createBarricadeIndicator(d.map.barricades[a].id);case 10:a++,e.next=3;break;case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),c.createIndicator=function(e,n){var a=this;return new Promise(t(r().mark((function e(t,c){var i;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.Instance().createObjAsync("prefabs/entity/EnemyIndicator","EnemyIndicator");case 2:(i=e.sent).parent=a.enemy,i.getComponent(l).setBarricadeId(n),i.setPosition(I),t(i);case 7:case"end":return e.stop()}}),e)}))))},c.createBarricadeIndicator=function(e){var n=this;return new Promise(t(r().mark((function t(a,c){var i;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.Instance().createObjAsync("prefabs/entity/BarricadeIndicator","BarricadeIndicator");case 2:(i=t.sent).parent=n.barricade,i.getComponent(p).setBarricadeId(e),a(i);case 6:case"end":return t.stop()}}),t)}))))},c.update=function(e){},a}(f))||h);a._RF.pop()}}}));

System.register("chunks:///_virtual/ItemTest.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ListItemBase.ts"],(function(t){var e,n,r,s;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,r=t._decorator},function(t){s=t.ListItemBase}],execute:function(){var o;n._RF.push({},"e59a7rprJBOjYFNIPWndWl3","ItemTest",void 0);var c=r.ccclass;r.property,t("ItemTest",c("ItemTest")(o=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var r=n.prototype;return r.start=function(){},r.update=function(t){},n}(s))||o);n._RF.pop()}}}));

System.register("chunks:///_virtual/Joystick.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./GameConst.ts"],(function(t){var e,i,o,n,s,a,r,y,p,h,c,u,l,v,d,g,T,f,k,E;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,o=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){s=t.cclegacy,a=t._decorator,r=t.EventTarget,y=t.Node,p=t.Enum,h=t.v3,c=t.v2,u=t.UITransform,l=t.UIOpacity,v=t.input,d=t.Input,g=t.Vec2,T=t.Vec3,f=t.Component},function(t){k=t.EventManager},function(t){E=t.default}],execute:function(){var _,m,D,L,P,M,O,b,C,S,A,I,K,x,w,F;s._RF.push({},"0b4db4tMIVLbaS/WP1vCk6K","Joystick",void 0);var U=a.ccclass,R=a.property,W=t("instance",new r),N=t("DirectionType",function(t){return t[t.FOUR=0]="FOUR",t[t.EIGHT=1]="EIGHT",t[t.ALL=2]="ALL",t}({})),j=t("SpeedType",function(t){return t[t.STOP=0]="STOP",t[t.NORMAL=1]="NORMAL",t[t.FAST=2]="FAST",t}({})),z=t("JoystickType",function(t){return t[t.FIXED=0]="FIXED",t[t.FOLLOW=1]="FOLLOW",t}({})),J="KeyA",H="KeyD",Y="KeyW",X="KeyS",V="ArrowLeft",G="ArrowRight",B="ArrowUp",Z="ArrowDown";t("default",(_=R({type:y,displayName:"Dot",tooltip:"摇杆操纵点"}),m=R({type:y,displayName:"Ring",tooltip:"摇杆背景节点"}),D=R({type:p(z),displayName:"Touch Type",tooltip:"触摸类型"}),L=R({type:p(N),displayName:"Direction Type",tooltip:"方向类型"}),P=R({type:y,tooltip:"摇杆所在位置"}),M=R({type:y,tooltip:"触摸位置"}),O=R({tooltip:"半径"}),U((S=e((C=function(t){function e(){for(var e,i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return e=t.call.apply(t,[this].concat(s))||this,o(e,"dot",S,n(e)),o(e,"ring",A,n(e)),o(e,"joystickType",I,n(e)),o(e,"directionType",K,n(e)),o(e,"_stickPos",x,n(e)),o(e,"_touchLocation",w,n(e)),o(e,"_radius",F,n(e)),e.defaultpos=h(),e.keysMap=new Map,e.moved=!1,e.info=void 0,e.moveDelta=c(),e}i(e,t);var s=e.prototype;return s.onLoad=function(){this._radius=this.ring.getComponent(u).width/2,this._initTouchEvent(),this.joystickType,z.FOLLOW,this.defaultpos=this.ring.getPosition().clone()},s.onEnable=function(){W.on("set_joystick_type",this._onSetJoystickType,this),this.node.getComponent(l).opacity=0,this.registKey()},s.registKey=function(){v.on(d.EventType.KEY_DOWN,this.onWxKeyDown.bind(this)),v.on(d.EventType.KEY_UP,this.onWxKeyUp.bind(this))},s.unRegistKey=function(){v.off(d.EventType.KEY_DOWN,this.onWxKeyDown.bind(this)),v.off(d.EventType.KEY_UP,this.onWxKeyUp.bind(this))},s.onWxKeyDown=function(t){this.keysMap.set(t.code||t.keyCode+"",!0)},s.onWxKeyUp=function(t){this.keysMap.set(t.code||t.keyCode+"",!1),32==t.keyCode?k.Inst.event(E.EventType.KEYCODE_SPACE):70==t.keyCode&&k.Inst.event(E.EventType.KEYCODE_F)},s.update=function(t){this.moveDelta.set(g.ZERO),(this.keysMap.get(J)||this.keysMap.get(V)||this.keysMap.get("65")||this.keysMap.get("37"))&&(this.moveDelta.x-=1500*t),(this.keysMap.get(H)||this.keysMap.get(G)||this.keysMap.get("68")||this.keysMap.get("39"))&&(this.moveDelta.x+=1500*t),(this.keysMap.get(Y)||this.keysMap.get(B)||this.keysMap.get("87")||this.keysMap.get("38"))&&(this.moveDelta.y+=1500*t),(this.keysMap.get(X)||this.keysMap.get(Z)||this.keysMap.get("83")||this.keysMap.get("40"))&&(this.moveDelta.y-=1500*t),0!=this.moveDelta.x||0!=this.moveDelta.y?(this.moved=!0,this.moveDelta=this.moveDelta.normalize(),k.Inst.event(E.EventType.JoystickMove,{SpeedType:j.NORMAL,moveDistance:this.moveDelta}),this.moveDelta.multiplyScalar(125),this.dot.setPosition(this.ring.getPosition().x+this.moveDelta.x,this.ring.getPosition().y+this.moveDelta.y)):this.moved&&(this.moved=!1,k.Inst.event(E.EventType.JoystickStop),this.dot.setPosition(this.ring.getPosition()))},s.onDisable=function(){W.off("set_joystick_type",this._onSetJoystickType,this),this.unRegistKey()},s._onSetJoystickType=function(t){this.joystickType=t,this.node.getComponent(l).opacity=t===z.FIXED?255:0},s._initTouchEvent=function(){this.node.on(y.EventType.TOUCH_START,this._touchStartEvent,this),this.node.on(y.EventType.TOUCH_MOVE,this._touchMoveEvent,this),this.node.on(y.EventType.TOUCH_END,this._touchEndEvent,this),this.node.on(y.EventType.TOUCH_CANCEL,this._touchEndEvent,this)},s._touchStartEvent=function(t){this.node.getComponent(l).opacity=255,W.emit(y.EventType.TOUCH_START,t);var e=t.getUILocation(),i=this.node.getComponent(u).convertToNodeSpaceAR(h(e.x,e.y));if(this.joystickType===z.FIXED){this._stickPos=this.ring.getPosition();var o=T.distance(i,this.ring.getPosition());this._radius>o&&this.dot.setPosition(i)}else this.joystickType===z.FOLLOW&&(this._stickPos=i,this._touchLocation=t.getUILocation(),this.ring.setPosition(i),this.dot.setPosition(i));k.Inst.event(E.EventType.JoystickStart)},s._touchMoveEvent=function(t){if(this.joystickType===z.FOLLOW&&this._touchLocation===t.getLocation())return!1;var e,i=t.getUILocation(),o=this.ring.getComponent(u).convertToNodeSpaceAR(h(i.x,i.y)),n=o.length(),s=this._stickPos.x+o.x,a=this._stickPos.y+o.y,r=this.moveDelta;if(r.x=s-this.ring.getPosition().x,r.y=a-this.ring.getPosition().y,r=r.normalize(),this._radius>n)this.dot.setPosition(h(s,a)),e=j.NORMAL;else{var y=this._stickPos.x+r.x*this._radius,p=this._stickPos.y+r.y*this._radius;this.dot.setPosition(h(y,p)),e=j.FAST}k.Inst.event(E.EventType.JoystickMove,{speedType:e,moveDistance:r})},s._touchEndEvent=function(t){this.dot.setPosition(this.ring.getPosition()),this.joystickType===z.FOLLOW&&(this.node.getComponent(l).opacity=0,this._stickPos=this.defaultpos,this.ring.setPosition(this.defaultpos),this.dot.setPosition(this.defaultpos)),k.Inst.event(E.EventType.JoystickStop)},e}(f)).prototype,"dot",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=e(C.prototype,"ring",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(C.prototype,"joystickType",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return z.FIXED}}),K=e(C.prototype,"directionType",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return N.ALL}}),x=e(C.prototype,"_stickPos",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=e(C.prototype,"_touchLocation",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=e(C.prototype,"_radius",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),b=C))||b));s._RF.pop()}}}));

System.register("chunks:///_virtual/LinkPrefab.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n,r,i,o,a,s,f,p,b,c,d;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,i=e.assertThisInitialized,o=e.createClass},function(e){a=e.cclegacy,s=e._decorator,f=e.Prefab,p=e.instantiate,b=e.UITransform,c=e.Vec3,d=e.Component}],execute:function(){var l,u,h,_,g;a._RF.push({},"f748abMXOJNj6BHw+8La4Q4","LinkPrefab",void 0);var y=s.ccclass,N=s.executeInEditMode,P=s.property,v=s.menu;e("default",(l=v("公共组件/LinkPrefab"),u=P({type:f,visible:!0,displayName:"预制体"}),y(h=N(h=l((g=t((_=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(t=e.call.apply(e,[this].concat(o))||this)._prefabNode=null,r(t,"_prefab",g,i(t)),t}n(t,e);var a=t.prototype;return a._onPrefabChanged=function(e,t){if(this._prefabNode&&(this._prefabNode.destroy(),this._prefabNode=null),this._prefab=t,t){var n=p(t);if(n){this._prefabNode=n,n._objFlags|=Object.Flags.DontSave|Object.Flags.LockedInEditor|Object.Flags.HideInHierarchy;var r=n.getComponent(b);n.setPosition(c.ZERO),r.setContentSize(r.contentSize),this.node.addChild(n),n.setSiblingIndex(0),n.name="prefabNode"}}},a.getPefabNode=function(){return this._initPrefab(),this._prefabNode},a.getPrefabComponect=function(e){var t=this._prefabNode;return t?t.getComponent(e):null},a.onLoad=function(){this._initPrefab()},a._initPrefab=function(){if(this._prefab&&!this._prefabNode){var e=this.node.getChildByName("prefabNode");if(e)this._prefabNode=e;else{var t=p(this._prefab);if(t){this._prefabNode=t,this.node.addChild(t),t.setSiblingIndex(0),t.name="prefabNode";var n=t.getComponent(b);t.setPosition(c.ZERO),n.setContentSize(n.contentSize)}}}},o(t,[{key:"prefab",get:function(){return this._prefab},set:function(e){this._onPrefabChanged(this._prefab,e)}}]),t}(d)).prototype,"_prefab",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),t(_.prototype,"prefab",[u],Object.getOwnPropertyDescriptor(_.prototype,"prefab"),_.prototype),h=_))||h)||h)||h));a._RF.pop()}}}));

System.register("chunks:///_virtual/List.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ListItemBase.ts"],(function(t){var i,e,n,s,o,h,a,r,l,c,p,m,u,g,d,f;return{setters:[function(t){i=t.applyDecoratedDescriptor,e=t.inheritsLoose,n=t.initializerDefineProperty,s=t.assertThisInitialized},function(t){o=t.cclegacy,h=t._decorator,a=t.Prefab,r=t.Enum,l=t.UITransform,c=t.ScrollView,p=t.Layout,m=t.instantiate,u=t.Vec2,g=t.isValid,d=t.Component},function(t){f=t.ListItemBase}],execute:function(){var w,C,L,y,V,x,v,P,b,D,I,H,z,F,R,U,S,X,Y,A,G,W,T,M,_;o._RF.push({},"d80838dtmdO0qspd5XchbPL","List",void 0);var B=h.ccclass,O=h.property,k=t("ListType",function(t){return t[t.Horizontal=1]="Horizontal",t[t.Vertical=2]="Vertical",t[t.Grid=3]="Grid",t}({})),j=t("StartAxisType",function(t){return t[t.Horizontal=1]="Horizontal",t[t.Vertical=2]="Vertical",t}({}));t("List",(w=B("List"),C=O({type:a,tooltip:"列表项"}),L=O({tooltip:"播放动画",visible:!0}),y=O({tooltip:"分帧创建",visible:!0}),V=O({type:r(k),tooltip:"排列方式"}),x=O({type:r(j),tooltip:"网格布局中的方向",visible:function(){return this.type==k.Grid}}),v=O({tooltip:"列表项X间隔",visible:function(){return this.type==k.Horizontal||this.type==k.Grid}}),P=O({tooltip:"列表项Y间隔",visible:function(){return this.type==k.Vertical||this.type==k.Grid}}),b=O({tooltip:"上间距",visible:function(){return this.type==k.Vertical||this.type==k.Grid}}),D=O({tooltip:"下间距",visible:function(){return this.type==k.Vertical||this.type==k.Grid}}),I=O({tooltip:"左间距",visible:function(){return this.type==k.Horizontal||this.type==k.Grid}}),H=O({tooltip:"右间距",visible:function(){return this.type==k.Horizontal||this.type==k.Grid}}),w((R=i((F=function(t){function i(){for(var i,e=arguments.length,o=new Array(e),h=0;h<e;h++)o[h]=arguments[h];return i=t.call.apply(t,[this].concat(o))||this,n(i,"itemRender",R,s(i)),n(i,"aim",U,s(i)),n(i,"frameCreate",S,s(i)),n(i,"type",X,s(i)),n(i,"startAxis",Y,s(i)),n(i,"spaceX",A,s(i)),n(i,"spaceY",G,s(i)),n(i,"top",W,s(i)),n(i,"bottom",T,s(i)),n(i,"left",M,s(i)),n(i,"right",_,s(i)),i.scrollView=null,i.content=null,i.itemDataList=[],i.spawnCount=0,i.itemList=[],i.itemHeight=0,i.itemWidth=0,i.itemPool=[],i.halfScrollView=0,i.lastContentPosX=0,i.lastContentPosY=0,i.gridRow=0,i.gridCol=0,i.updateTimer=0,i.updateInterval=.1,i.bScrolling=!1,i.updateFun=function(){},i.itemUpdateFunc=null,i.contentTransform=void 0,i}e(i,t);var o=i.prototype;return o.onLoad=function(){this.itemHeight=this.itemRender.data.getComponent(l).height,this.itemWidth=this.itemRender.data.getComponent(l).width,this.scrollView=this.node.getComponent(c),this.content=this.scrollView.content,this.contentTransform=this.content.getComponent(l),this.contentTransform.anchorX=0,this.contentTransform.anchorY=1,this.content.removeAllChildren(),this.scrollView.node.on("scrolling",this.onScrolling,this);var t=this.content.getComponent(p);t&&this.content.removeComponent(t)},o.updateItemSize=function(t){this.itemHeight=t.getComponent(l).height,this.itemWidth=t.getComponent(l).width},o.setData=function(t,i,e){void 0===i&&(i=null),void 0===e&&(e=!0),e&&this.clean(),this.itemDataList=t.slice(),this.itemUpdateFunc=i,this.updateContent()},o.countListParam=function(){var t=this.itemDataList.length;this.type==k.Vertical?(this.scrollView.horizontal=!1,this.scrollView.vertical=!0,this.content.getComponent(l).width=this.content.parent.getComponent(l).width,this.content.getComponent(l).height=t*this.itemHeight+(t-1)*this.spaceY+this.top+this.bottom,this.spawnCount=Math.ceil(this.scrollView.node.getComponent(l).height/(this.itemHeight+this.spaceY))+1,this.halfScrollView=this.scrollView.node.getComponent(l).height/2+this.itemHeight/2+this.spaceY,this.updateFun=this.updateV):this.type==k.Horizontal?(this.scrollView.horizontal=!0,this.scrollView.vertical=!1,this.content.getComponent(l).width=t*this.itemWidth+(t-1)*this.spaceX+this.left+this.right,this.content.getComponent(l).height=this.content.parent.getComponent(l).height,this.spawnCount=Math.round(this.scrollView.node.getComponent(l).width/(this.itemWidth+this.spaceX))+2,this.halfScrollView=this.scrollView.node.getComponent(l).width/2+this.itemWidth/2+this.spaceX,this.updateFun=this.udpateH):this.type==k.Grid&&(this.startAxis==j.Vertical?(this.scrollView.horizontal=!1,this.scrollView.vertical=!0,this.content.getComponent(l).width=this.content.parent.getComponent(l).width,this.left+this.right+this.itemWidth+this.spaceX>this.content.getComponent(l).width&&(this.left=0,this.right=0,console.error("left或right过大")),this.gridCol=Math.floor((this.content.getComponent(l).width-this.left-this.right)/(this.itemWidth+this.spaceX)),this.gridRow=Math.ceil(t/this.gridCol),this.content.getComponent(l).height=this.gridRow*this.itemHeight+(this.gridRow-1)*this.spaceY+this.top+this.bottom,this.spawnCount=Math.ceil(this.scrollView.node.getComponent(l).height/(this.itemHeight+this.spaceY))*this.gridCol+this.gridCol,this.halfScrollView=this.scrollView.node.getComponent(l).height/2+this.itemHeight/2+this.spaceY,this.updateFun=this.updateGrid_V):this.startAxis==j.Horizontal&&(this.scrollView.horizontal=!0,this.scrollView.vertical=!1,this.content.getComponent(l).height=this.content.parent.getComponent(l).height,this.top+this.bottom+this.itemHeight+this.spaceY>this.content.getComponent(l).height&&(this.top=0,this.bottom=0,console.error("top或bottom过大")),this.gridRow=Math.floor((this.content.getComponent(l).height-this.top-this.bottom)/(this.itemHeight+this.spaceY)),this.gridCol=Math.ceil(t/this.gridRow),this.content.getComponent(l).width=this.gridCol*this.itemWidth+(this.gridCol-1)*this.spaceX+this.left+this.right,this.spawnCount=Math.round(this.scrollView.node.getComponent(l).width/(this.itemWidth+this.spaceX))*this.gridRow+2*this.gridRow,this.halfScrollView=this.scrollView.node.getComponent(l).width/2+this.itemWidth/2+this.spaceX,this.updateFun=this.updateGrid_H))},o.createList=function(t,i){var e=this;this.itemDataList.length>this.spawnCount&&t+this.spawnCount-1>=this.itemDataList.length?(t=this.itemDataList.length-this.spawnCount,i=this.scrollView.getMaxScrollOffset()):this.itemDataList.length<=this.spawnCount&&(t=0);var n=0,s=function i(){if(n>=e.spawnCount)e.scrollView.unschedule(i);else{var s,o=!1;if(n+t<e.itemDataList.length){if(null==e.itemList[n]){var h=e.getItem();s=h.item,o=h.new,e.itemList.push(s),s.parent=e.content}else s=e.itemList[n];var a=s.getComponent(f);if(a.itemIndex=n+t,!e.itemUpdateFunc&&a.updateView(e.itemDataList[n+t]),e.itemUpdateFunc&&e.itemUpdateFunc(s,e.itemDataList[n+t],n+t),e.type==k.Vertical)s.setPosition(e.content.getComponent(l).width/2,-s.getComponent(l).height*(.5+n+t)-e.spaceY*(n+t)-e.top);else if(e.type==k.Horizontal)s.setPosition(s.getComponent(l).width*(.5+n+t)+e.spaceX*(n+t)+e.left,-e.content.getComponent(l).height/2);else if(e.type==k.Grid)if(e.startAxis==j.Vertical){var r=Math.floor((n+t)/e.gridCol),c=(n+t)%e.gridCol;s.setPosition(s.getComponent(l).width*(.5+c)+e.spaceX*c+e.left,-s.getComponent(l).height*(.5+r)-e.spaceY*r-e.top),s.active=!0}else if(e.startAxis==j.Horizontal){r=(n+t)%e.gridRow,c=Math.floor((n+t)/e.gridRow);s.setPosition(s.getComponent(l).width*(.5+c)+e.spaceX*c+e.left,-s.getComponent(l).height*(.5+r)-e.spaceY*r-e.top),s.active=!1}e.aim&&o&&e.playItemInAnima(s,.1*n),n++}else e.itemList.length>e.itemDataList.length-t&&((s=e.itemList.pop()).removeFromParent(),e.itemPool.push(s))}};if(this.frameCreate)this.scrollView.schedule(s);else for(var o=0;o<this.spawnCount;o++)s();this.scrollView.scrollToOffset(i)},o.getItem=function(){return 0==this.itemPool.length?{item:m(this.itemRender),new:!0}:{item:this.itemPool.pop(),new:!1}},o.update=function(t){0!=this.bScrolling&&(this.updateTimer=0,this.bScrolling=!1,this.updateFun())},o.onScrolling=function(){this.bScrolling=!0},o.updateV=function(){for(var t,i=this.itemList,e=this.halfScrollView,n=this.scrollView.content.getPosition().y>this.lastContentPosY,s=(this.itemHeight+this.spaceY)*i.length,o=0;o<i.length;o++){t=i[o];var h=this.getPositionInView(t);if(n){if(h.y>e&&t.getPosition().y-s-this.bottom>-this.content.getComponent(l).height){var a=t.getComponent(f),r=a.itemIndex+i.length;a.itemIndex=r,a.updateView(this.itemDataList[r]),this.itemUpdateFunc&&this.itemUpdateFunc(t,this.itemDataList[r],r),t.setPosition(t.getPosition().x,t.getPosition().y-s)}}else if(h.y<-e&&t.getPosition().y+s+this.top<0){var c=t.getComponent(f),p=c.itemIndex-i.length;c.itemIndex=p,c.updateView(this.itemDataList[p]),this.itemUpdateFunc&&this.itemUpdateFunc(t,this.itemDataList[p],p),t.setPosition(t.getPosition().x,t.getPosition().y+s)}}this.lastContentPosY=this.scrollView.content.getPosition().y},o.udpateH=function(){for(var t,i=this.itemList,e=this.halfScrollView,n=this.scrollView.content.getPosition().x>this.lastContentPosX,s=(this.itemWidth+this.spaceX)*i.length,o=0;o<i.length;o++){t=i[o];var h=this.getPositionInView(t);if(n){if(h.x>e&&t.x-s-this.left>0){var a=t.getComponent(f),r=a.itemIndex-i.length;a.itemIndex=r,a.updateView(this.itemDataList[r]),this.itemUpdateFunc&&this.itemUpdateFunc(t,this.itemDataList[r],r),t.x=t.x-s}}else if(h.x<-e&&t.x+s+this.right<this.content.getComponent(l).width){var c=t.getComponent(f),p=c.itemIndex+i.length;c.itemIndex=p,c.updateView(this.itemDataList[p]),this.itemUpdateFunc&&this.itemUpdateFunc(t,this.itemDataList[p],p),t.x=t.x+s}}this.lastContentPosX=this.scrollView.content.getPosition().x},o.updateGrid_V=function(){for(var t,i=this.itemList,e=this.halfScrollView,n=this.scrollView.content.getPosition().y>this.lastContentPosY,s=(this.itemHeight+this.spaceY)*(this.spawnCount/this.gridCol),o=0;o<i.length;o++){t=i[o];var h=this.getPositionInView(t);if(n){if(h.y>e&&t.getPosition().y-s-this.bottom>-this.content.getComponent(l).height){var a=t.getComponent(f),r=a.itemIndex+this.spawnCount/this.gridCol*this.gridCol;null!=this.itemDataList[r]?(t.setPosition(t.getPosition().x,t.getPosition().y-s),a.itemIndex=r,!this.itemUpdateFunc&&a.updateView(this.itemDataList[r]),this.itemUpdateFunc&&this.itemUpdateFunc(t,this.itemDataList[r],r),t.active=!0):(t.setPosition(t.getPosition().x,t.getPosition().y-s),a.itemIndex=r,t.active=!1)}}else if(h.y<-e&&t.getPosition().y+s+this.top<0){var c=t.getComponent(f),p=c.itemIndex-this.spawnCount/this.gridCol*this.gridCol;null!=this.itemDataList[p]?(t.setPosition(t.getPosition().x,t.getPosition().y+s),c.itemIndex=p,!this.itemUpdateFunc&&c.updateView(this.itemDataList[p]),this.itemUpdateFunc&&this.itemUpdateFunc(t,this.itemDataList[p],p),t.active=!0):(t.setPosition(t.getPosition().x,t.getPosition().y+s),c.itemIndex=p,t.active=!1)}}this.lastContentPosY=this.scrollView.content.getPosition().y},o.updateGrid_H=function(){for(var t,i=this.itemList,e=this.halfScrollView,n=this.scrollView.content.getPosition().x>this.lastContentPosX,s=(this.itemWidth+this.spaceX)*(this.spawnCount/this.gridRow),o=0;o<i.length;o++){t=i[o];var h=this.getPositionInView(t);if(n){if(h.x>e&&t.x-s-this.left>0){var a=t.getComponent(f),r=a.itemIndex-this.spawnCount/this.gridRow*this.gridRow;null!=this.itemDataList[r]?(t.x=t.x-s,a.itemIndex=r,!this.itemUpdateFunc&&a.updateView(this.itemDataList[r]),this.itemUpdateFunc&&this.itemUpdateFunc(t,this.itemDataList[r],r),t.active=!0):(t.x=t.x-s,a.itemIndex=r,t.active=!1)}}else if(h.x<-e&&t.x+s+this.right<this.content.getComponent(l).width){var c=t.getComponent(f),p=c.itemIndex+this.spawnCount/this.gridRow*this.gridRow;null!=this.itemDataList[p]?(t.x=t.x+s,c.itemIndex=p,!this.itemUpdateFunc&&c.updateView(this.itemDataList[p]),this.itemUpdateFunc&&this.itemUpdateFunc(t,this.itemDataList[p],p),t.active=!0):(t.x=t.x+s,c.itemIndex=p,t.active=!1)}}this.lastContentPosX=this.scrollView.content.getPosition().x},o.getPositionInView=function(t){var i=t.parent.getComponent(l).convertToWorldSpaceAR(t.position);return this.scrollView.node.getComponent(l).convertToNodeSpaceAR(i)},o.getListData=function(){return this.itemDataList},o.addItem=function(t){this.itemDataList.push(t),this.updateContent()},o.addItemAt=function(t,i){null==this.itemDataList[t]&&this.itemDataList.length!=t||(this.itemDataList.splice(t,1,i),this.updateContent())},o.deleteItem=function(t){null!=this.itemDataList[t]&&(this.itemDataList.splice(t,1),this.updateContent())},o.changeItem=function(t,i){null!=this.itemDataList[t]&&(this.itemDataList[t]=i,this.updateContent())},o.updateContent=function(){if(0==this.itemList.length)this.countListParam(),this.createList(0,new u(0,0));else{this.type==k.Vertical?this.itemList.sort((function(t,i){return i.y-t.y})):this.type==k.Horizontal?this.itemList.sort((function(t,i){return t.x-i.x})):this.type==k.Grid&&(this.startAxis==j.Vertical?(this.itemList.sort((function(t,i){return t.x-i.x})),this.itemList.sort((function(t,i){return i.y-t.y}))):this.startAxis==j.Horizontal&&(this.itemList.sort((function(t,i){return i.y-t.y})),this.itemList.sort((function(t,i){return t.x-i.x})))),this.countListParam();var t=this.itemList[0].getComponent(f).itemIndex;this.type==k.Grid&&this.startAxis==j.Vertical?t+=(t+this.spawnCount)%this.gridCol:this.type==k.Grid&&this.startAxis==j.Horizontal&&(t+=(t+this.spawnCount)%this.gridRow);var i=this.scrollView.getScrollOffset();i.x=-i.x,this.createList(t,i)}},o.playItemInAnima=function(t,i){switch(this.type){case k.Vertical:case k.Horizontal:case k.Grid:}},o.onDestroy=function(){this.clean()},o.clean=function(){this.scrollView.stopAutoScroll(),this.scrollView.unscheduleAllCallbacks();for(var t=this.itemList.length,i=0;i<t;i++)g(this.itemList[i],!0)&&this.itemList[i].destroy();this.itemList.length=0,t=this.itemPool.length;for(var e=0;e<t;e++)g(this.itemPool[e],!0)&&this.itemPool[e].destroy();this.itemPool.length=0,this.itemDataList.length=0},o.getData=function(){return this.itemDataList},o.getItemList=function(){return this.itemList},o.getPosByRow=function(t){return-(t*this.itemHeight+this.spaceY*(t-1)+this.top)},i}(d)).prototype,"itemRender",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=i(F.prototype,"aim",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),S=i(F.prototype,"frameCreate",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),X=i(F.prototype,"type",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return k.Vertical}}),Y=i(F.prototype,"startAxis",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return j.Horizontal}}),A=i(F.prototype,"spaceX",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),G=i(F.prototype,"spaceY",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),W=i(F.prototype,"top",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),T=i(F.prototype,"bottom",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),M=i(F.prototype,"left",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),_=i(F.prototype,"right",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),z=F))||z));o._RF.pop()}}}));

System.register("chunks:///_virtual/ListItemBase.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,r,o;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,r=t._decorator,o=t.Component}],execute:function(){var i;n._RF.push({},"c4f2fB2PfhHeIH4TV1NiUAp","ListItemBase",void 0);var c=r.ccclass;r.property,t("ListItemBase",c("ListItemBase")(i=function(t){function n(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))||this).itemIndex=void 0,e}e(n,t);var r=n.prototype;return r.updateView=function(t){},r.start=function(){},r.update=function(t){},n}(o))||i);n._RF.pop()}}}));

System.register("chunks:///_virtual/LoadingWin.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AssetPool.ts","./BasePanel.ts","./Config.ts","./Model.ts","./ResHelper.ts"],(function(e){var t,n,r,a,o,s,i,c,u,l,d,f,p;return{setters:[function(e){t=e.inheritsLoose,n=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){a=e.cclegacy,o=e._decorator,s=e.Prefab,i=e.tween,c=e.UITransform},function(e){u=e.default},function(e){l=e.default},function(e){d=e.default},function(e){f=e.default},function(e){p=e.default}],execute:function(){var h;a._RF.push({},"d9f65xhEwpKCLihUoQhhNYD","LoadingWin",void 0);var g=o.ccclass;o.property,e("LoadingWin",g("LoadingWin")(h=function(e){function a(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).node_bar=void 0,t}t(a,e);var o=a.prototype;return o.onBtnClicked=function(e,t){},o.start=function(){var e=n(r().mark((function e(){var t,n,a=this;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=d.mission.getWaveData(f.game.level,f.game.currentWave)){e.next=4;break}return console.error("关卡数据出错",f.game.level,f.game.currentWave),e.abrupt("return");case 4:return n="Level"+t.mapID,this.node_bar.getComponent(c).width=0,e.next=8,this.preLoadRes("level/"+n,n);case 8:return i(this.node_bar.getComponent(c)).to(.5,{width:206}).start(),e.next=11,this.preLoadRes("prefabs/entity/Player","Player");case 11:return i(this.node_bar.getComponent(c)).to(.5,{width:288.4}).start(),e.next=14,p.loadResSync("prefabs/game/GameWin","game",s);case 14:return e.next=16,this.preLoadRes("prefabs/entity/CoinUI","CoinUI");case 16:return e.next=18,this.preLoadRes("prefabs/entity/GemUI","GemUI");case 18:i(this.node_bar.getComponent(c)).to(.5,{width:412}).call((function(){a.close(),a.data.callback&&a.data.callback()})).start();case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.preLoadRes=function(e,t){return new Promise(n(r().mark((function n(a,o){var i;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,p.loadResSync(e,"game",s);case 2:i=n.sent,u.Instance().addPrefab(i,t),a(null);case 5:case"end":return n.stop()}}),n)}))))},a}(l))||h);a._RF.pop()}}}));

System.register("chunks:///_virtual/LocalTemplete.ts",["cc"],(function(e){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"ad269ZqSYJEXKPQItPGbru0","LocalTemplete",void 0);e("LocalVersion","2.0.1"),e("NetControlUrl","https://xxx/cct/game_7.json?a="+Math.random()),e("NetControlUrlTT","https://xxx/cct/game_8.json?a="+Math.random()),e("DefaultTemplete",{appid:"",id:7,key:"cct/game_7.json",name:"GAME3",share_content:["好玩有解压的游戏，快来玩吧！"],share_title:[],share_urls:[],version:"2.0.1"});t._RF.pop()}}}));

System.register("chunks:///_virtual/LoseWin.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameConst.ts","./BasePanel.ts","./Model.ts","./EventManager.ts","./AdManager.ts","./WindowManager.ts","./Utils.ts"],(function(t){var n,e,i,o,a,s,c,u,l,r,m,f,g;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,i=t._decorator,o=t.Vec3,a=t.tween,s=t.v3},function(t){c=t.default},function(t){u=t.default},function(t){l=t.default},function(t){r=t.EventManager},function(t){m=t.default},function(t){f=t.default},function(t){g=t.default}],execute:function(){var d;e._RF.push({},"ac698FAKTpHUZMdWmUzSnUx","LoseWin",void 0);var h=i.ccclass;i.property,t("LoseWin",h("LoseWin")(d=function(t){function e(){for(var n,e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return(n=t.call.apply(t,[this].concat(i))||this).txt_coin=void 0,n.txt_diamond=void 0,n.aimCount=0,n}n(e,t);var i=e.prototype;return i.onBtnClicked=function(t,n){var e=this;if(!(this.aimCount>0)){var i=!1;"btn_double"==n?m.showVideo((function(t){0==t&&(i=!0,e.playAni(i))})):"btn_close"==n&&(i=!1,this.playAni(i))}},i.playAni=function(t){var n=this,e=f.Instance().getWin("GameWin");this.aimCount=0,l.game.getMoney>0&&(this.aimCount++,g.flyAnim("CoinUI",this.txt_coin.node,e.GetGameObject("lbl_coin"),10,30,(function(){l.game.money+=l.game.getMoney*(t?2:1),n.checkFlyAniComplete()}))),l.game.getGem>0&&(this.aimCount++,g.flyAnim("GemUI",this.txt_coin.node,e.GetGameObject("lbl_gem"),10,30,(function(){l.game.gem+=l.game.getGem*(t?2:1),n.checkFlyAniComplete()})))},i.checkFlyAniComplete=function(){this.aimCount--,0==this.aimCount&&(r.Inst.event(c.EventType.onLose),l.save(),this.close())},i.start=function(){this.txt_coin.string=l.game.getMoney+"",this.txt_diamond.string=l.game.getGem+"",this.node_top.scale=o.ZERO,a(this.node_top).to(.5,{scale:s(1,1,1)},{easing:"backOut"}).start(),m.showMoreGame()},i.update=function(t){},e}(u))||d);e._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./debug-view-runtime-control.ts","./RegionalHelper.ts","./ItemTest.ts","./Cell.ts","./FollowField.ts","./GridManager.ts","./TestEnemy.ts","./BusyLoading.ts","./CCEx.ts","./GameConst.ts","./Global.ts","./AssetPool.ts","./BasePanel.ts","./Component.ts","./FitUI.ts","./LinkPrefab.ts","./List.ts","./ListItemBase.ts","./MsgHints.ts","./AreaConfig.ts","./BaseCfg.ts","./Config.ts","./ConfigAuto.ts","./EnemyConfig.ts","./MissionConfig.ts","./ObstacleConfig.ts","./SkinConfig.ts","./TaskConfig.ts","./UpgradeConfig.ts","./WeaponConfig.ts","./GameModel.ts","./Model.ts","./ModelBase.ts","./TaskModel.ts","./EventDispatcher.ts","./EventManager.ts","./Handler.ts","./AdManager.ts","./BusyLoadingManager.ts","./Singleton.ts","./WindowManager.ts","./Barricade.ts","./BarricadeIndicator.ts","./BrokenAni.ts","./Bullet.ts","./Coin.ts","./CoinUI.ts","./Drone.ts","./Enemy.ts","./EnemyIndicator.ts","./FollowCamera.ts","./GameManager.ts","./IndicatorWin.ts","./MoveBase.ts","./Player.ts","./Role.ts","./TipNode.ts","./Trap.ts","./Turret.ts","./Water.ts","./mapDebug.ts","./DroneWin.ts","./GameWin.ts","./HeadTip.ts","./Joystick.ts","./SettingWin.ts","./SkinWin.ts","./SleepEffect.ts","./TaskWin.ts","./UnlockWeaponWin.ts","./WeaponWin.ts","./BulletShell.ts","./MapBarricadeArea.ts","./MapItemBase.ts","./MapPlayerUpgradeArea.ts","./MapSkinArea.ts","./MapWeaponArea.ts","./Room.ts","./SectionUnlocker.ts","./TrapArea.ts","./TurretArea.ts","./UnlockHide.ts","./WeaponHolder.ts","./AreaUnlockUI.ts","./HpBar.ts","./DirArrow.ts","./GuideArrow.ts","./GuideArrow3D.ts","./GuideManager.ts","./GuideMove.ts","./GuideNode.ts","./GuideWin.ts","./LoadingWin.ts","./MapManager.ts","./RegionalEditor.ts","./LoseWin.ts","./PassWin.ts","./ReliveWin.ts","./CountDownUI.ts","./LocalTemplete.ts","./NetControl.ts","./NetTool.ts","./AudioMgr.ts","./FSM.ts","./MeshText.ts","./ResHelper.ts","./Utils.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/MapBarricadeArea.ts",["./rollupPluginModLoBabelHelpers.js","cc","./MapItemBase.ts","./GameConst.ts","./Player.ts","./WindowManager.ts","./Global.ts","./EventManager.ts"],(function(e){var n,t,r,a,i,o,c,s,l,u,p,d,g;return{setters:[function(e){n=e.inheritsLoose},function(e){t=e.cclegacy,r=e._decorator,a=e.SkeletalAnimation,i=e.MeshRenderer,o=e.v4},function(e){c=e.default},function(e){s=e.FacilityAreaType,l=e.default},function(e){u=e.Player},function(e){p=e.default},function(e){d=e.Global},function(e){g=e.EventManager}],execute:function(){var f;t._RF.push({},"e4d49mclz1LPpWW7TIctu+3","MapBarricadeArea",void 0);var h=r.ccclass;r.property,e("MapBarricadeArea",h("MapBarricadeArea")(f=function(e){function t(){for(var n,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(n=e.call.apply(e,[this].concat(r))||this).barricade_upgrade_area=null,n._trigger=!1,n}n(t,e);var r=t.prototype;return r.initArea=function(){this.triggerAreaList.push({type:s.BARRICADE_UPGRADE,pos:this.barricade_upgrade_area.worldPosition,dis:1,checkType:0})},r.onEnable=function(){var e=this;this.AddEvent(l.EventType.GameStart,(function(){e.node.getComponentInChildren(a).play("Merchant_Hide")})),this.AddEvent(l.EventType.onLose,(function(){e.node.getComponentInChildren(a).play("Merchant")})),this.AddEvent(l.EventType.onPass,(function(){e.node.getComponentInChildren(a).play("Merchant")}))},r.update=function(e){this.barricade_upgrade_area.active=!d.game.running},r.onTriggerEnter=function(e,n){if(e instanceof u&&!d.game.running&&!this._trigger){this._trigger=!0;var t,r=this.GetGameObject("frame",this.node);if(r)null==(t=r.getComponent(i))||t.material.setProperty("mainColor",o(0,1,0,1));g.Inst.event(l.EventType.ENTER_BARRICADE_TRAP_UPGRADE)}},r.onTriggerExit=function(e,n){if(e instanceof u&&(this._trigger=!1,!d.game.running)){p.Instance().closeAll();var t,r=this.GetGameObject("frame",this.node);if(r)null==(t=r.getComponent(i))||t.material.setProperty("mainColor",o(1,1,1,1));g.Inst.event(l.EventType.EXIT_BARRICADE_TRAP_UPGRADE)}},t}(c))||f);t._RF.pop()}}}));

System.register("chunks:///_virtual/mapDebug.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Global.ts","./ResHelper.ts","./Component.ts"],(function(e){var t,r,n,o,l,a,s,i,c,u,g,h,p,f;return{setters:[function(e){t=e.inheritsLoose,r=e.asyncToGenerator,n=e.regeneratorRuntime},function(e){o=e.cclegacy,l=e._decorator,a=e.MeshRenderer,s=e.v4,i=e.misc,c=e.v3,u=e.instantiate,g=e.Prefab},function(e){h=e.Global},function(e){p=e.default},function(e){f=e.default}],execute:function(){var m;o._RF.push({},"a3156+rTgFIMYSbDQMKQ2lD","mapDebug",void 0);var d=l.ccclass;l.property,e("mapDebug",d("mapDebug")(m=function(e){function o(){for(var t,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(t=e.call.apply(e,[this].concat(n))||this).cells=void 0,t}t(o,e);var l=o.prototype;return l.createGrid=function(){var e=r(n().mark((function e(t,r){var o,l,a,s,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.loadResSync("prefabs/game/DebugCell","game",g);case 2:for(o=e.sent,this.cells=[],l=0;l<t.length;l++)for(this.cells[l]=[],a=0;a<t[l].length;a++)s=c(a+.5,0,l+.5),(i=u(o)).setPosition(s),i.parent=h.map.GetGameObject("grid"),this.cells[l][a]=i,t[l][a].isBlock&&this.setBlock(l,a);case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),l.setBlock=function(e,t){this.cells&&this.cells[e][t].getChildByName("bg").getComponent(a).material.setProperty("albedo",s(1,0,0,1))},l.removeBlock=function(e,t){this.cells&&this.cells[e][t].getChildByName("bg").getComponent(a).material.setProperty("albedo",s(1,1,1,1))},l.createFollowField=function(e){for(var t=0;t<e.length;t++)for(var r=0;r<e[t].length;r++){var n=e[t][r],o=this.cells[t][r];if(n&&o){var l=n.bestDir,a=Math.atan2(l.y,l.x),s=i.radiansToDegrees(a);o.getChildByName("arrow").setRotationFromEuler(c(-90,s-90,0))}}},l.setFollowTarget=function(e,t,r){for(var n=0;n<this.cells.length;n++)for(var o=0;o<this.cells[n].length;o++){if(!e[n][o].isBlock)this.cells[n][o].getChildByName("bg").getComponent(a).material.setProperty("albedo",s(1,1,1,1))}var l=this.cells[t][r];l&&l.getChildByName("bg").getComponent(a).material.setProperty("albedo",s(1,1,0,1))},o}(f))||m);o._RF.pop()}}}));

System.register("chunks:///_virtual/MapItemBase.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Global.ts","./Component.ts"],(function(t){var n,e,i,o,r;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,i=t._decorator},function(t){o=t.Global},function(t){r=t.default}],execute:function(){var a;e._RF.push({},"bfceaOtjbJCQobsl+gpzWO6","MapItemBase",void 0);var c=i.ccclass;i.property,t("default",c("MapItemBase")(a=function(t){function e(){for(var n,e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return(n=t.call.apply(t,[this].concat(i))||this).binit=!1,n.triggerAreaList=[],n}n(e,t);var i=e.prototype;return i.start=function(){this.onInit(),this.initArea(),this.triggerAreaList.forEach((function(t,n){t.uid=n})),console.log("addMapItem ",this.node.name),o.game.map.addMapItem(this)},i.initArea=function(){},i.onInit=function(){},i.onTriggerEnter=function(t,n){},i.onTriggerExit=function(t,n){},i.onTriggerStay=function(t,n){},e}(r))||a);e._RF.pop()}}}));

System.register("chunks:///_virtual/MapManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Global.ts","./FollowField.ts","./Component.ts","./EventManager.ts","./Room.ts","./RegionalEditor.ts","./GameConst.ts","./mapDebug.ts","./Model.ts"],(function(e){var t,i,n,a,o,r,c,s,l,f,u,d,h,p,m,v,M,b;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,a=e.assertThisInitialized,o=e.createClass},function(e){r=e.cclegacy,c=e._decorator,s=e.Prefab,l=e.v2},function(e){f=e.Global},function(e){u=e.FollowField},function(e){d=e.default},function(e){h=e.EventManager},function(e){p=e.Room},function(e){m=e.default},function(e){v=e.default},function(e){M=e.mapDebug},function(e){b=e.default}],execute:function(){var I,g,E,w,F;r._RF.push({},"d91f3AE9+VMIrYCl5m1P0DB","MapManager",void 0);var _=c.ccclass,y=c.executeInEditMode,G=c.property;e("MapManager",(I=_("MapManager"),g=G(s),I(E=y((F=t((w=function(e){function t(){for(var t,i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return t=e.call.apply(e,[this].concat(o))||this,n(t,"drawitem",F,a(t)),t.lastDeskId=-1,t._allMapItems=[],t.barricades=[],t.followField=void 0,t.obstacle=[],t}i(t,e);var r=t.prototype;return r.addMapItem=function(e){this._allMapItems.push(e)},r.removeMapItem=function(e){for(var t=0;t<this._allMapItems.length;++t)if(this._allMapItems[t]==e)return void this._allMapItems.splice(t,1)},r.onLoad=function(){f.map=this,this.initFollowFiled(!1),this.obstacle=this.node.getComponentsInChildren(m),this.GetGameObjects("Chest_Big").forEach((function(e){e.active=!1})),this.GetGameObjects("Chest_Small").forEach((function(e){e.active=!1}))},r.removeObstacle=function(e){var t=this.obstacle.indexOf(e);-1!=t&&this.obstacle.splice(t,1)},r.initFollowFiled=function(e){void 0===e&&(e=!1);var t=this.GetGameObject("grid").position;this.followField=new u(e?new M:null,l(-t.x,-t.z)),1==b.game.level?this.followField.createGrid(.5,l(40,40)):this.followField.createGrid(.5,l(70,70)),f.followFiled=this.followField},r.reset=function(){this.barricades.forEach((function(e){return e.showRepairIcon()}))},r.getNeedRepairCount=function(){var e=0;return this.barricades.forEach((function(t){t.checkNeedRepair()&&e++})),e},r.repair=function(e){void 0===e&&(e=!1),this.barricades.forEach((function(t){t.checkNeedRepair()&&t.repair(e)}))},r.hideRepairIcon=function(){this.barricades.forEach((function(e){e.hideRepairIcon()}))},r.onUnlockMapItem=function(e){this.allMapItems.forEach((function(t){t instanceof p&&t.refreshState(t.area_cfg.id==e)}))},r.onEnable=function(){h.Inst.on(v.EventType.EVT_UNLOCK_MAPITEM,this,this.onUnlockMapItem),h.Inst.on(v.EventType.GameStart,this,this.onGameStart)},r.onDisable=function(){},r.start=function(){var e=this;this.scheduleOnce((function(){console.log("map初始化","6666666666"),e.allMapItems.forEach((function(e){e instanceof p&&e.node.activeInHierarchy&&e.refreshState(!1)})),e.refreshBarricade()}))},r.refreshBarricade=function(){this.barricades.forEach((function(e){e.updateBlock()}))},r.onGameStart=function(){this.refreshBarricade()},r.getBarricadeById=function(e){return this.barricades.find((function(t){return t.id==e}))},r.saveBarricadeHP=function(){var e={};this.barricades.forEach((function(t){e[t.id]=t.hp})),b.game.barricadeHp=e},r.drawLine=function(e,t){},o(t,[{key:"allMapItems",get:function(){return this._allMapItems}}]),t}(d)).prototype,"drawitem",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=w))||E)||E));r._RF.pop()}}}));

System.register("chunks:///_virtual/MapPlayerUpgradeArea.ts",["./rollupPluginModLoBabelHelpers.js","cc","./MapItemBase.ts","./GameConst.ts","./Player.ts","./WindowManager.ts","./Global.ts","./EventManager.ts"],(function(e){var n,t,r,a,i,o,s,l,p,c,u,g,d;return{setters:[function(e){n=e.inheritsLoose},function(e){t=e.cclegacy,r=e._decorator,a=e.SkeletalAnimation,i=e.MeshRenderer,o=e.v4},function(e){s=e.default},function(e){l=e.FacilityAreaType,p=e.default},function(e){c=e.Player},function(e){u=e.default},function(e){g=e.Global},function(e){d=e.EventManager}],execute:function(){var f;t._RF.push({},"36ad2+d5vBB6rsDUUpdVNDz","MapPlayerUpgradeArea",void 0);var h=r.ccclass;r.property,e("MapPlayerUpgradeArea",h("MapPlayerUpgradeArea")(f=function(e){function t(){for(var n,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(n=e.call.apply(e,[this].concat(r))||this).player_upgrade_area=null,n._trigger=!1,n}n(t,e);var r=t.prototype;return r.initArea=function(){this.triggerAreaList.push({type:l.PLAYER_UPGRADE,pos:this.player_upgrade_area.worldPosition,dis:1,checkType:0})},r.onEnable=function(){var e=this;this.AddEvent(p.EventType.GameStart,(function(){e.node.getComponentInChildren(a).play("Merchant_Hide")})),this.AddEvent(p.EventType.onLose,(function(){e.node.getComponentInChildren(a).play("Merchant")})),this.AddEvent(p.EventType.onPass,(function(){e.node.getComponentInChildren(a).play("Merchant")}))},r.update=function(e){this.player_upgrade_area.active=!g.game.running},r.onTriggerEnter=function(e,n){if(e instanceof c&&!g.game.running&&!this._trigger){this._trigger=!0;var t,r=this.GetGameObject("frame",this.node);if(r)null==(t=r.getComponent(i))||t.material.setProperty("mainColor",o(0,1,0,1));d.Inst.event(p.EventType.ENTER_PLAYER_UPGRADE)}},r.onTriggerExit=function(e,n){if(e instanceof c&&(this._trigger=!1,!g.game.running)){u.Instance().closeAll();var t,r=this.GetGameObject("frame",this.node);if(r)null==(t=r.getComponent(i))||t.material.setProperty("mainColor",o(1,1,1,1));d.Inst.event(p.EventType.EXIT_PLAYER_UPGRADE)}},t}(s))||f);t._RF.pop()}}}));

System.register("chunks:///_virtual/MapSkinArea.ts",["./rollupPluginModLoBabelHelpers.js","cc","./MapItemBase.ts","./GameConst.ts","./Player.ts","./WindowManager.ts","./Global.ts"],(function(e){var t,n,i,r,a,o,s,c,u,l,p;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,i=e._decorator,r=e.MeshRenderer,a=e.v4},function(e){o=e.default},function(e){s=e.FacilityAreaType,c=e.default},function(e){u=e.Player},function(e){l=e.default},function(e){p=e.Global}],execute:function(){var g;n._RF.push({},"ba66518u1dBA5iEzJhpDRJo","MapSkinArea",void 0);var f=i.ccclass;i.property,e("MapSkinArea",f("MapSkinArea")(g=function(e){function n(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).skin_area=null,t._trigger=!1,t}t(n,e);var i=n.prototype;return i.initArea=function(){this.triggerAreaList.push({type:s.SKIN,pos:this.skin_area.worldPosition,dis:1,checkType:0})},i.update=function(e){this.skin_area.active=!p.game.running},i.onTriggerEnter=function(e,t){if(e instanceof u&&!p.game.running&&!this._trigger){this._trigger=!0;var n=this.GetGameObject("frame",this.node);n&&n.getComponent(r).material.setProperty("mainColor",a(0,1,0,1)),l.Instance().open(c.winPath.SkinWin)}},i.onTriggerExit=function(e,t){if(e instanceof u&&(this._trigger=!1,!p.game.running)){l.Instance().closeAll();var n,i=this.GetGameObject("frame",this.node);if(i)null==(n=i.getComponent(r))||n.material.setProperty("mainColor",a(1,1,1,1))}},n}(o))||g);n._RF.pop()}}}));

System.register("chunks:///_virtual/MapWeaponArea.ts",["./rollupPluginModLoBabelHelpers.js","cc","./MapItemBase.ts","./GameConst.ts","./Player.ts","./WindowManager.ts","./Global.ts","./GuideManager.ts"],(function(e){var n,t,a,o,i,r,s,c,p,l,u,f,g;return{setters:[function(e){n=e.inheritsLoose},function(e){t=e.cclegacy,a=e._decorator,o=e.SkeletalAnimation,i=e.MeshRenderer,r=e.v4},function(e){s=e.default},function(e){c=e.FacilityAreaType,p=e.default},function(e){l=e.Player},function(e){u=e.default},function(e){f=e.Global},function(e){g=e.default}],execute:function(){var h;t._RF.push({},"0ec355UTmJBapTHrfjMwlvu","MapWeaponArea",void 0);var d=a.ccclass;a.property,e("MapWeaponArea",d("MapWeaponArea")(h=function(e){function t(){for(var n,t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];return(n=e.call.apply(e,[this].concat(a))||this).weapon_area=null,n._trigger=!1,n}n(t,e);var a=t.prototype;return a.initArea=function(){this.triggerAreaList.push({type:c.WEAPON_UPGRADE,pos:this.weapon_area.worldPosition,dis:1,checkType:0})},a.onEnable=function(){var e=this;this.AddEvent(p.EventType.GameStart,(function(){e.node.getComponentInChildren(o).play("Merchant_Hide")})),this.AddEvent(p.EventType.onLose,(function(){e.node.getComponentInChildren(o).play("Merchant")})),this.AddEvent(p.EventType.onPass,(function(){e.node.getComponentInChildren(o).play("Merchant")}))},a.update=function(e){this.weapon_area.active=!f.game.running},a.onTriggerEnter=function(e,n){if(e instanceof l&&!f.game.running&&!this._trigger){this._trigger=!0;var t,a=this.GetGameObject("frame",this.node);if(a)null==(t=a.getComponent(i))||t.material.setProperty("mainColor",r(0,1,0,1));f.game.pause=!0,u.Instance().open(p.winPath.WeaponWin),g.Instance().onEventTrigger("onOpenWeaponWin")}},a.onTriggerExit=function(e,n){if(e instanceof l&&(this._trigger=!1,!f.game.running)){u.Instance().closeAll();var t,a=this.GetGameObject("frame",this.node);if(a)null==(t=a.getComponent(i))||t.material.setProperty("mainColor",r(1,1,1,1))}},t}(s))||h);t._RF.pop()}}}));

System.register("chunks:///_virtual/MeshText.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,i,r,a,n,s,h,l,o,c,u,p,f,g;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,r=t.initializerDefineProperty,a=t.assertThisInitialized,n=t.createClass},function(t){s=t.cclegacy,h=t._decorator,l=t.SpriteAtlas,o=t.Material,c=t.Enum,u=t.CCString,p=t.MeshRenderer,f=t.Component,g=t.utils}],execute:function(){var y,m,x,M,d,v,_,b,C,w,T,F,S;s._RF.push({},"a2a1brEGPZIMbmXi0O808XC","MeshText",void 0);var D=h.ccclass,V=h.property,z=h.executeInEditMode,R=function(t){return t[t.Left=0]="Left",t[t.Center=1]="Center",t[t.Right=2]="Right",t}(R||{}),A=function(){function t(t){this.atlasData=void 0,this.typeMap=new Map,this.atlasData=t,this.initUV()}var e=t.prototype;return e.initUV=function(){for(var t=this.atlasData,e=t.getSpriteFrames()[0].width,i=t.getSpriteFrames()[0].height,r=0;r<t.getSpriteFrames().length;++r){var a=t.getSpriteFrames()[r],n={xMin:a.rect.x/e,yMin:a.rect.y/i,xMax:(a.rect.x+a.rect.width)/e,yMax:(a.rect.y+a.rect.height)/i,r:a.rect.width/a.rect.height};a.frameUV=n}},e.getType=function(t){return this.typeMap.get(t||"default")},e.getOrCreateType=function(t){return this.typeMap.has(t)||this.typeMap.set(t,new Map),this.typeMap.get(t)},e.generateChars=function(t){for(var e=this.getOrCreateType("default"),i=0;i<t.length;++i){var r=t[i],a=this.atlasData.getSpriteFrame(r);a?e.set(t[i],a):console.warn("图集里没找到字符:"+t[i])}},e.getTypeFrame=function(t,e){return this.getType(e).get(t)},e.getFrame=function(t){return this.atlasData.getSpriteFrame(t)},t}(),B=function(){function t(){}return t.createTextMesh=function(t,e,i){var r=[],a=[],n=[],s=t.length,h=s<<2;return r.length=h,a.length=h,n.length=3*(s<<1),this.setVerticesBuffer(r,a,t,e,i),this.setIndicesBuffer(n),g.createMesh({positions:r,indices:n,uvs:a,doubleSided:!1})},t.setIndicesBuffer=function(t){for(var e=0,i=0;i<t.length;i+=6)e=i/3<<1,t[i+0]=t[i+3]=e,t[i+1]=t[i+5]=e+3,t[i+2]=e+1,t[i+4]=e+2},t.setVerticesBuffer=function(t,e,i,r,a){for(var n=i.length<<2,s=0,h=0;h<n;h+=4){var l=i[h/4];if(null!=(p=a.getFrame(l)))s+=(g=p.frameUV).r;else console.warn("文字图集里没找到字符:"+l)}var o=0;switch(r){case R.Center:o=-s/2;break;case R.Left:o=0;break;case R.Right:o=-(n>>2)}var c=0,u=1;for(h=0;h<n;h+=4){c=(h+1)%2-1.5;var p,f=i[h/4];if(null!=(p=a.getFrame(f))){var g;u=(g=p.frameUV).r;var y=3*h;t[y+0]=o,t[y+1]=c+1,t[y+2]=0,t[(y+=3)+0]=o,t[y+1]=c,t[y+2]=0,o+=u,t[(y+=3)+0]=o,t[y+1]=c+1,t[y+2]=0,t[(y+=3)+0]=o,t[y+1]=c,t[y+2]=0;var m=2*h;e[m+0]=g.xMin,e[m+1]=g.yMin,e[(m+=2)+0]=g.xMin,e[m+1]=g.yMax,e[(m+=2)+0]=g.xMax,e[m+1]=g.yMin,e[(m+=2)+0]=g.xMax,e[m+1]=g.yMax}else console.warn("文字图集里没找到字符:"+f)}},t}();t("default",(y=D("MeshText"),m=z(),x=V({displayName:"图集",type:l}),M=V({displayName:"材质",type:o}),d=V({displayName:"图集字符"}),v=V({displayName:"布局",type:c(R)}),_=V({type:u}),y(b=m((w=e((C=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return e=t.call.apply(t,[this].concat(n))||this,r(e,"atlas",w,a(e)),r(e,"mat",T,a(e)),r(e,"chars",F,a(e)),r(e,"align",S,a(e)),e._atlas=void 0,e.hAlignType=R.Center,e._text="",e.mesh=null,e.lastText="",e}i(e,t);var s=e.prototype;return s.start=function(){this._atlas=new A(this.atlas),this._atlas.generateChars(this.chars),this._atlas=this.init(this.align),this.text=this._text},s.init=function(t){return void 0===t&&(t=R.Center),this.hAlignType=t,(this.getComponent(p)||this.addComponent(p)).setMaterial(this.mat,0),this._atlas},s.generateFilter=function(){if(this.lastText!=this._text){var t=this.mesh;this.mesh=B.createTextMesh(this._text,this.hAlignType,this._atlas),this.mesh&&(this.getComponent(p).mesh=this.mesh),t&&t.destroy(),this.lastText=this._text}},n(e,[{key:"text",get:function(){return this._text},set:function(t){this._text=t,null==t&&(this._text=""),this._atlas||(this._atlas=new A(this.atlas),this._atlas.generateChars(this.chars),this._atlas=this.init(this.align)),this.generateFilter()}}]),e}(f)).prototype,"atlas",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=e(C.prototype,"mat",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=e(C.prototype,"chars",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"0123456789"}}),S=e(C.prototype,"align",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return R.Center}}),e(C.prototype,"text",[_],Object.getOwnPropertyDescriptor(C.prototype,"text"),C.prototype),b=C))||b)||b));s._RF.pop()}}}));

System.register("chunks:///_virtual/MissionConfig.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ConfigAuto.ts"],(function(t){var n,e,r;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy},function(t){r=t.MissionConfigAuto}],execute:function(){e._RF.push({},"98dac+lEVxLjLbsgeQ3W3wv","MissionConfig",void 0);t("default",function(t){function e(){return t.apply(this,arguments)||this}n(e,t);var r=e.prototype;return r.loadLevel=function(t,n){var e=this.values.filter((function(n){return n.level==t}))[n-1],r=[].concat(e.probability),u=r.reduce((function(t,n){return t+=n}));r=r.map((function(t){return Math.round(e.total*t/u)}));for(var i=[],o=0;o<r.length;o++)for(var l=r[o];l>0;)i.push(o+1),l--;return i},r.getWaveData=function(t,n){return this.values.filter((function(n){return n.level==t}))[n-1]},r.getTotalWaveByLevel=function(t){return this.values.filter((function(n){return n.level==t})).length},r.getMapId=function(t){return this.values.find((function(n){return n.level==t})).mapID},e}(r));e._RF.pop()}}}));

System.register("chunks:///_virtual/Model.ts",["cc","./GameModel.ts","./TaskModel.ts"],(function(a){var t,e,n,o;return{setters:[function(a){t=a.cclegacy,e=a.sys},function(a){n=a.default},function(a){o=a.default}],execute:function(){t._RF.push({},"a09b8gaIuNOyI5Wfci3iwa0","Model",void 0);var s="yuij",c=a("default",function(){function a(){}return a.save=function(t){void 0===t&&(t=!1);var e={};e.game=a.game.getData(),e.task=a.task.getData(),a.savedata(e,t)},a.addCoin=function(){this.game.money+=1e3},a.getGameData=function(){return e.localStorage.getItem(s)},a.loadData=function(){var t=e.localStorage.getItem(s);t&&(t=JSON.parse(t),a.game.setData(t.game),a.task.setData(t.task),console.log(t))},a.savedata=function(a,t){var n=JSON.stringify(a);e.localStorage.setItem(s,n),a.game={}},a}());c.game=new n,c.task=new o,window.Model=c,t._RF.pop()}}}));

System.register("chunks:///_virtual/ModelBase.ts",["cc"],(function(t){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){t("save",(function(t,e){var s=c.classMap.get(t.constructor);void 0===s&&(s=[],c.classMap.set(t.constructor,s));s.push(e)})),e._RF.push({},"f72d3+tpVJKuZo3dxanczBI","ModelBase",void 0);var c=t("default",function(){function t(){}var e=t.prototype;return e.getData=function(){for(var e={},c=t.classMap.get(this.constructor),s=0;s<c.length;++s)e[c[s]]=this[c[s]];return e},e.setData=function(e){if(e)for(var c=t.classMap.get(this.constructor),s=0;s<c.length;++s){var n=e[c[s]];if(null!=n||null!=n)if("[object Object]"==Object.prototype.toString.call(n))for(var r in n)this[c[s]][r]=n[r];else this[c[s]]=n}},t}());c.classMap=new Map,e._RF.pop()}}}));

System.register("chunks:///_virtual/MoveBase.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var n,t,s,u,i;return{setters:[function(e){n=e.inheritsLoose,t=e.createClass},function(e){s=e.cclegacy,u=e._decorator,i=e.Component}],execute:function(){var o;s._RF.push({},"5e4a6gGUohK35NYg8ZmUju4","MoveBase",void 0);var r=u.ccclass;u.property,e("MoveBase",r("MoveBase")(o=function(e){function s(){for(var n,t=arguments.length,s=new Array(t),u=0;u<t;u++)s[u]=arguments[u];return(n=e.call.apply(e,[this].concat(s))||this)._paused=!1,n._running=!1,n._speed=100,n}n(s,e);var u=s.prototype;return u.start=function(){},u.update=function(e){},u.pause=function(){this._paused=!0},u.resume=function(){this._paused=!1},u.lateUpdate=function(e){this.step(e)},u.step=function(e){!this._paused&&this._running&&(e>.2&&(e=.04),this.onStep(e))},u.onStep=function(e){},t(s,[{key:"running",get:function(){return this._running},set:function(e){this._running=e}},{key:"speed",get:function(){return this._speed},set:function(e){this._speed=e}}]),s}(i))||o);s._RF.pop()}}}));

System.register("chunks:///_virtual/MsgHints.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ResHelper.ts","./GameConst.ts","./WindowManager.ts"],(function(t){var e,n,s,o,i,a,r,c,u,l,p,f,g;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,s=t._decorator,o=t.Label,i=t.v3,a=t.view,r=t.tween,c=t.Prefab,u=t.instantiate,l=t.Component},function(t){p=t.default},function(t){f=t.E_UILAYER},function(t){g=t.default}],execute:function(){var d;n._RF.push({},"1af32Yb0ZVOLpuRqus+FwVZ","MsgHints",void 0);var h=s.ccclass;s.property,t("default",h(d=function(t){function n(){return t.apply(this,arguments)||this}return e(n,t),n.prototype.setMsg=function(t){this.node.getComponentInChildren(o).string=t,this.node.setScale(i(0,0,0)),this.node.setPosition(0,.3*a.getVisibleSize().height),r(this.node).to(.1,{scale:i(1.1,1.1,1)}).to(.1,{scale:i(.9,.9,1)}).to(.1,{scale:i(1,1,1)}).delay(.5).by(.5,{position:i(0,100)}).removeSelf().start()},n.show=function(t){p.loadRes("prefabs/common/MsgHints","game",c,(function(e,s){var o=u(s);o.parent=g.Instance().getLayer(f.top),o.getComponent(n).setMsg(t)}))},n}(l))||d);n._RF.pop()}}}));

System.register("chunks:///_virtual/NetControl.ts",["cc","./LocalTemplete.ts","./NetTool.ts"],(function(t){var n,e,a,o,r,i;return{setters:[function(t){n=t.cclegacy},function(t){e=t.DefaultTemplete,a=t.LocalVersion,o=t.NetControlUrlTT,r=t.NetControlUrl},function(t){i=t.default}],execute:function(){n._RF.push({},"132394A/ThB9aVugYkxoAyh","NetControl",void 0);var l=t("default",function(){function t(){}return t.NowSecond=function(){return Math.floor(Date.now()/1e3)+this.offServTimestap},t.init=function(){this.load()},t.reload=function(){this.load()},t.getAdsData=function(t,n){return void 0===n&&(n=null),this.getPlatData("ads",{})[t]||n},t.getGameList=function(){for(var t=this.getPlatData("gamelist",[]),n=t.length,e=0;e<n;e+=1)if(t[e].appid==this.getPlatData("appid","")){t.splice(e,1);break}return t=t.sort((function(t,n){return n.weight-t.weight}))},t.getGameItem=function(){var t=this.getGameList(),n=t.length;return 0==n?null:t[this.gameIndex++%n]},t.getShareData=function(){var t=this.getPlatData("share_title",[]),n=this.getPlatData("share_content",[]),e=this.getPlatData("share_urls",[]);return{content:n[Math.floor(Math.random()*n.length)],title:t[Math.floor(Math.random()*t.length)],url:e[Math.floor(Math.random()*e.length)]}},t.getPlatData=function(t,n){return void 0===n&&(n=null),this.data[t]||n},t.getCtrData=function(t){return this.data.ctrl[t]||{}},t.isOffCitys=function(){if(!this.loc)return!1;for(var t=this.loc.length,n=this.getPlatData("citys",[]),e=0;e<t;e+=1)if(n.indexOf(this.loc[e])>=0)return!0;return!1},t.isContrilVersion=function(){var t=this.getPlatData("version","");return""!=t&&(a==t&&(console.log("是审核版本"),!0))},t.load=function(){var t=this;return new Promise((function(n,e){i.get(window.tt?o:r,null,(function(e){t.copyData(e),n(null)}))}))},t.copyData=function(t){for(var n in t)this.data[n]=t[n]},t}());l.query={},l.offServTimestap=0,l.gameIndex=0,l.data=e,l.loc=[],n._RF.pop()}}}));

System.register("chunks:///_virtual/NetTool.ts",["cc"],(function(o){var t;return{setters:[function(o){t=o.cclegacy}],execute:function(){t._RF.push({},"5e63dB4kaNO36Qz1ZbZfINX","NetTool",void 0);o("default",function(){function o(){}return o.get=function(o,t,e,n){void 0===n&&(n=null);var s=new XMLHttpRequest;if(t){var r="?";for(var u in t)"?"!=r&&(r+="&"),r+=u+"="+t[u];o+=encodeURI(r)}return console.log(o),s.open("GET",o,!0),s.timeout=1e4,s.onload=function(){if(s.status>=200&&s.status<300||304==s.status){if(""==s.responseText&&!e)return;var o=JSON.parse(s.responseText);e&&e(o)}else s.abort()},s.ontimeout=function(o){console.log("ontimeout",o),n&&n()},s.onabort=function(o){console.log("onabort",o),n&&n()},s.onerror=function(o){console.log("onerror",o),n&&n()},s.send(),s},o.post=function(o,t,e,n){void 0===n&&(n=null);var s=new XMLHttpRequest;return s.open("POST",o),s.timeout=3e4,console.log("post",o,t),s.setRequestHeader("Content-Type","application/json"),s.onload=function(){if(s.status>=200&&s.status<300||304==s.status){var t=JSON.parse(s.responseText);console.log(o,t),e&&e(t)}else console.log(s.status),s.abort()},s.ontimeout=function(o){var t="服务器无响应,请稍后再试-timeout";n?n(t):console.log(t)},s.onabort=function(o){console.log(o),n?n():console.log("服务器无响应,请稍后再试-abort")},s.onerror=function(o){var t="服务器无响应,请稍后再试-error";n?n(t):console.log(t)},s.send(JSON.stringify(t)),s},o}());t._RF.pop()}}}));

System.register("chunks:///_virtual/ObstacleConfig.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ConfigAuto.ts"],(function(t){var n,e,o;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy},function(t){o=t.ObstacleConfigAuto}],execute:function(){e._RF.push({},"4017cFvQs1O0YZcOMndlyvJ","ObstacleConfig",void 0);t("default",function(t){function e(){return t.apply(this,arguments)||this}return n(e,t),e}(o));e._RF.pop()}}}));

System.register("chunks:///_virtual/PassWin.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameConst.ts","./BasePanel.ts","./Model.ts","./EventManager.ts","./AdManager.ts","./WindowManager.ts","./AudioMgr.ts","./Utils.ts","./GuideManager.ts"],(function(t){var e,n,i,a,o,s,c,r,u,l,m,f,g,d,h;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,a=t.tween,o=t.v3,s=t.Vec3},function(t){c=t.default},function(t){r=t.default},function(t){u=t.default},function(t){l=t.EventManager},function(t){m=t.default},function(t){f=t.default},function(t){g=t.AudioMgr},function(t){d=t.default},function(t){h=t.default}],execute:function(){var v;n._RF.push({},"9f845rIvspHAb/V7bxcYTwN","PassWin",void 0);var p=i.ccclass;i.property,t("PassWin",p("PassWin")(v=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))||this).txt_coin=void 0,e.txt_diamond=void 0,e.aimCount=0,e}e(n,t);var i=n.prototype;return i.onBtnClicked=function(t,e){var n=this;if(!(this.aimCount>0)){var i=!1;"btn_double"==e?m.showVideo((function(t){0==t&&(i=!0,n.playAni(i))})):"btn_close"==e&&(i=!1,this.playAni(i))}},i.playAni=function(t){var e=this,n=f.Instance().getWin("GameWin");this.aimCount=0,u.game.getMoney>0&&(this.aimCount++,d.flyAnim("CoinUI",this.txt_coin.node,n.GetGameObject("lbl_coin"),10,30,(function(){u.game.money+=u.game.getMoney*(t?2:1),e.checkFlyAniComplete()}))),u.game.getGem>0&&(this.aimCount++,d.flyAnim("GemUI",this.txt_coin.node,n.GetGameObject("lbl_gem"),10,30,(function(){u.game.gem+=u.game.getGem*(t?2:1),e.checkFlyAniComplete()})))},i.checkFlyAniComplete=function(){this.aimCount--,0==this.aimCount&&(this.data.new?l.Inst.event(c.EventType.NewScene):l.Inst.event(c.EventType.onPass),l.Inst.event(c.EventType.EXIT_SKIN_CAMERA),h.Instance().onEventTrigger("onNewLevel"+u.game.currentWave),u.save(),this.close())},i.start=function(){this.txt_coin.string=u.game.getMoney+"",this.txt_diamond.string=u.game.getGem+"",g.Instance().playSFX("Victory");var t=this.GetGameObject("Godrays");a(t).by(2,{eulerAngles:o(0,0,-180)}).repeatForever().start(),this.node_top.scale=s.ZERO,a(this.node_top).to(.5,{scale:o(1,1,1)},{easing:"backOut"}).start(),m.showInterstitialAd()},i.update=function(t){},n}(r))||v);n._RF.pop()}}}));

System.register("chunks:///_virtual/Player.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Global.ts","./AssetPool.ts","./EventManager.ts","./Role.ts","./Model.ts","./Config.ts","./ResHelper.ts","./Bullet.ts","./AudioMgr.ts","./Utils.ts","./WindowManager.ts","./GameConst.ts","./HpBar.ts","./GuideManager.ts","./DirArrow.ts","./FSM.ts"],(function(t){var e,i,n,o,a,s,r,l,h,c,d,u,p,f,v,g,w,y,m,k,A,C,P,b,S,_,E,R,I,F,D,M,W;return{setters:[function(t){e=t.inheritsLoose,i=t.createClass,n=t.asyncToGenerator,o=t.regeneratorRuntime},function(t){a=t.cclegacy,s=t._decorator,r=t.v3,l=t.Vec3,h=t.tween,c=t.Prefab,d=t.instantiate,u=t.SkeletalAnimation,p=t.Vec2,f=t.ParticleSystem,v=t.v2,g=t.Vec4},function(t){w=t.Global},function(t){y=t.default},function(t){m=t.EventManager},function(t){k=t.Role},function(t){A=t.default},function(t){C=t.default},function(t){P=t.default},function(t){b=t.Bullet},function(t){S=t.AudioMgr},function(t){_=t.default},function(t){E=t.default},function(t){R=t.default},function(t){I=t.HpBar},function(t){F=t.default},function(t){D=t.DirArrow},function(t){M=t.default,W=t.FSMAction}],execute:function(){var T;a._RF.push({},"061f2Dq3l9OKpF6FSxWVVo6","Player",void 0);var x=function(t){return t[t.None=0]="None",t[t.Idle=1]="Idle",t[t.Attack=2]="Attack",t[t.Dead=3]="Dead",t}(x||{}),N=s.ccclass,X=(s.property,window.SAT),Z=X.Vector,B=X.Polygon,L=r();t("Player",N("Player")(T=function(t){function a(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).velocity=v(),e.dirArrow=void 0,e._bar=null,e.velocityDir=r(),e._speed=3,e.isAttack=!1,e.invincibleTime=0,e.lastplayhitsound=0,e.targetPos=r(),e.aimDir=r(),e.ani=void 0,e.skinNode=null,e.loadingskin=!1,e.fsm=void 0,e.curAni="",e.weaponConfig=null,e.currentWeponNode=null,e.attackFX=null,e.bulletSpwaner=null,e.laserFX=void 0,e.attackRate=1,e.isMove=!1,e.aimZombie=null,e.attackTimer=0,e.attackdistance=null,e.response=new X.Response,e.polygon1=new B(new Z(0,0),[]),e.polygon2=new B(new Z(0,0),[]),e.pauseMove=!1,e.lockMove=!1,e._hp=1,e.openRelive=0,e.canMoveCountRef=0,e}e(a,t);var s=a.prototype;return s.onLoad=function(){this.fsm=this.node.addComponent(M),this.fsm.init(this),this.fsm.addState(new W(this,x.Idle,this.onIdleEnter,this.onIdleUpdate,this.onIdleExit)),this.fsm.addState(new W(this,x.Attack,this.onAttackEnter,this.onAttackUpdate,this.onAttackExit)),this.fsm.addState(new W(this,x.Dead,this.onDeadEnter,this.onDeadUpdate,this.onDeadExit))},s.onIdleEnter=function(){this.attackFX&&(this.attackFX.active=!1),this.laserFX&&(this.laserFX.active=!1)},s.onIdleUpdate=function(t){var e;this.isAttackPossible()&&(this.aimZombie=w.game.getTargetZombie(this.node.worldPosition,null==(e=this.weaponConfig)?void 0:e.attack_radius),this.aimZombie&&this.fsm.changeState(x.Attack))},s.onIdleExit=function(){},s.onAttackEnter=function(){},s.onAttackUpdate=function(t){var e=this;if(this.attackTimer-=t,null!=this.laserFX&&(this.laserFX.active=!1),this.attackTimer<=0){var i,n;if(this.attackTimer=this.attackRate,null==this.aimZombie||!this.aimZombie.isAlive())return void this.fsm.changeState(x.Idle);if(this.checkInRange()){var o,a,s,r,c,d,u;this.attackFX&&(this.attackFX.active=!0),null!=this.laserFX&&(this.laserFX.active=!0);var p=null==this.bulletSpwaner?this.currentWeponNode.worldPosition.clone():this.bulletSpwaner.worldPosition.clone(),f=A.game.getWeapon(null==(o=this.weaponConfig)?void 0:o.id).level,v=this.node.forward.clone();v.negative();var g,y,k,P,E,I=new b(this.weaponConfig,C.weapon.getAtk(null==(a=this.weaponConfig)?void 0:a.id,f),this.aimZombie,p,v);if(m.Inst.event(R.EventType.CREATE_BULLET,I),this.playFireEffect(),11==(null==(s=this.weaponConfig)?void 0:s.id)){var F=w.game.getTargetZombies(this.aimZombie.node.worldPosition,5);F.length>3&&(F.sort((function(t,i){return l.squaredDistance(t.node.worldPosition,e.node.worldPosition)-l.squaredDistance(i.node.worldPosition,e.node.worldPosition)})),F=F.splice(0,3));var D=!1;F.forEach((function(t){var i,n=new b(e.weaponConfig,C.weapon.getAtk(null==(i=e.weaponConfig)?void 0:i.id,f),t,p,v);n.speed+=_.getRandom(-3,3),m.Inst.event(R.EventType.CREATE_BULLET,n),D=!0})),D&&this.playFireEffect()}if(1==(null==(r=this.weaponConfig)?void 0:r.id)){var M,W,T=w.game.getTargetFanZombies(this.node.worldPosition,null==(M=this.weaponConfig)?void 0:M.attack_radius,null==(W=this.weaponConfig)?void 0:W.attack_prop,v);T.length>5&&(T.sort((function(t,i){return l.squaredDistance(t.node.worldPosition,e.node.worldPosition)-l.squaredDistance(i.node.worldPosition,e.node.worldPosition)})),T=T.splice(0,5));var N=!1;T.forEach((function(t){if(t!=e.aimZombie){var i,n=new b(e.weaponConfig,C.weapon.getAtk(null==(i=e.weaponConfig)?void 0:i.id,f),t,p,v);m.Inst.event(R.EventType.CREATE_BULLET,n),N=!0}})),N&&this.playFireEffect()}if(0===(null==(c=this.weaponConfig)?void 0:c.move_attack))7==(null==(g=this.weaponConfig)?void 0:g.id)?this.ani.getState(this.curAni).speed=1.267/this.attackRate:this.ani.getState(this.curAni).speed=.9/this.attackRate,this.playAni(null==(y=this.weaponConfig)?void 0:y.shoot),this.isAttack=!0,h(this.node).delay(.9*this.attackRate).call((function(){e.isAttack=!1})).start(),null!=(k=this.weaponConfig)&&k.weapon_sound&&setTimeout((function(){var t;S.Instance().playSFX(null==(t=e.weaponConfig)?void 0:t.weapon_sound)}),500*this.attackRate);else if(null!=(P=this.weaponConfig)&&P.weapon_sound)S.Instance().playSFX(null==(E=this.weaponConfig)?void 0:E.weapon_sound);if(this.aimZombie=w.game.getTargetZombie(this.node.worldPosition,null==(d=this.weaponConfig)?void 0:d.attack_radius),null!=(u=this.weaponConfig)&&u.has_bullet_shell){var X=this.bulletSpwaner.worldPosition.clone(),Z=this.node.worldPosition.clone();Z.y=X.y,X=X.add(Z).multiplyScalar(.5),w.game.createBulletShell(X)}}else this.fsm.changeState(x.Idle);this.attackTimer<.1*this.attackRate&&10!=(null==(i=this.weaponConfig)?void 0:i.id)&&12!=(null==(n=this.weaponConfig)?void 0:n.id)&&this.attackFX&&(this.attackFX.active=!1)}},s.onAttackExit=function(){},s.onDeadEnter=function(){this.playAni("Death")},s.onDeadUpdate=function(t){},s.onDeadExit=function(){},s.start=function(){var t=n(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.loadSkin();case 2:this.loadWeapon(),this._bar=this.getComponentInChildren(I),this._bar.setColor(new g(0,1,0,1));case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),s.loadSkin=function(){var t=this;if(!this.loadingskin)return this.skinNode&&this.skinNode.destroy(),this.currentWeponNode=null,this.ani=null,this.loadingskin=!0,new Promise((function(e,i){var n=A.game.currentSkin||1;P.loadResSync("prefabs/skin/Player"+n,"game",c).then((function(i){t.skinNode=d(i),t.skinNode.parent=t.node,t.skinNode.setPosition(0,0,0),t.loadingskin=!1,t.ani=t.skinNode.getComponent(u),t.ani.getState("Death").wrapMode=1,e(null)}))}))},s.setData=function(t){this.hp=C.upgrade.getPlayerHpByLv(A.game.upgradeLvInfo[1]),this.updateHpBar(),this.fsm.enterState(x.Idle)},s.updateHpBar=function(){if(this._bar){var t=C.upgrade.getPlayerHpByLv(A.game.upgradeLvInfo[1]);this._bar.setProgress(this.hp/t),this._bar.node.active=this.hp>0}},s.setAimPos=function(){var t=n(o().mark((function t(e){var i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.dirArrow){t.next=4;break}this.dirArrow.getComponent(D).aimPos=e,t.next=11;break;case 4:return t.next=6,y.Instance().createObjAsync("prefabs/entity/DirArrow","DirArrow");case 6:(i=t.sent).parent=w.game.node_container,i.getComponent(D).target=this,this.dirArrow=i,this.dirArrow.getComponent(D).aimPos=e;case 11:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),s.onEnable=function(){m.Inst.on(R.EventType.JoystickMove,this,this.joystickMove),m.Inst.on(R.EventType.JoystickStop,this,this.joystickStop),m.Inst.on(R.EventType.SWITCH_WEAPON,this,this.loadWeapon)},s.joystickMove=function(t){var e=t.moveDistance.rotate(-Math.PI/2);e=e.normalize(),this.velocity.set(e.y,e.x),F.Instance().onEventTrigger("onMove")},s.joystickStop=function(t){this.velocity.set(p.ZERO)},s.playerCollision=function(){for(var t=w.map.obstacle,e=0;e<t.length;++e){var i=t[e];if(i.node.activeInHierarchy){this.polygon1.setPoints(i.worldVertexXZ),this.polygon2.setPoints(this.playerPolygon);var n=this.response;if(n.clear(),X.testPolygonPolygon(this.polygon1,this.polygon2,n)){var o=this.node.worldPosition.clone();o.x+=n.overlapV.x,o.z+=n.overlapV.y,this.node.worldPosition=o}}}},s.update=function(e){w.game.pause||this.isAlive()&&(t.prototype.update.call(this,e),this.pauseMove&&(this.velocity.x=this.velocity.y=0),this.invincibleTime>0&&(this.invincibleTime-=e),this.playerCollision(),this.updatePos(e))},s.updatePos=function(t){if(!this.lockMove&&!this.isAttack){var e;if(!this.canMove)return this.velocity.set(0,0),void this.playAni(null==(e=this.weaponConfig)?void 0:e.idle,.1);if(this.targetPos.x=this.node.worldPosition.x+this.velocity.x*t,this.targetPos.z=this.node.worldPosition.z+this.velocity.y*t,this.velocity.equals(p.ZERO,.01)){var i,n;if(this.ani&&this.ani.getState(this.curAni)&&(this.ani.getState(this.curAni).speed=1),0==(null==(i=this.weaponConfig)?void 0:i.move_attack))7==(null==(n=this.weaponConfig)?void 0:n.id)?this.ani&&this.ani.getState(this.curAni)&&(this.ani.getState(this.curAni).speed=1.267/this.attackRate):this.ani&&this.ani.getState(this.curAni)&&(this.ani.getState(this.curAni).speed=.9/this.attackRate);this.isMove=!1}else this.ani&&this.ani.getState(this.curAni)&&(this.ani.getState(this.curAni).speed=this.speed/4),this.isMove=!0;if(null!=this.aimZombie&&this.aimZombie.isValid){var o=this.node.eulerAngles.y;this.node.lookAt(this.aimZombie.node.worldPosition,l.UP);var a,s,h,c=this.node.eulerAngles.clone();if(c.x=c.z=0,c.y=_.angleLerp(o,c.y+180,.3),this.node.eulerAngles=c,this.isMove)if(0!==(null==(a=this.weaponConfig)?void 0:a.move_attack)){l.subtract(this.aimDir,this.aimZombie.node.worldPosition,this.node.worldPosition),l.normalize(this.aimDir,this.aimDir),l.normalize(this.velocityDir,r(this.velocity.x,0,this.velocity.y));var d,u=_.angle(this.aimDir,this.velocityDir);if(l.cross(this.velocityDir,this.aimDir,L),u<45)this.playAni(null==(d=this.weaponConfig)?void 0:d.run_forward,.01);else if(u>135){var f;this.playAni(null==(f=this.weaponConfig)?void 0:f.run_backward,.01)}else{var v,g;if(L.z>0)this.playAni(null==(v=this.weaponConfig)?void 0:v.strafe_right,.01);else this.playAni(null==(g=this.weaponConfig)?void 0:g.strafe_left,.01)}}else{var w;this.playAni(null==(w=this.weaponConfig)?void 0:w.run_forward,.01)}else if(1===(null==(s=this.weaponConfig)?void 0:s.move_attack))this.playAni(null==(h=this.weaponConfig)?void 0:h.idle,.01)}else if(this.isMove){var y;this.playAni(null==(y=this.weaponConfig)?void 0:y.run_forward,.01);o=this.node.eulerAngles.y;this.node.lookAt(this.targetPos,l.UP);var m=this.node.eulerAngles.clone();m.y=_.angleLerp(o,m.y+180,.3),this.node.eulerAngles=m}else if(!this.isMove){var k;this.playAni(null==(k=this.weaponConfig)?void 0:k.idle,.1)}var A=this.node.position;A.set(A.x+this.velocity.x*t*this.speed,0,A.z+this.velocity.y*t*this.speed),this.node.position=this.node.position.lerp(A,.5),this.attackdistance.setWorldRotationFromEuler(-90,0,0)}},s.playAni=function(t,e){this.ani&&this.curAni!=t&&(this.ani.play(t),this.curAni=t)},s.loadWeapon=function(t){var e,i,n,o,a,s,h,u,p,f=this;if(void 0===t&&(t=!1),t||null==this.weaponConfig||(null==(e=this.weaponConfig)?void 0:e.id)!=A.game.currentWeapon){null!=this.currentWeponNode&&(this.currentWeponNode.destroy(),this.currentWeponNode=null),S.Instance().playSFX("Equip"),this.weaponConfig=C.weapon.get(A.game.currentWeapon),this.attackdistance.setScale(2*(null==(i=this.weaponConfig)?void 0:i.attack_radius),2*(null==(n=this.weaponConfig)?void 0:n.attack_radius),2*(null==(o=this.weaponConfig)?void 0:o.attack_radius));var v=A.game.getWeapon(null==(a=this.weaponConfig)?void 0:a.id).level;this.playAni(null==(s=this.weaponConfig)?void 0:s.idle),this.attackRate=C.weapon.getAtkRate(null==(h=this.weaponConfig)?void 0:h.id,v),this.attackRate*=.8,this.attackRate=Math.max(.05,this.attackRate),this.bulletSpwaner=null;var g=C.weapon.isWeaponGold(null==(u=this.weaponConfig)?void 0:u.id,v);P.loadResSync("prefabs/guns/"+(null==(p=this.weaponConfig)?void 0:p.weapon_prefab)+(g?"Gold":""),"game",c).then((function(t){var e,i=f.GetGameObject(null==(e=f.weaponConfig)?void 0:e.weapon_point)||f.node;null!=f.currentWeponNode&&(f.currentWeponNode.destroy(),f.currentWeponNode=null),f.currentWeponNode=d(t),i.addChild(f.currentWeponNode),f.currentWeponNode.setPosition(l.ZERO),f.currentWeponNode.setRotationFromEuler(l.ZERO),f.currentWeponNode.setScale(r(1.3,1.3,1.3)),f.attackFX=f.GetGameObject("attackFX",f.currentWeponNode),f.attackFX&&(f.attackFX.active=!1),f.laserFX=f.GetGameObject("laserFX",f.currentWeponNode),f.bulletSpwaner=f.GetGameObject("BulletSpawner",f.currentWeponNode)||f.currentWeponNode}))}},s.checkInRange=function(){var t,e=null==(t=this.weaponConfig)?void 0:t.attack_radius;return l.squaredDistance(this.node.worldPosition,this.aimZombie.node.worldPosition)<=e*e},s.isAttackPossible=function(){var t;return!(null==this.currentWeponNode||!w.game.running)&&(!(null==(t=this.weaponConfig)||!t.move_attack)||!this.isMove)},s.playFireEffect=function(){this.bulletSpwaner.getComponentsInChildren(f).forEach((function(t){t.node.active=!0,t.stopEmitting(),t.play()}))},s.damage=function(t){this.invincibleTime>0||(this.hp-=t,this.updateHpBar(),Date.now()-this.lastplayhitsound>300&&(S.Instance().playSFX("hit_hero"),this.lastplayhitsound=Date.now()),this.hp<=0&&this.fsm.changeState(x.Dead))},s.relive=function(){this.invincibleTime=3;var t=C.upgrade.getPlayerHpByLv(A.game.upgradeLvInfo[1]);this.hp=t,this.fsm.changeState(x.Idle),this.updateHpBar()},s.isAlive=function(){return this.hp>0},i(a,[{key:"speed",get:function(){return this._speed*C.upgrade.getPlayerSpeedByLv(A.game.upgradeLvInfo[2])}},{key:"playerPolygon",get:function(){var t=[],e=this.node.worldPosition;return t.push(new Z(e.x-.6,e.z-.6)),t.push(new Z(e.x+.6,e.z-.6)),t.push(new Z(e.x+.6,e.z+.6)),t.push(new Z(e.x-.6,e.z+.6)),t.reverse()}},{key:"hp",get:function(){return this._hp},set:function(t){this._hp=t,this._hp<=0&&(this._hp=0),m.Inst.event(R.EventType.PlayerHpChange,this._hp),0==this._hp&&(console.log("死亡"),w.map.saveBarricadeHP(),E.Instance().open(R.winPath.ReliveWin))}},{key:"canMove",get:function(){return 0==this.canMoveCountRef},set:function(t){t?(this.canMoveCountRef--,this.canMoveCountRef<=0&&(this.canMoveCountRef=0)):this.canMoveCountRef++}}]),a}(k))||T);a._RF.pop()}}}));

System.register("chunks:///_virtual/RegionalEditor.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Global.ts","./RegionalHelper.ts"],(function(o){var e,n,t,i,r;return{setters:[function(o){e=o.inheritsLoose},function(o){n=o.cclegacy,t=o._decorator},function(o){i=o.Global},function(o){r=o.RegionalHelper}],execute:function(){var l;n._RF.push({},"894a8M8+nJKlaisvkrw/SoQ","RegionalEditor",void 0);var a=t.ccclass,c=(t.property,t.executeInEditMode),s=(t.requireComponent,t.menu,window.SAT);o("default",a("RegionalEditor")(l=c(l=function(o){function n(){for(var e,n=arguments.length,t=new Array(n),i=0;i<n;i++)t[i]=arguments[i];return(e=o.call.apply(o,[this].concat(t))||this).polygon=void 0,e}return e(n,o),n.prototype.resetBlock=function(o){void 0===o&&(o=!0);var e=[];this.worldVertexXZ.forEach((function(o,n){e.push(new s.Vector(o.x,o.y))})),this.polygon=new s.Polygon(null,e);var n=i.map.GetGameObject("grid"),t=n.position.x,r=n.position.z,l=Math.floor(this.polygon.xMax-t),a=Math.floor(this.polygon.xMin-t);a>l&&(l=a,a=a);var c=Math.floor(this.polygon.yMin-r),u=Math.floor(this.polygon.yMax-r);c>u&&(u=c,c=c);"wall_4"==this.node.name&&console.log(this.node.name,this.node.active,this.node.activeInHierarchy,o,c,u,a,l);for(var p=c;p<=u;p++)for(var h=a;h<=l;h++)o?i.followFiled.setBlock(p,h):i.followFiled.removeBlock(p,h)},n}(r))||l)||l);n._RF.pop()}}}));

System.register("chunks:///_virtual/RegionalHelper.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var n,r,o,t,i,s,a,l;return{setters:[function(e){n=e.inheritsLoose},function(e){r=e.cclegacy,o=e._decorator,t=e.MeshRenderer,i=e.Vec3,s=e.Node,a=e.Vec2,l=e.Component}],execute:function(){var c;r._RF.push({},"ca2f3aSMXVBPoN80h+LrIZc","RegionalHelper",void 0);var u=o.ccclass,h=(o.property,o.executeInEditMode);e("RegionalHelper",u("RegionalHelper")(c=h(c=function(e){function r(){for(var n,r=arguments.length,o=new Array(r),t=0;t<r;t++)o[t]=arguments[t];return(n=e.call.apply(e,[this].concat(o))||this).worldVertexXZ=[],n}n(r,e);var o=r.prototype;return o.onEnable=function(){var e,n=null==(e=this.node.getComponent(t))?void 0:e.mesh;if(n){var r=n.struct.minPosition.clone(),o=n.struct.maxPosition.clone(),l=[new i(r.x,r.y,r.z),new i(o.x,r.y,r.z),new i(o.x,r.y,o.z),new i(r.x,r.y,o.z),new i(r.x,o.y,r.z),new i(o.x,o.y,r.z),new i(o.x,o.y,o.z),new i(r.x,o.y,o.z)],c=[],u=new s;u.parent=this.node;for(var h=0;h<l.length;++h)u.setPosition(l[h]),c.push(u.worldPosition.clone());u.destroy();for(var p=[],y=0;y<c.length;y++){var d;null==(d=this.node.children[y])||d.setWorldPosition(c[y]);var f=c[y];f.y>=0&&p.push(new a(f.x,f.z))}this.grahamScan(p,this.worldVertexXZ,p.length)}else console.error("RegionalHelper need MeshRenderer",this.node.name)},o.grahamScan=function(e,n,r){var o,t,i=0,s=2;for(o=1;o<r;o++)(e[o].y<e[i].y||e[o].y==e[i].y&&e[o].x<e[i].x)&&(i=o);var a=e[0];e[0]=e[i],e[i]=a;var l=r;for(o=1;o<l-1;o++){for(i=o,t=o+1;t<l;t++){var c=this.multiply(e[0],e[i],e[t]);if(c>0)i=t;else if(0==c){l--,this.distanceSquaredVec2(e[0],e[t])-this.distanceSquaredVec2(e[0],e[i])>0?(e[i]=e[t],e[t]=e[l],t--):(a=e[l],e[l]=e[t],e[t]=a)}}a=e[o],e[o]=e[i],e[i]=a}for(n.push(e[0]),n.push(e[1]),n.push(e[2]),o=3;o<l;o++){for(;!(this.multiply(e[o],n[s-1],n[s])<0);)s--,n.pop();s++,n.push(e[o])}},o.multiply=function(e,n,r){return(n.x-e.x)*(r.y-e.y)-(r.x-e.x)*(n.y-e.y)},o.distanceSquaredVec2=function(e,n){var r=e.x-n.x,o=e.y-n.y;return r*r+o*o},r}(l))||c)||c);r._RF.pop()}}}));

System.register("chunks:///_virtual/ReliveWin.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameConst.ts","./Global.ts","./BasePanel.ts","./AdManager.ts","./WindowManager.ts","./AudioMgr.ts"],(function(e){var t,n,o,i,r,a,s,c,u,l,f;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,o=e._decorator,i=e.tween,r=e.v3},function(e){a=e.default},function(e){s=e.Global},function(e){c=e.default},function(e){u=e.default},function(e){l=e.default},function(e){f=e.AudioMgr}],execute:function(){var p;n._RF.push({},"c74e3GYb69LmpV5nPQDo9RD","ReliveWin",void 0);var v=o.ccclass;o.property,e("ReliveWin",v("ReliveWin")(p=function(e){function n(){return e.apply(this,arguments)||this}t(n,e);var o=n.prototype;return o.onBtnClicked=function(e,t){var n=this;"btn_retry"==t?u.showVideo((function(e){0==e&&(s.player.relive(),n.close())})):(this.close(),l.Instance().open(a.winPath.LoseWin))},o.start=function(){f.Instance().playSFX("Lose");var e=this.GetGameObject("Shine");i(e).by(2,{eulerAngles:r(0,0,-180)}).repeatForever().start(),i(this.GetGameObject("btn_retry")).to(.5,{scale:r(1.1,1.1,1)}).to(.5,{scale:r(1,1,1)}).union().repeatForever().start()},o.update=function(e){},n}(c))||p);n._RF.pop()}}}));

System.register("chunks:///_virtual/ResHelper.ts",["cc"],(function(n){var e,t,o,u,i;return{setters:[function(n){e=n.cclegacy,t=n.assetManager,o=n.log,u=n.builtinResMgr,i=n.SpriteFrame}],execute:function(){e._RF.push({},"3b802dI3e9FvIHF0c2oaiA/","ResHelper",void 0);n("default",function(){function n(){}return n.loadBundle=function(n){return new Promise((function(e,o){t.loadBundle(n,(function(n,t){n?o(n):e(t)}))}))},n.loadRes=function(n,e,u,i,l){t.loadBundle(e,(function(e,t){e?o(e):t.load(n,u,null==l?function(){}:l,i)}))},n.loadResSync=function(n,e,t){var o=this;return new Promise((function(u,i){o.loadBundle(e).then((function(e){e.load(n,t,null,(function(e,t){e&&(console.log("not find",n),u(null)),u(t)}))}))}))},n.loadReses=function(n,e,u,i,l){t.loadBundle(e,(function(e,t){e?o(e):t.load(n,u,null==l?function(){}:l,i)}))},n.getRes=function(n,e,o){return t.getBundle(e).get(n,o)},n.setGray=function(n,e){e?n.setMaterial(u.get("2d-gray-sprite"),0):n.setMaterial(u.get("2d-sprite"),0)},n.setSpriteFrame=function(n,e,u,l){void 0===u&&(u="resources"),void 0===l&&(l=null),t.getBundle(u).load(e,i,(function(t,u){t?o("error",e):(n.spriteFrame=u,l&&l())}))},n}());e._RF.pop()}}}));

System.register("chunks:///_virtual/Role.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Global.ts","./Component.ts"],(function(e){var i,t,o,n,r,c,s;return{setters:[function(e){i=e.inheritsLoose,t=e.createForOfIteratorHelperLoose,o=e.createClass},function(e){n=e.cclegacy,r=e._decorator},function(e){c=e.Global},function(e){s=e.default}],execute:function(){var l;n._RF.push({},"e2062PHCWNPqau18GpBK6cf","Role",void 0);var a=r.ccclass,h=(r.property,window.SAT),u=new h.Response;e("Role",a("Role")(l=function(e){function n(){for(var i,t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return(i=e.call.apply(e,[this].concat(o))||this).circle=void 0,i.stackList=[],i.mass=1,i.offsetX=0,i.offsetZ=0,i}i(n,e);var r=n.prototype;return r.onEnable=function(){this.circle=new h.Circle(new h.Vector(this.node.worldPosition.x,this.node.worldPosition.z),.5)},r.updateCircle=function(){null==this.circle?this.circle=new h.Circle(new h.Vector(this.node.worldPosition.x,this.node.worldPosition.z),.5):(this.circle.pos.x=this.node.worldPosition.x,this.circle.pos.y=this.node.worldPosition.z)},r.start=function(){},r.update=function(e){this.triggerCheck()},r.triggerCheck=function(){if(c.game&&c.game.map)for(var e=c.game.map.allMapItems,i=e.length-1;i>=0;--i){var o=e[i],n=o.triggerAreaList;if(n)for(var r,s=t(n);!(r=s()).done;){var l=r.value,a="__player_in_"+l.type+"_"+l.uid;this.checkCondition(l)?(o[a]?o.onTriggerStay(this,l):o.onTriggerEnter(this,l),o[a]=!0):(o[a]&&o.onTriggerExit(this,l),o[a]=!1)}}},r.checkCondition=function(e){return 0==e.checkType?!!e.pos&&this.node.worldPosition.clone().subtract(e.pos).length()<e.dis:!(1!=e.checkType||!this.circle)&&h.testCirclePolygon(this.circle,e.polygon,u)},r.updateMove=function(e){},r.isAlive=function(){return!0},o(n,[{key:"radius",get:function(){return null==this.circle&&(this.circle=new h.Circle(new h.Vector(this.node.worldPosition.x,this.node.worldPosition.z),.5)),this.circle.r},set:function(e){null==this.circle&&(this.circle=new h.Circle(new h.Vector(this.node.worldPosition.x,this.node.worldPosition.z),e)),this.circle.r=e}}]),n}(s))||l);n._RF.pop()}}}));

System.register("chunks:///_virtual/Room.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Player.ts","./GameConst.ts","./AreaUnlockUI.ts","./Config.ts","./MapItemBase.ts","./Model.ts","./RegionalEditor.ts","./SectionUnlocker.ts","./UnlockHide.ts"],(function(e){var n,t,o,a,i,r,c,s,l,f,u,h,d,g,m;return{setters:[function(e){n=e.inheritsLoose,t=e.createClass},function(e){o=e.cclegacy,a=e._decorator,i=e.tween,r=e.v3},function(e){c=e.Player},function(e){s=e.FacilityAreaType},function(e){l=e.AreaUnlockUI},function(e){f=e.default},function(e){u=e.default},function(e){h=e.default},function(e){d=e.default},function(e){g=e.SectionUnlocker},function(e){m=e.UnlockHide}],execute:function(){var v;o._RF.push({},"b07590fOyZErbonZjcYnwQw","Room",void 0);var y=a.ccclass;a.property,e("Room",y("Room")(v=function(e){function o(){for(var n,t=arguments.length,o=new Array(t),a=0;a<t;a++)o[a]=arguments[a];return(n=e.call.apply(e,[this].concat(o))||this).unlockUI=[],n.Section_Unlockers=[],n.area_cfg=null,n.next_area_cfg=[],n}n(o,e);var a=o.prototype;return a.initArea=function(){var e=this;this.unlockUI.forEach((function(n){e.triggerAreaList.push({type:s.UNLOCK,pos:n.node.worldPosition,dis:2.5,data:n,checkType:0})}))},a.getRoomId=function(){return f.area.getByName([this.node.name],h.game.level)[0].id},a.onInit=function(){var e=this;this.Section_Unlockers=this.node.getComponentsInChildren(g),this.area_cfg=f.area.getByName([this.node.name],h.game.level)[0],this.area_cfg,this.next_area_cfg=f.area.getByName(this.area_cfg.next_room,h.game.level),this.unlockUI=this.node.getComponentsInChildren(l),this.unlockUI.forEach((function(n,t){var o=e.area_cfg.next_room[t],a=f.area.getByName([o],h.game.level)[0];n.setMapItem(a)})),this.refreshState(!1),console.log(this.area_cfg,"初始化","6666666666")},a.refreshState=function(e){var n=this;(void 0===e&&(e=!1),this.GetGameObjects("obstacle").forEach((function(e){return e.active=n.unlock})),this.node.active=this.unlock,this.Section_Unlockers.forEach((function(e){var n=e.room_name,t=f.area.getByName([n],h.game.level)[0];t&&(e.node.active=-1==h.game.unlockAreaIds.indexOf(t.id))})),e)?i(this.node).to(.25,{scale:r(1.1,1.1,1.1)}).to(.25,{scale:r(1,1,1)}).call((function(){n.getComponentsInChildren(d).forEach((function(e){e.resetBlock(e.node.activeInHierarchy)}))})).start():this.getComponentsInChildren(d).forEach((function(e){e.resetBlock(e.node.activeInHierarchy)}));this.node.getComponentsInChildren(m).forEach((function(e){var t=f.area.getByName([e.room_name],h.game.level)[0];e.node.active=-1==h.game.unlockAreaIds.indexOf(t.id),n.getComponentsInChildren(d).forEach((function(e){e.resetBlock(e.node.activeInHierarchy)}))}))},a.onTriggerEnter=function(e,n){if(e instanceof c){var t=n.data;t instanceof l&&t.node.activeInHierarchy&&t.playerEnter()}},a.onTriggerExit=function(e,n){if(e instanceof c){var t=n.data;t instanceof l&&t.node.activeInHierarchy&&t.playerExit()}},a.onTriggerStay=function(e,n){if(e instanceof c){var t=n.data;t instanceof l&&t.node.activeInHierarchy&&t.playerStay()}},t(o,[{key:"unlock",get:function(){var e=-1!=h.game.unlockAreaIds.indexOf(this.area_cfg.id);return 0==this.area_cfg.unlock_coin||e}}]),o}(u))||v);o._RF.pop()}}}));

System.register("chunks:///_virtual/SectionUnlocker.ts",["./rollupPluginModLoBabelHelpers.js","cc","./RegionalEditor.ts"],(function(e){var t,n,r,o,i,c,l,a;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){i=e.cclegacy,c=e._decorator,l=e.Component},function(e){a=e.default}],execute:function(){var s,u,p;i._RF.push({},"a67aclAlZtG1YrpOk1Gkt28","SectionUnlocker",void 0);var f=c.ccclass,h=c.property;e("SectionUnlocker",f("SectionUnlocker")((p=t((u=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),c=0;c<n;c++)i[c]=arguments[c];return t=e.call.apply(e,[this].concat(i))||this,r(t,"room_name",p,o(t)),t}return n(t,e),t.prototype.resetBlock=function(e){this.node.getComponentsInChildren(a).forEach((function(t){return t.resetBlock(e)}))},t}(l)).prototype,"room_name",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),s=u))||s);i._RF.pop()}}}));

System.register("chunks:///_virtual/SettingWin.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BasePanel.ts","./AudioMgr.ts"],(function(t){var n,e,i,s,o;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,i=t._decorator},function(t){s=t.default},function(t){o=t.AudioMgr}],execute:function(){var a;e._RF.push({},"1560daT8wBANaKSwWq76vqW","SettingWin",void 0);var c=i.ccclass;i.property,t("SettingWin",c("SettingWin")(a=function(t){function e(){for(var n,e=arguments.length,i=new Array(e),s=0;s<e;s++)i[s]=arguments[s];return(n=t.call.apply(t,[this].concat(i))||this).btn_sound=null,n.btn_music=null,n.btn_vibrate=null,n}n(e,t);var i=e.prototype;return i.onBtnClicked=function(t,n){if("btn_close"==n&&this.close(!0),"btn_sound"==n){var e=o.Instance().sound;o.Instance().sound=1==e?0:1,this.refreshBtns()}else if("btn_music"==n){var i=o.Instance().music;o.Instance().music=1==i?0:1,this.refreshBtns()}else if("btn_vibrate"==n){var s=o.Instance().vibrate;o.Instance().vibrate=1==s?0:1,this.refreshBtns()}},i.start=function(){this.refreshBtns()},i.refreshBtns=function(){this.btn_sound.node.getChildByName("toggle_on").active=1==o.Instance().sound,this.btn_music.node.getChildByName("toggle_on").active=1==o.Instance().music,this.btn_vibrate.node.getChildByName("toggle_on").active=1==o.Instance().vibrate,this.btn_sound.node.getChildByName("toggle_off").active=1!=o.Instance().sound,this.btn_music.node.getChildByName("toggle_off").active=1!=o.Instance().music,this.btn_vibrate.node.getChildByName("toggle_off").active=1!=o.Instance().vibrate},e}(s))||a);e._RF.pop()}}}));

System.register("chunks:///_virtual/Singleton.ts",["cc"],(function(n){var t;return{setters:[function(n){t=n.cclegacy}],execute:function(){t._RF.push({},"da012rlnJRKf5FTU/9JMI8g","Singleton",void 0);n("default",function(){function n(){}return n.Instance=function(){return this.instance||(this.instance=new this),this.instance},n}());t._RF.pop()}}}));

System.register("chunks:///_virtual/SkinConfig.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ConfigAuto.ts"],(function(n){var t,i,e;return{setters:[function(n){t=n.inheritsLoose},function(n){i=n.cclegacy},function(n){e=n.SkinConfigAuto}],execute:function(){i._RF.push({},"c8b0eFpOaZASIzVlpeYp/q+","SkinConfig",void 0);n("default",function(n){function i(){return n.apply(this,arguments)||this}return t(i,n),i}(e));i._RF.pop()}}}));

System.register("chunks:///_virtual/SkinWin.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BasePanel.ts","./EventManager.ts","./GameConst.ts","./Global.ts","./Model.ts","./Config.ts","./MsgHints.ts"],(function(n){var e,t,i,r,a,o,s,c,u,l,k,f;return{setters:[function(n){e=n.inheritsLoose},function(n){t=n.cclegacy,i=n._decorator,r=n.Sprite,a=n.Color},function(n){o=n.default},function(n){s=n.EventManager},function(n){c=n.default},function(n){u=n.Global},function(n){l=n.default},function(n){k=n.default},function(n){f=n.default}],execute:function(){var g;t._RF.push({},"d1f4dvJu65En6HL2sH+OBuL","SkinWin",void 0);var d=i.ccclass;i.property,n("SkinWin",d("SkinWin")(g=function(n){function t(){for(var e,t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return(e=n.call.apply(n,[this].concat(i))||this).content=null,e.btn_unlock=null,e.lbl_unlock_cost=null,e.lbl_skin_effect=null,e.enterSkinId=l.game.currentSkin,e}e(t,n),t.hongdian=function(){for(var n=0;n<k.skin.values.length;++n){var e=k.skin.values[n];if(-1==l.game.skinIds.indexOf(e.id)&&l.game.gem>=e.unlock_diamonds)return!0}return!1};var i=t.prototype;return i.onBtnClicked=function(n,e){var t;if("btn_close"!=e){if("btn_unlock"==e){var i=k.skin.get(l.game.currentSkin);if(l.game.gem<i.unlock_diamonds)return void f.show("钻石不足");l.game.gem-=i.unlock_diamonds,l.game.skinIds.push(l.game.currentSkin)}else"btn_skin_1"==e?l.game.currentSkin=1:"btn_skin_2"==e?l.game.currentSkin=2:"btn_skin_3"==e?l.game.currentSkin=3:"btn_skin_4"==e?l.game.currentSkin=4:"btn_skin_5"==e?l.game.currentSkin=5:"btn_skin_6"==e?l.game.currentSkin=6:"btn_skin_7"==e&&(l.game.currentSkin=7);null==(t=u.player.loadSkin())||t.then((function(){u.player.loadWeapon(!0)}));var r=k.skin.get(l.game.currentSkin);this.btn_unlock.node.active=-1==l.game.skinIds.indexOf(l.game.currentSkin),this.btn_unlock.node.active?this.lbl_unlock_cost.string=r.unlock_diamonds.toString():(this.enterSkinId=l.game.currentSkin,l.save()),this.refreshSkinEffect(),this.refreshSkinState()}else{var a;-1==l.game.skinIds.indexOf(l.game.currentSkin)&&(l.game.currentSkin=this.enterSkinId,null==(a=u.player.loadSkin())||a.then((function(){u.player.loadWeapon(!0)}))),this.close(!0)}},i.refreshSkinState=function(){var n=this;this.content.children.forEach((function(e,t){e.getChildByName("lock").active=-1==l.game.skinIds.indexOf(t+1),e.getChildByName("choosed").active=n.enterSkinId==t+1,e.getComponent(r).color=l.game.currentSkin==t+1?(new a).fromHEX("#FFC200"):a.WHITE}))},i.onEnable=function(){this.enterSkinId=l.game.currentSkin,this.refreshSkinState(),s.Inst.event(c.EventType.ENTER_SKIN_CAMERA),this.refreshSkinEffect(),u.game.pause=!0},i.refreshSkinEffect=function(){for(var n=k.skin.get(l.game.currentSkin),e="",t=0;t<n.value.length;++t){var i=n.value[t];i&&(e+=n.name[t]+"增加"+100*i+"% ")}this.lbl_skin_effect.string=e},i.update=function(n){u.player.node.setRotationFromEuler(0,180,0)},i.onHide=function(){s.Inst.event(c.EventType.EXIT_SKIN_CAMERA)},i.onDisable=function(){u.game.pause=!1},t}(o))||g);t._RF.pop()}}}));

System.register("chunks:///_virtual/SleepEffect.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameConst.ts","./Global.ts","./AssetPool.ts"],(function(t){var e,o,n,r,a,s,i,c,l,f,u,p;return{setters:[function(t){e=t.inheritsLoose,o=t.createForOfIteratorHelperLoose,n=t.createClass},function(t){r=t.cclegacy,a=t._decorator,s=t.Tween,i=t.v3,c=t.tween,l=t.Component},function(t){f=t.default},function(t){u=t.Global},function(t){p=t.default}],execute:function(){var h;r._RF.push({},"f4055jSKKNDU5GGxVHgIqNG","SleepEffect",void 0);var d=a.ccclass;a.property,t("SleepEffect",d("SleepEffect")(h=function(t){function r(){for(var e,o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))||this)._target=void 0,e}e(r,t);var a=r.prototype;return a.start=function(){this.node.setRotation(u.camera._camera_init_rot.clone())},a.play=function(){for(var t,e=this.node.children,n=0,r=o(e);!(t=r()).done;){var a=t.value;s.stopAllByTarget(a);var l=.2+.1*n;a.setScale(i(l,l,l)),c(a).delay(.1*n).to(.3,{scale:i(l+.2,l+.2,l+.2)}).to(.3,{scale:i(l/2,l/2,l/2)}).union().repeatForever().start(),n++}},a.removeSleepState=function(){p.Instance().put(this.node)},a.onDisable=function(){this._target&&this._target.targetOff(this)},a.update=function(t){this._target&&this.node.setWorldPosition(this._target.worldPosition.clone().add(i(0,2,0)))},n(r,[{key:"target",get:function(){return this._target},set:function(t){this._target=t,t.on(f.EventType.RemoveSleepState,this.removeSleepState,this),this.play()}}]),r}(l))||h);r._RF.pop()}}}));

System.register("chunks:///_virtual/TaskConfig.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ConfigAuto.ts"],(function(t){var n,e,o;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy},function(t){o=t.TaskConfigAuto}],execute:function(){e._RF.push({},"2e7efOcszdEA7ftTuOQBJSc","TaskConfig",void 0);t("default",function(t){function e(){return t.apply(this,arguments)||this}return n(e,t),e}(o));e._RF.pop()}}}));

System.register("chunks:///_virtual/TaskModel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Config.ts","./ModelBase.ts"],(function(e){var i,n,t,o,r,u,a,l;return{setters:[function(e){i=e.applyDecoratedDescriptor,n=e.inheritsLoose,t=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy},function(e){u=e.default},function(e){a=e.default,l=e.save}],execute:function(){var s,c,p,d,f,h;r._RF.push({},"de630bHUZxKfZ3aaTzQRZ3B","TaskModel",void 0);e("default",(c=i((s=function(e){function i(){for(var i,n=arguments.length,r=new Array(n),u=0;u<n;u++)r[u]=arguments[u];return i=e.call.apply(e,[this].concat(r))||this,t(i,"killZombieIdCount",c,o(i)),t(i,"killZombieWeaponCount",p,o(i)),t(i,"unlockAreaIds",d,o(i)),t(i,"upgradeWeaponCounts",f,o(i)),t(i,"taskFinish",h,o(i)),i}n(i,e);var r=i.prototype;return r.killEnemy=function(e,i,n){this.killZombieIdCount[e]?this.killZombieIdCount[e]+=i:this.killZombieIdCount[e]=i,this.killZombieWeaponCount[n]?this.killZombieWeaponCount[n]+=i:this.killZombieWeaponCount[n]=i},r.unlockArea=function(e){-1==this.unlockAreaIds.indexOf(e)&&this.unlockAreaIds.push(e)},r.upgradeWeapon=function(){this.upgradeWeaponCounts++},r.getTaskCurrentValue=function(e,i,n){switch(e){case 1:return(this.killZombieIdCount[1]||0)+(this.killZombieIdCount[2]||0)+(this.killZombieIdCount[3]||0);case 2:return this.unlockAreaIds.length;case 3:return this.upgradeWeaponCounts||0;case 4:return this.killZombieIdCount[5]||0;case 4:return this.killZombieIdCount[4]||0;case 6:return this.killZombieWeaponCount[n]||0}return 0},r.hongdian=function(){for(var e=0;e<u.task.values.length;++e){var i=u.task.values[e],n=-1!=this.taskFinish.indexOf(i.id),t=this.getTaskCurrentValue(i.condition[0],i.condition[1],i.condition[2]);if(!n&&t>=i.condition[1])return!0}return!1},i}(a)).prototype,"killZombieIdCount",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),p=i(s.prototype,"killZombieWeaponCount",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),d=i(s.prototype,"unlockAreaIds",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),f=i(s.prototype,"upgradeWeaponCounts",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),h=i(s.prototype,"taskFinish",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),s));r._RF.pop()}}}));

System.register("chunks:///_virtual/TaskWin.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BasePanel.ts","./Config.ts","./Model.ts","./AudioMgr.ts"],(function(t){var n,e,i,s,a,o,r,c,l,u,d;return{setters:[function(t){n=t.inheritsLoose,e=t.createClass},function(t){i=t.cclegacy,s=t._decorator,a=t.Label,o=t.ProgressBar,r=t.Sprite},function(t){c=t.default},function(t){l=t.default},function(t){u=t.default},function(t){d=t.AudioMgr}],execute:function(){var k;i._RF.push({},"eb54aRc6mpB5qaGfaudzbwT","TaskWin",void 0);var f=s.ccclass;s.property,t("TaskWin",f("TaskWin")(k=function(t){function i(){for(var n,e=arguments.length,i=new Array(e),s=0;s<e;s++)i[s]=arguments[s];return(n=t.call.apply(t,[this].concat(i))||this).vlist_task=null,n}n(i,t);var s=i.prototype;return s.onBtnClicked=function(t,n){"btn_close"==n&&this.close(!0)},s.onShow=function(){this.vlist_task.setData(this.list,this.initItem.bind(this))},s.initItem=function(t,n){this.GetGameObject("lbl_desc",t,!0).getComponent(a).string=n.task_desc,this.GetGameObject("lbl_reward",t,!0).getComponent(a).string="x"+n.reward_value;var e=this.GetGameObject("progress_task",t,!0).getComponent(o),i=n.condition[1],s=u.task.getTaskCurrentValue(n.condition[0],n.condition[1],n.condition[2]);e.progress=s/i,this.GetGameObject("lbl_progress",t,!0).getComponent(a).string=s+"/"+i;var c=this.GetGameObject("btn_draw",t,!0);c.active=-1==u.task.taskFinish.indexOf(n.id),c.getComponent(r).grayscale=s<i,n.candraw=s>=i,this.addClick(c,"onDrawTask",n)},s.onDrawTask=function(t,n){n.candraw&&(u.task.taskFinish.push(n.id),0==n.reward_type?(u.game.money+=n.reward_value,d.Instance().playSFX("Get_Coin")):(u.game.gem+=n.reward_value,d.Instance().playSFX("GetGem")),this.vlist_task.setData(this.list,this.initItem.bind(this),!0),u.save())},e(i,[{key:"list",get:function(){var t=l.task.values.filter((function(t){return-1==u.task.taskFinish.indexOf(t.id)}));return t=t.sort((function(t,n){var e=u.task.getTaskCurrentValue(t.condition[0],t.condition[1],t.condition[2])>=t.condition[1];if(e!=u.task.getTaskCurrentValue(n.condition[0],n.condition[1],n.condition[2])>=n.condition[1])return e?-1:1}))}}]),i}(c))||k);i._RF.pop()}}}));

System.register("chunks:///_virtual/TestEnemy.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var o,e,n,i,l,s;return{setters:[function(t){o=t.inheritsLoose,e=t.createClass},function(t){n=t.cclegacy,i=t._decorator,l=t.v3,s=t.Component}],execute:function(){var r;n._RF.push({},"8cb95qtoiJDy56oagWA1xEN","TestEnemy",void 0);var c=i.ccclass;i.property,t("TestEnemy",c("TestEnemy")(r=function(t){function n(){for(var o,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(o=t.call.apply(t,[this].concat(n))||this)._followField=void 0,o}o(n,t);var i=n.prototype;return i.start=function(){},i.update=function(t){if(this._followField){var o=this._followField.getCellByPositon(this.node.position.clone());if(o){var e=o.bestDir.clone();this.node.position=this.node.position.add(l(e.y,e.x,0))}}},e(n,[{key:"followField",get:function(){return this._followField},set:function(t){this._followField=t}}]),n}(s))||r);n._RF.pop()}}}));

System.register("chunks:///_virtual/TipNode.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Component.ts"],(function(e){var t,o,n,r,i,c;return{setters:[function(e){t=e.inheritsLoose},function(e){o=e.cclegacy,n=e._decorator,r=e.tween,i=e.v3},function(e){c=e.default}],execute:function(){var s;o._RF.push({},"757b2x8ooNDsLZLXeq2Fqfo","TipNode",void 0);var u=n.ccclass;n.property,e("TipNode",u("TipNode")(s=function(e){function o(){return e.apply(this,arguments)||this}t(o,e);var n=o.prototype;return n.start=function(){r(this.GetGameObject("node_repair")).to(.35,{scale:i(1.2,1.2,1.2)}).to(.35,{scale:i(1,1,1)}).union().repeatForever().start()},n.update=function(e){},o}(c))||s);o._RF.pop()}}}));

System.register("chunks:///_virtual/Trap.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameConst.ts","./Global.ts","./MapItemBase.ts","./Enemy.ts"],(function(t){var o,n,i,e,s,a,r,c,p,u,l,h;return{setters:[function(t){o=t.inheritsLoose,n=t.createForOfIteratorHelperLoose,i=t.createClass},function(t){e=t.cclegacy,s=t._decorator,a=t.Tween,r=t.tween,c=t.v3},function(t){p=t.FacilityAreaType},function(t){u=t.Global},function(t){l=t.default},function(t){h=t.Enemy}],execute:function(){var d;e._RF.push({},"69412EGZ4pIjo3ZWSiuolUq","Trap",void 0);var g=s.ccclass,f=(s.property,function(t){return t[t.IDLE=0]="IDLE",t[t.COOLDOWN=1]="COOLDOWN",t[t.ACTIVE=2]="ACTIVE",t}(f||{})),y=window.SAT;t("Trap",g("Trap")(d=function(t){function e(){for(var o,n=arguments.length,i=new Array(n),e=0;e<n;e++)i[e]=arguments[e];return(o=t.call.apply(t,[this].concat(i))||this).duration=5,o.elapsed=0,o.coolDown=5,o.coolDownCount=5,o.isActive=!1,o.aidCount=0,o.node_spikes=void 0,o.polygon=void 0,o._state=f.IDLE,o}o(e,t);var s=e.prototype;return s.onLoad=function(){this.node_spikes=this.GetGameObject("Spikes");for(var t=[],o=0;o<4;o++){var n=this.GetGameObject("p"+o);n&&t.push(new y.Vector(n.worldPosition.x,n.worldPosition.z))}this.polygon=new y.Polygon(null,t)},s.initArea=function(){this.triggerAreaList.push({type:p.TRAP,pos:this.node.worldPosition,dis:1,checkType:1,polygon:this.polygon})},s.triggerDamage=function(){for(var t,o=u.game.getTargetZombies(this.node.position,5),i=n(o);!(t=i()).done;){t.value.onHit(this.damage)}},s.update=function(t){this._state==f.ACTIVE?(this.aidCount+=t,this.elapsed+=t,this.aidCount>=1&&(this.aidCount-=1,this.triggerDamage()),this.elapsed>=this.duration&&(this.coolDownCount=5,this.playDownAni(),this._state=f.COOLDOWN)):this._state==f.COOLDOWN&&(this.coolDownCount-=t,this.updateCoolDown(this.coolDownCount/this.coolDown),this.coolDownCount<=0&&(this._state=f.IDLE))},s.onTriggerEnter=function(t,o){this._state==f.IDLE&&t instanceof h&&(this._state=f.ACTIVE,this.playUpAni(),this.triggerDamage())},s.onTriggerExit=function(t,o){},s.onTriggerStay=function(t,o){},s.playUpAni=function(){a.stopAllByTarget(this.node_spikes),r(this.node_spikes).to(.25,{position:c(0,-.8,0)}).start()},s.playDownAni=function(){a.stopAllByTarget(this.node_spikes),r(this.node_spikes).to(.25,{position:c(0,-1.3,0)}).start()},s.updateCoolDown=function(t){},i(e,[{key:"damage",get:function(){return 10}}]),e}(l))||d);e._RF.pop()}}}));

System.register("chunks:///_virtual/TrapArea.ts",["./rollupPluginModLoBabelHelpers.js","cc","./MapItemBase.ts","./GameConst.ts","./Player.ts","./Global.ts","./EventManager.ts","./Model.ts","./MeshText.ts","./Trap.ts"],(function(e){var t,n,r,i,a,o,s,l,c,u,p,f,g,d,h,y,m,_,A;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){a=e.cclegacy,o=e._decorator,s=e.CCString,l=e.CCInteger,c=e.MeshRenderer,u=e.v4},function(e){p=e.default},function(e){f=e.FacilityAreaType,g=e.default},function(e){d=e.Player},function(e){h=e.Global},function(e){y=e.EventManager},function(e){m=e.default},function(e){_=e.default},function(e){A=e.Trap}],execute:function(){var C,T,v,k,I,b,E;a._RF.push({},"8230bgOCKdDyJn8y8JMyYFY","TrapArea",void 0);var P=o.ccclass,R=o.property;e("TrapArea",(C=P("TrapArea"),T=R({type:s,displayName:"陷阱ID"}),v=R({type:l,displayName:"解锁金币"}),C((b=t((I=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return t=e.call.apply(e,[this].concat(a))||this,r(t,"areaid",b,i(t)),r(t,"unlockCoin",E,i(t)),t.trap_unlock_area=null,t._trigger=!1,t}n(t,e);var a=t.prototype;return a.initArea=function(){this.triggerAreaList.push({type:f.TRAP_AREA,pos:this.trap_unlock_area.worldPosition,dis:1,checkType:0}),this.refreshArea(),this.trap_unlock_area.getComponentInChildren(_).text=this.unlockCoin.toString()},a.refreshArea=function(){this.trap_unlock_area.active=-1==m.game.trapUnlockIds.indexOf(this.areaid),this.node.getComponentInChildren(A).node.active=-1!=m.game.trapUnlockIds.indexOf(this.areaid)},a.onTriggerEnter=function(e,t){if(e instanceof d&&!h.game.running&&!this._trigger&&-1==m.game.trapUnlockIds.indexOf(this.areaid)){this._trigger=!0;var n,r=this.GetGameObject("frame",this.node);if(r)null==(n=r.getComponent(c))||n.material.setProperty("mainColor",u(0,1,0,1));y.Inst.event(g.EventType.ENTER_TRAP_UNLOCK_AREA,this)}},a.onTriggerExit=function(e,t){if(e instanceof d&&(this._trigger=!1,!h.game.running&&-1==m.game.trapUnlockIds.indexOf(this.areaid))){var n,r=this.GetGameObject("frame",this.node);if(r)null==(n=r.getComponent(c))||n.material.setProperty("mainColor",u(1,1,1,1));y.Inst.event(g.EventType.EXIT_TRAP_UNLOCK_AREA,this)}},t}(p)).prototype,"areaid",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),E=t(I.prototype,"unlockCoin",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),k=I))||k));a._RF.pop()}}}));

System.register("chunks:///_virtual/Turret.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Global.ts","./FSM.ts","./Component.ts","./AudioMgr.ts"],(function(t){var n,e,i,o,s,a,r,h,c,u,l,f,d,g;return{setters:[function(t){n=t.inheritsLoose,e=t.createClass},function(t){i=t.cclegacy,o=t._decorator,s=t.v3,a=t.quat,r=t.log,h=t.Vec3,c=t.Quat},function(t){u=t.Global},function(t){l=t.default,f=t.FSMAction},function(t){d=t.default},function(t){g=t.AudioMgr}],execute:function(){var p;i._RF.push({},"fe8b1pLHLZBPoc39W7eJJGS","Turret",void 0);var m=o.ccclass,v=(o.property,function(t){return t[t.IDLE=0]="IDLE",t[t.ATTACK=1]="ATTACK",t}(v||{})),A=s(),y=a(),F=a();t("Turret",m("Turret")(p=function(t){function i(){for(var n,e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return(n=t.call.apply(t,[this].concat(i))||this).fsm=void 0,n.target=void 0,n.shootCount=0,n.cannon=void 0,n.laserFX=null,n}n(i,t);var o=i.prototype;return o.onLoad=function(){r("turret"),this.cannon=this.node.getChildByName("Visual"),this.initFsm(),this.laserFX=this.GetGameObject("laserFX",this.node),this.laserFX.active=!1},o.initFsm=function(){this.fsm=this.node.addComponent(l),this.fsm.init(this),this.fsm.addState(new f(this,v.IDLE,this.onIdleEnter,this.onIdleUpdate)),this.fsm.addState(new f(this,v.ATTACK,this.onAttackEnter,this.onAttackUpdate))},o.startUp=function(){this.fsm.enterState(v.IDLE)},o.onEnable=function(){this.startUp()},o.onIdleEnter=function(){},o.onIdleUpdate=function(t){this.target=u.game.getTargetZombie(this.node.worldPosition,this.range),this.target&&this.fsm.changeState(v.ATTACK)},o.onAttackEnter=function(){},o.onAttackUpdate=function(t){if(u.player.isAlive())if(this.shootCount+=t,this.shootCount>this.shootDelay){if(this.shootCount=0,!this.target||!this.target.isAlive())return void this.fsm.changeState(v.IDLE);this.checkRange(this.target)?this.fire():(this.laserFX.active=!1,this.shootCount=this.shootDelay,this.fsm.changeState(v.IDLE))}else this.laserFX.active=!1},o.fire=function(){if(r("fire"),this.target){this.laserFX.active=!0,this.target.onHit(this.damage);var t=1-h.distance(this.node.worldPosition,u.player.node.worldPosition)/10;if(t<=0)return;t>1&&(t=1),g.Instance().playSFX("LaserGunStart",t),g.Instance().playSFX("LaserGunLoop",t)}},o.checkRange=function(t){return h.squaredDistance(this.node.worldPosition,t.node.worldPosition)<=this.range*this.range},o.update=function(t){if(this.fsm.isInState(v.ATTACK)&&this.target&&this.target.isAlive()){h.subtract(A,this.target.node.worldPosition,this.cannon.worldPosition),h.normalize(A,A);var n=180*Math.atan2(A.x,A.z)/Math.PI;c.fromEuler(y,0,n,0),c.slerp(F,this.cannon.rotation,y,.2),this.cannon.setRotation(F)}},e(i,[{key:"range",get:function(){return 10}},{key:"shootDelay",get:function(){return.1}},{key:"damage",get:function(){return 10}}]),i}(d))||p);i._RF.pop()}}}));

System.register("chunks:///_virtual/TurretArea.ts",["./rollupPluginModLoBabelHelpers.js","cc","./MapItemBase.ts","./GameConst.ts","./Player.ts","./Global.ts","./EventManager.ts","./Model.ts","./Turret.ts","./MeshText.ts"],(function(e){var t,r,n,i,a,o,s,u,l,c,f,p,g,d,h,m,y,_,T;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inheritsLoose,n=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){a=e.cclegacy,o=e._decorator,s=e.CCString,u=e.CCInteger,l=e.MeshRenderer,c=e.v4},function(e){f=e.default},function(e){p=e.FacilityAreaType,g=e.default},function(e){d=e.Player},function(e){h=e.Global},function(e){m=e.EventManager},function(e){y=e.default},function(e){_=e.Turret},function(e){T=e.default}],execute:function(){var v,C,A,E,I,k,R;a._RF.push({},"76820mUpfZBsJ3z6IU2HxxS","TurretArea",void 0);var b=o.ccclass,U=o.property;e("TurretArea",(v=b("TurretArea"),C=U({type:s,displayName:"炮台ID"}),A=U({type:u,displayName:"解锁金币"}),v((k=t((I=function(e){function t(){for(var t,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return t=e.call.apply(e,[this].concat(a))||this,n(t,"areaid",k,i(t)),n(t,"unlockCoin",R,i(t)),t.turret_unlock_area=null,t._trigger=!1,t}r(t,e);var a=t.prototype;return a.initArea=function(){this.triggerAreaList.push({type:p.TURRET_AREA,pos:this.turret_unlock_area.worldPosition,dis:1,checkType:0}),this.refreshArea(),this.turret_unlock_area.getComponentInChildren(T).text=this.unlockCoin.toString()},a.refreshArea=function(){this.turret_unlock_area.active=-1==y.game.turretUnlockIds.indexOf(this.areaid),this.node.getComponentInChildren(_).node.active=-1!=y.game.turretUnlockIds.indexOf(this.areaid)},a.onTriggerEnter=function(e,t){if(e instanceof d&&!h.game.running&&!this._trigger&&-1==y.game.turretUnlockIds.indexOf(this.areaid)){this._trigger=!0;var r,n=this.GetGameObject("frame",this.node);if(n)null==(r=n.getComponent(l))||r.material.setProperty("mainColor",c(0,1,0,1));m.Inst.event(g.EventType.ENTER_TURRET_UNLOCK_AREA,this)}},a.onTriggerExit=function(e,t){if(e instanceof d&&!h.game.running&&(this._trigger=!1,-1==y.game.turretUnlockIds.indexOf(this.areaid))){var r,n=this.GetGameObject("frame",this.node);if(n)null==(r=n.getComponent(l))||r.material.setProperty("mainColor",c(1,1,1,1));m.Inst.event(g.EventType.EXIT_TURRET_UNLOCK_AREA,this)}},t}(f)).prototype,"areaid",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),R=t(I.prototype,"unlockCoin",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),E=I))||E));a._RF.pop()}}}));

System.register("chunks:///_virtual/UnlockHide.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var r,n,i,o,t,c,a;return{setters:[function(e){r=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){t=e.cclegacy,c=e._decorator,a=e.Component}],execute:function(){var l,s,u,p,d;t._RF.push({},"d3bf3bl1jBD85hcvUho7XQk","UnlockHide",void 0);var f=c.ccclass,h=c.property;e("UnlockHide",(l=f("UnlockHide"),s=h({displayName:"如果改区域解锁，隐藏墙体"}),l((d=r((p=function(e){function r(){for(var r,n=arguments.length,t=new Array(n),c=0;c<n;c++)t[c]=arguments[c];return r=e.call.apply(e,[this].concat(t))||this,i(r,"room_name",d,o(r)),r}return n(r,e),r}(a)).prototype,"room_name",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),u=p))||u));t._RF.pop()}}}));

System.register("chunks:///_virtual/UnlockWeaponWin.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BasePanel.ts","./Config.ts","./Model.ts","./AdManager.ts","./MsgHints.ts","./Global.ts","./EventManager.ts","./GameConst.ts"],(function(e){var n,t,a,o,i,s,r,l,c,u,p,d,g;return{setters:[function(e){n=e.inheritsLoose},function(e){t=e.cclegacy,a=e._decorator,o=e.Label,i=e.Sprite},function(e){s=e.default},function(e){r=e.default},function(e){l=e.default},function(e){c=e.default},function(e){u=e.default},function(e){p=e.Global},function(e){d=e.EventManager},function(e){g=e.default}],execute:function(){var m;t._RF.push({},"faee4LeD95DFqTgw+n+5VAe","UnlockWeaponWin",void 0);var f=a.ccclass;a.property,e("UnlockWeaponWin",f("UnlockWeaponWin")(m=function(e){function t(){for(var n,t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];return(n=e.call.apply(e,[this].concat(a))||this).unlock_diamonds=0,n.lbl_upgrade_coin=null,n}n(t,e);var a=t.prototype;return a.onBtnClicked=function(e,n){var t=this;if("btn_close"==n)this.close(!0);else if("btn_buy"==n){if(l.game.gem<this.unlock_diamonds)return void u.show("钻石不足");l.game.gem-=this.unlock_diamonds,l.game.upgradeWeapon(this.data),l.task.upgradeWeapon(),l.game.currentWeapon=this.data,p.player.loadWeapon(!0),d.Inst.event(g.EventType.RefreshWeaponHolder),l.save(),this.close(!0)}else"btn_ad"==n&&c.showVideo((function(e){0==e&&(l.task.upgradeWeapon(),l.game.upgradeWeapon(t.data),l.game.currentWeapon=t.data,p.player.loadWeapon(!0),d.Inst.event(g.EventType.RefreshWeaponHolder),l.save(),t.close(!0))}))},a.onShow=function(e){var n=r.weapon.get(e);this.initPageItem(this.node,n),p.game.pause=!0},a.onDisable=function(){p.game.pause=!1},a.initPageItem=function(e,n){this.GetGameObject("lbl_name",e,!0).getComponent(o).string=n.name,e.cfg=n;var t=l.game.getWeapon(n.id).level,a=this.GetGameObject("icon",e,!0).getComponent(i);t>18?this.setSpriteFrame(a,"textures/gun_icons/"+n.icon+"Gold/spriteFrame","game"):this.setSpriteFrame(a,"textures/gun_icons/"+n.icon+"/spriteFrame","game"),this.GetGameObject("lbl_ss",e,!0).getComponent(o).string=(1/r.weapon.getAtkRate(n.id,t)).toFixed(0)+"",this.GetGameObject("lbl_sh",e,!0).getComponent(o).string=r.weapon.getAtk(n.id,t)+"",this.lbl_upgrade_coin.string=n.unlock_diamonds+"",this.unlock_diamonds=n.unlock_diamonds},t}(s))||m);t._RF.pop()}}}));

System.register("chunks:///_virtual/UpgradeConfig.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ConfigAuto.ts"],(function(t){var e,n,r;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy},function(t){r=t.UpgradeConfigAuto}],execute:function(){n._RF.push({},"4d1a22g6sZKCrng3EJQGe5N","UpgradeConfig",void 0);t("default",function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var r=n.prototype;return r.getPlayerHpByLv=function(t){return this.get(1).value[t-1]},r.getPlayerSpeedByLv=function(t){return this.get(2).value[t-1]},r.getPlayerHpCostByLv=function(t){return this.get(1).cost[t-1]},r.getPlayerSpeedCostByLv=function(t){return this.get(2).cost[t-1]},n}(r));n._RF.pop()}}}));

System.register("chunks:///_virtual/Utils.ts",["cc","./AssetPool.ts","./AudioMgr.ts"],(function(n){var t,r,o,e,a,i,u,l,c,s,f,d,h,v,g;return{setters:[function(n){t=n.cclegacy,r=n.sys,o=n.builtinResMgr,e=n.assetManager,a=n.SpriteFrame,i=n.log,u=n.Vec3,l=n.tween,c=n.UITransform,s=n.find,f=n.v3,d=n.v2,h=n.Tween},function(n){v=n.default},function(n){g=n.AudioMgr}],execute:function(){t._RF.push({},"bc826sgjGdKu5f64Qmi5cXh","Utils",void 0);n("default",function(){function n(){}return n.lerp=function(n,t,r){return n+(t-n)*r},n.clampf=function(n,t,r){if(t>r){var o=t;t=r,r=o}return n<t?t:n<r?n:r},n.randomItem=function(n){return n&&n.length>0?n[this.getRandomInt(0,n.length-1)]:null},n.objectToArray=function(n){var t=[];for(var r in n)n.hasOwnProperty(r)&&t.push(n[r]);return t},n.getRandom=function(n,t){return Math.random()*(t-n)+n},n.getRandomInt=function(n,t){return Math.floor(Math.random()*(t-n))+n},n.showTip=function(n){r.platform==r.Platform.WECHAT_GAME&&(window.wx||window.tt).showToast({title:n,icon:"none",duration:1500})},n.formatSecond=function(n){(n=Math.floor(n))<0&&(n=0);var t=Math.floor(n/3600/24);n-=3600*t*24;var r=Math.floor(n/3600);n-=3600*r;var o=Math.floor(n/60),e="00";e=r>9?""+r:"0"+r;var a="00";a=o>9?""+o:"0"+o;var i="00";return i=(n-=60*o)>9?""+n:"0"+n,t>0?t+"天"+r+"时"+o+"分":r>0?e+":"+a:a+":"+i},n.weight=function(n){for(var t=0,r=0;r<n.length;++r)t+=n[r];if(t<=0)return-1;var o=Math.round(Math.random()*Number.MAX_VALUE)%t;for(r=0;r<n.length;++r){if(o<n[r])return r;o-=n[r]}return-1},n.shuffle=function(n){for(var t=n.length-1;t>=0;t--){var r=Math.floor(Math.random()*(t+1)),o=n[r];n[r]=n[t],n[t]=o}return n},n.setGray=function(n,t){t?n.setMaterial(o.get("2d-gray-sprite"),0):n.setMaterial(o.get("2d-sprite"),0)},n.setSpriteFrame=function(n,t,r,o){void 0===r&&(r="resources"),void 0===o&&(o=null),e.getBundle(r).load(t,a,(function(r,e){r?i("error",t):(n.spriteFrame=e,o&&o())}))},n.randomArray=function(n){for(var t=[],r=n.length,o=0;o<r;o++){var e=Math.floor(Math.random()*n.length);t.push(n[e]),n.splice(e,1)}return t},n.bezierTo=function(n,t,r,o,e,a){a=a||Object.create(null);return a.onUpdate=function(t,a){n.worldPosition=function(n,t,r,o){var e=(1-n)*(1-n)*t.x+2*n*(1-n)*r.x+n*n*o.x,a=(1-n)*(1-n)*t.y+2*n*(1-n)*r.y+n*n*o.y,i=(1-n)*(1-n)*t.z+2*n*(1-n)*r.z+n*n*o.z;return new u(e,a,i)}(a,r,o,e)},l(n).to(t,{},a)},n.getCache=function(n){var t=r.localStorage.getItem(n);return null==t||"null"==t||null==t||""==t||"NaN"==t?null:t},n.setCache=function(n,t){r.localStorage.setItem(n,t)},n.loadRes=function(n,t,r,o){e.loadBundle(t,(function(t,e){t?i("加载失败",t):e.load(n,r,o)}))},n.loadResAsync=function(n,t,r){return void 0===r&&(r="game"),new Promise((function(o,a){e.loadBundle(r,(function(r,e){if(r)return i(r),void a(null);e.load(n,t,(function(t,e){if(t)return i(n,r),void a(null);o(e)}))}))}))},n.angle=function(n,t){var r=(n.x*t.x+n.y*t.y+n.z*t.z)/(Math.sqrt(n.x*n.x+n.y*n.y+n.z*n.z)*Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z));return r<-1&&(r=-1),r>1&&(r=1),180*Math.acos(r)/Math.PI},n.pointToSegmentDist=function(n,t,r){var o=(r.x-t.x)*(n.x-t.x)+(r.z-t.z)*(n.z-t.z);if(o<=0)return Math.sqrt((n.x-t.x)*(n.x-t.x)+(n.z-t.z)*(n.z-t.z));var e=(r.x-t.x)*(r.x-t.x)+(r.z-t.z)*(r.z-t.z);if(o>=e)return Math.sqrt((n.x-r.x)*(n.x-r.x)+(n.z-r.z)*(n.z-r.z));var a=o/e,i=t.x+(r.x-t.x)*a,u=t.z+(r.z-t.z)*a;return Math.sqrt((n.x-i)*(n.x-i)+(u-n.z)*(u-n.z))},n.angleLerp=function(n,t,r){var o=t-n;return o<-180?o+=360:o>180&&(o-=360),(n+=o*r)>360&&(n-=360),n<0&&(n+=360),n},n.flyAnim=function(n,t,r,o,e,a){void 0===o&&(o=10),void 0===e&&(e=100),void 0===a&&(a=null);for(var i=t.parent.getComponent(c).convertToWorldSpaceAR(t.position),p=function(n,t,r,o){for(var e=[],a=Math.PI/180*Math.round(360/o),i=0;i<o;i++){var u=t+n*Math.sin(a*i),l=r+n*Math.cos(a*i);e.unshift(d(u,l))}return e}(e,(i=s("Canvas").getComponent(c).convertToNodeSpaceAR(i)).x,i.y,o),x=[],m=0;m<p.length;m++){var M=v.Instance().createObject(n);M.parent=s("Canvas"),M.name="gg";var z=f(p[m].x+50*Math.random(),p[m].y+50*Math.random(),0);M.position=z,x.push({gold:M,randPos:z})}var y=!1,w=r.parent.getComponent(c).convertToWorldSpaceAR(r.position);w=s("Canvas").getComponent(c).convertToNodeSpaceAR(w);for(var A=0,T=function(){var n=x[I].randPos,o=x[I].gold;x[I].gold.id=I,l(o).to(.1,{position:new u(n.x,n.y)}).delay(.1*I).to(.5,{position:new u(w.x,w.y)},{easing:"backIn"}).call((function(){g.Instance().playSFX("gold_get"),!y&&r&&(h.stopAllByTarget(r),r.scale=f(1,1,1),y=!0,l(r).to(.1,{scale:new u(1.5,1.5)}).to(.1,{scale:new u(1,1)}).call((function(){y=!1})).start()),1===++A&&t&&r&&a&&a(o.id===x.length-1),v.Instance().put(o)})).start()},I=0;I<x.length;I++)T()},n}());t._RF.pop()}}}));

System.register("chunks:///_virtual/Water.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,r,n,s,i;return{setters:[function(e){t=e.inheritsLoose},function(e){r=e.cclegacy,n=e._decorator,s=e.MeshRenderer,i=e.Component}],execute:function(){var o;r._RF.push({},"e4c77Hap9ZCt6u87MizK0Jx","Water",void 0);var a=n.ccclass;n.property,e("Water",a("Water")(o=function(e){function r(){for(var t,r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(t=e.call.apply(e,[this].concat(n))||this)._meshRenderer=null,t}t(r,e);var n=r.prototype;return n.start=function(){this._meshRenderer=this.node.getComponent(s)},n.update=function(e){if(this._meshRenderer){var t=this._meshRenderer.material.getProperty("tilingOffset");t.z+=.01*e,t.w+=.01*e,this._meshRenderer.material.setProperty("tilingOffset",t)}},r}(i))||o);r._RF.pop()}}}));

System.register("chunks:///_virtual/WeaponConfig.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ConfigAuto.ts"],(function(t){var n,e,o;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy},function(t){o=t.WeaponConfigAuto}],execute:function(){e._RF.push({},"65ce22F5Z5D256Vtb/HV3PD","WeaponConfig",void 0);t("default",function(t){function e(){return t.apply(this,arguments)||this}n(e,t);var o=e.prototype;return o.getAtk=function(t,n){return this.get(t).atk+n*this.get(t).upgrade_atk},o.getAtkRate=function(t,n){return 1/this.get(t).fire_rate},o.getUpgradeCoin=function(t,n){var e=this.get(t);return e.upgrade_coin+n*e.upgrade_coin_add},o.isWeaponGold=function(t,n){return n>18},e}(o));e._RF.pop()}}}));

System.register("chunks:///_virtual/WeaponHolder.ts",["./rollupPluginModLoBabelHelpers.js","cc","./MapItemBase.ts","./Config.ts","./Model.ts","./ResHelper.ts","./GameConst.ts","./Global.ts","./Player.ts","./WindowManager.ts","./Utils.ts"],(function(e){var n,t,o,r,i,a,s,p,u,c,l,d,f,h,g,W,w,y,v,I,m;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,o=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){i=e.cclegacy,a=e._decorator,s=e.CCInteger,p=e.Prefab,u=e.instantiate,c=e.v3,l=e.Vec3},function(e){d=e.default},function(e){f=e.default},function(e){h=e.default},function(e){g=e.default},function(e){W=e.FacilityAreaType,w=e.default},function(e){y=e.Global},function(e){v=e.Player},function(e){I=e.default},function(e){m=e.default}],execute:function(){var N,b,E,P,R;i._RF.push({},"310e2tVY+xEm5BoWKFnifDI","WeaponHolder",void 0);var _=a.ccclass,H=a.property;e("WeaponHolder",(N=_("WeaponHolder"),b=H({type:s}),N((R=n((P=function(e){function n(){for(var n,t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return n=e.call.apply(e,[this].concat(i))||this,o(n,"weaponId",R,r(n)),n._trigger=!1,n.currentWeponNode=null,n.ry=0,n}t(n,e);var i=n.prototype;return i.initArea=function(){if(-1!=this.weaponId){var e=h.game.getWeapon(this.weaponId);e&&e.unlock&&(this.weaponId=-1)}this.refreshWeapon(),this.triggerAreaList.push({type:W.GROUND_WEAPON,pos:this.node.worldPosition,dis:1,checkType:0})},i.onEnable=function(){this.AddEvent(w.EventType.RefreshWeaponHolder,this.refreshWeapon.bind(this))},i.refreshWeapon=function(){var e=h.game.getWeapon(this.weaponId);if(e&&e.unlock&&(this.weaponId=-1),this.weaponId==h.game.currentWeapon&&(this.weaponId=-1),-1==this.weaponId){var n=f.weapon.values.filter((function(e){var n=h.game.getWeapon(e.id);return n&&0==n.unlock}));if(0==n.length)return void(this.node.active=!1);(n=m.shuffle(n)).length>0&&(this.weaponId=n[0].id)}this.loadWeapon()},i.onTriggerEnter=function(e,n){e instanceof v&&(y.game.running||this._trigger||I.Instance().open(w.winPath.UnlockWeaponWin,this.weaponId))},i.onTriggerExit=function(e,n){},i.loadWeapon=function(){var e=this;if(null!=this.currentWeponNode&&(this.currentWeponNode.destroy(),this.currentWeponNode=null),-1!=this.weaponId){var n=f.weapon.get(this.weaponId);g.loadResSync("prefabs/guns/"+(null==n?void 0:n.weapon_prefab),"game",p).then((function(n){e.currentWeponNode=u(n),e.node.addChild(e.currentWeponNode),e.currentWeponNode.setPosition(c(0,1,0)),e.currentWeponNode.setRotationFromEuler(l.ZERO),e.currentWeponNode.setScale(c(2,2,2))}))}},i.update=function(e){this.currentWeponNode&&this.currentWeponNode.setRotationFromEuler(c(0,this.ry++,0))},n}(d)).prototype,"weaponId",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-1}}),E=P))||E));i._RF.pop()}}}));

System.register("chunks:///_virtual/WeaponWin.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BasePanel.ts","./EventManager.ts","./Config.ts","./Model.ts","./MsgHints.ts","./AdManager.ts","./GameConst.ts","./Global.ts"],(function(e){var t,n,a,i,o,s,g,r,c,p,u,l,d,h,_;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,a=e._decorator,i=e.Sprite,o=e.instantiate,s=e.Label,g=e.Color},function(e){r=e.default},function(e){c=e.EventManager},function(e){p=e.default},function(e){u=e.default},function(e){l=e.default},function(e){d=e.default},function(e){h=e.default},function(e){_=e.Global}],execute:function(){var m;n._RF.push({},"71d9fVHJ+FJWpT6VsGpuTsf","WeaponWin",void 0);var f=a.ccclass;a.property,e("WeaponWin",f("WeaponWin")(m=function(e){function n(){for(var t,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(t=e.call.apply(e,[this].concat(a))||this).btn_pre=null,t.btn_next=null,t.page_weapons=null,t.content=null,t.upgrade_coin=0,t.upgrade_gem=0,t.btn_upgrade_coin=null,t.btn_upgrade_ad=null,t.lbl_buttontitle=null,t.icon_gem=null,t.icon_coin=null,t.lbl_upgrade_coin=null,t}t(n,e);var a=n.prototype;return a.onBtnClicked=function(e,t){var n=this;if("btn_close"==t)this.close(!0);else if("btn_pre"==t)this.page_weapons.setCurrentPageIndex(this.page_weapons.getCurrentPageIndex()-1),this.refreshBtnState();else if("btn_next"==t)this.page_weapons.setCurrentPageIndex(this.page_weapons.getCurrentPageIndex()+1),this.refreshBtnState();else if("btn_upgrade_coin"==t)if(u.game.money>=this.upgrade_coin&&u.game.gem>=this.upgrade_gem){u.game.money-=this.upgrade_coin,u.game.gem-=this.upgrade_gem,u.game.upgradeWeapon(this.page_weapons.getCurrentPageIndex()),u.task.upgradeWeapon();var a=this.page_weapons.getPages()[this.page_weapons.getCurrentPageIndex()];this.initPageItem(a,a.cfg),this.refreshUpgradeBtn(),u.save()}else u.game.gem<this.upgrade_gem?l.show("钻石不足"):u.game.money<this.upgrade_coin&&l.show("金币不足");else"btn_upgrade_ad"==t&&d.showVideo((function(e){if(0==e){u.task.upgradeWeapon(),u.game.upgradeWeapon(n.page_weapons.getCurrentPageIndex());var t=n.page_weapons.getPages()[n.page_weapons.getCurrentPageIndex()];n.initPageItem(t,t.cfg),n.refreshUpgradeBtn(),u.save()}}))},a.refreshBtnState=function(){this.btn_pre.interactable=this.page_weapons.getCurrentPageIndex()>0,this.btn_next.interactable=this.page_weapons.getCurrentPageIndex()<this.page_weapons.getPages().length-1,this.btn_pre.getComponent(i).grayscale=!this.btn_pre.interactable,this.btn_next.getComponent(i).grayscale=!this.btn_next.interactable},a.onShow=function(){var e=this;p.weapon.values.forEach((function(t,n){var a=e.content.children[n];a||(a=o(e.content.children[0]),e.page_weapons.addPage(a)),e.initPageItem(a,t)})),this.page_weapons.setCurrentPageIndex(u.game.currentWeapon),this.refreshBtnState(),this.refreshUpgradeBtn()},a.onEnable=function(){var e=this;c.Inst.on(h.EventType.WeaponUnlock,this,(function(t){var n=e.page_weapons.getCurrentPageIndex(),a=e.page_weapons.getPages()[n].cfg;a.id==t&&(console.log("切换武器",a.name),u.game.currentWeapon=e.page_weapons.getCurrentPageIndex(),c.Inst.event(h.EventType.SWITCH_WEAPON))}))},a.initPageItem=function(e,t){this.GetGameObject("lbl_name",e,!0).getComponent(s).string=t.name,e.cfg=t;var n=u.game.getWeapon(t.id),a=n.level,o=this.GetGameObject("icon",e,!0).getComponent(i);this.GetGameObject("node_equiped",e,!0).active=u.game.currentWeapon==t.id,a>18?this.setSpriteFrame(o,"textures/gun_icons/"+t.icon+"Gold/spriteFrame","game"):this.setSpriteFrame(o,"textures/gun_icons/"+t.icon+"/spriteFrame","game"),o.color=n.unlock?g.WHITE:g.BLACK,this.GetGameObject("lbl_ss",e,!0).getComponent(s).string=(1/p.weapon.getAtkRate(t.id,a)).toFixed(0)+"",this.GetGameObject("lbl_sh",e,!0).getComponent(s).string=p.weapon.getAtk(t.id,a)+"";var r=this.GetGameObject("node_lv",e,!0),c=a%6;r.children.forEach((function(e,t){e.children[0].active=t<c||a>18})),this.GetGameObject("node_stars",e,!0).children.forEach((function(e,t){e.children[0].active=t<Math.floor(a/6)}))},a.onPageEvent=function(e,t){var n=this,a=this.page_weapons.getCurrentPageIndex(),i=this.page_weapons.getPages()[a].cfg;u.game.getWeapon(i.id).unlock&&(console.log("切换武器",i.name),u.game.currentWeapon=this.page_weapons.getCurrentPageIndex(),c.Inst.event(h.EventType.SWITCH_WEAPON)),this.content.children.forEach((function(e){var t=e.cfg;n.GetGameObject("node_equiped",e,!0).active=u.game.currentWeapon==t.id})),this.refreshUpgradeBtn()},a.refreshUpgradeBtn=function(){var e=this.page_weapons.getCurrentPageIndex(),t=this.page_weapons.getPages()[e].cfg;this.btn_upgrade_coin.node.active=!1,this.btn_upgrade_ad.node.active=!1;var n=u.game.getWeapon(t.id),a=n.level;if(19==a);else if(18==a)this.btn_upgrade_coin.node.active=!0,this.icon_coin.active=!1,this.icon_gem.active=!0,this.lbl_upgrade_coin.string=t.golden_diamonds+"",this.upgrade_coin=0,this.upgrade_gem=t.golden_diamonds,this.lbl_buttontitle.string="金色";else if(this.btn_upgrade_coin.node.active=!0,this.btn_upgrade_ad.node.active=!0,!n.unlock&&t.unlock_diamonds>0)this.icon_coin.active=!1,this.icon_gem.active=!0,this.lbl_upgrade_coin.string=t.unlock_diamonds+"",this.lbl_buttontitle.string="解锁",this.upgrade_coin=0,this.upgrade_gem=t.unlock_diamonds;else{this.icon_coin.active=!0,this.icon_gem.active=!1;var i=p.weapon.getUpgradeCoin(t.id,a);this.lbl_upgrade_coin.string=i+"",this.lbl_buttontitle.string="升级",this.upgrade_coin=i,this.upgrade_gem=0}},a.onDisable=function(){_.game.pause=!1},n}(r))||m);n._RF.pop()}}}));

System.register("chunks:///_virtual/WindowManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ResHelper.ts","./BusyLoadingManager.ts","./Singleton.ts","./GameConst.ts"],(function(n){var e,i,t,o,a,r,s,u,d,l,c,w,h,p;return{setters:[function(n){e=n.inheritsLoose,i=n.asyncToGenerator,t=n.regeneratorRuntime},function(n){o=n.cclegacy,a=n.Node,r=n.Widget,s=n.Prefab,u=n.instantiate},function(n){d=n.default},function(n){l=n.default,c=n.BUSY_TYPE},function(n){w=n.default},function(n){h=n.E_UILAYER,p=n.default}],execute:function(){o._RF.push({},"8a710vKh15HWYEUy98vA/8i","WindowManager",void 0);n("default",function(n){function o(){for(var e,i=arguments.length,t=new Array(i),o=0;o<i;o++)t[o]=arguments[o];return(e=n.call.apply(n,[this].concat(t))||this)._windowContainer=void 0,e._windows={},e.uiLayerMap=new Map,e.loadingwin={},e}e(o,n);var w=o.prototype;return w.register=function(n){for(var e in this._windowContainer=n,this._windows={},this.uiLayerMap=new Map,h){var i=new a(e);n.addChild(i);var t=i.addComponent(r);t.left=t.right=t.top=t.bottom=0,t.isAlignBottom=t.isAlignLeft=t.isAlignTop=t.isAlignRight=!0,t.updateAlignment(),this.uiLayerMap.set(e,[])}},w.getLayer=function(n){return this._windowContainer.getChildByName(n)},w.closeAll=function(n){var e=this;void 0===n&&(n=p.winPath.GameWin),this.uiLayerMap.forEach((function(i,t){for(var o=i.length-1;o>=0;o--)i[o].winInfo!=n&&e.removeWindow(i[o].winInfo)}))},w.open=function(){var n=i(t().mark((function n(e,i,o,a){var r=this;return t().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=!0),!this.loadingwin[e.path+e.name]){n.next=6;break}return console.log("已经在加载中..."),n.abrupt("return");case 6:return console.log("open window",e.name),n.abrupt("return",new Promise((function(n,t){var w=e.layer?e.layer:h.popup,p=r.uiLayerMap.get(w),f="";if(p.length>0){var g=p[p.length-1];g.winInfo.name!=e.name&&(f=g.winInfo.name)}if(i||(i={}),o&&(i.onClose=o),null==r._windows[e.name])a&&l.ins.addBusy(c.RES),r.loadingwin[e.path+e.name]=!0,d.loadRes(e.path+e.name,e.bundle,s,(function(t,o){r.loadingwin[e.path+e.name]=!1,""!=f&&r.hide(f),t&&console.error(t);var s=u(o);s.parent=r.getLayer(e.layer||h.popup);var d=s.getComponent(s.name);d.winInfo=e,r._windows[e.name]=d,d.onCreate(i),d.onShow(i),r.checkStack(p,d),p.push(d),a&&l.ins.removeBusy(c.RES),n(d)}));else{""!=f&&r.hide(f),r.checkStack(p,r._windows[e.name]);var v=r._windows[e.name];p.push(v),v.node.active?(v.onShow(i),n(v)):(v.node.active=!0,v.onShow(i),n(v))}})));case 8:case"end":return n.stop()}}),n,this)})));return function(e,i,t,o){return n.apply(this,arguments)}}(),w.checkStack=function(n,e){var i=n.indexOf(e);i>=0&&(n=n.splice(i,1))},w.removeWindow=function(n,e){void 0===e&&(e=!0);var i,t=n.layer?n.layer:h.popup,o=this.uiLayerMap.get(t);if(o.length>0){var a=o[o.length-1];a.winInfo===n&&(a.data.onClose&&a.data.onClose(),a.onHide(),o.pop()),(a=o[o.length-1])&&a.node&&(a.node.active=!0,a.onShow(a.data))}e?(i=this._windows[n.name])&&(i.onRecycle(),i.node.destroy(),this._windows[n.name]=null,delete this._windows[n.name]):(i=this._windows[n.name])&&(i.node.active=!1)},w.getWin=function(n){return this._windows[n]?this._windows[n]:null},w.hide=function(n){var e=this._windows[n];e&&(e.onHide(),e.node.active=!1)},o}(w));o._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});