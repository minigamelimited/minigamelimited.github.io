"use strict";function Polyglot(t){t=t||{},this.phrases={},this.extend(t.phrases||{}),this.currentLocale=t.locale||"en",this.allowMissing=!!t.allowMissing,this.warn=t.warn||warn}Polyglot.VERSION="0.4.3",Polyglot.prototype.locale=function(t){return t&&(this.currentLocale=t),this.currentLocale},Polyglot.prototype.extend=function(t,e){let n;for(let i in t)Object.hasOwnProperty.call(t,i)&&(n=t[i],e&&(i=e+"."+i),"object"==typeof n?this.extend(n,i):this.phrases[i]=n)},Polyglot.prototype.clear=function(){this.phrases={}},Polyglot.prototype.replace=function(t){this.clear(),this.extend(t)},Polyglot.prototype.t=function(t,...e){let n,i,l;if(0==e.length)l={};else if(1==e.length&&"object"==typeof e[0])l=e[0];else{l={};for(let t=0;t<e.length;t++)"string"!=typeof e[t]&&"number"!=typeof e[t]||(l[t+1]=e[t])}return"string"==typeof this.phrases[t]?n=this.phrases[t]:"string"==typeof l._?n=l._:this.allowMissing?n=t:(this.warn('Missing translation for key: "'+t+'"'),i=t),"string"==typeof n&&(l=clone(l),i=interpolate(i=choosePluralForm(n,this.currentLocale,l.smart_count),l)),i},Polyglot.prototype.has=function(t){return t in this.phrases};let delimeter="||||",pluralTypes={chinese:function(){return 0},german:function(t){return 1!==t?1:0},french:function(t){return t>1?1:0},russian:function(t){return t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2},czech:function(t){return 1===t?0:t>=2&&t<=4?1:2},polish:function(t){return 1===t?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2},icelandic:function(t){return t%10!=1||t%100==11?1:0}},pluralTypeToLanguages={chinese:["fa","id","ja","ko","lo","ms","th","tr","zh"],german:["da","de","en","es","fi","el","he","hu","it","nl","no","pt","sv"],french:["fr","tl","pt-br"],russian:["hr","ru"],czech:["cs"],polish:["pl"],icelandic:["is"]};function langToTypeMap(t){let e,n,i,l={};for(e in t)if(Object.hasOwnProperty.call(t,e))for(i in n=t[e])l[n[i]]=e;return l}function trim(t){return t.replace(/^\s+|\s+$/g,"")}function choosePluralForm(t,e,n){let i,l;return null!=n&&t?trim(l=(i=t.split(delimeter))[pluralTypeIndex(e,n)]||i[0]):t}function pluralTypeName(t){let e=langToTypeMap(pluralTypeToLanguages);return e[t]||e.en}function pluralTypeIndex(t,e){return pluralTypes[pluralTypeName(t)](e)}function interpolate(t,e){for(let n in e)"_"!==n&&Object.hasOwnProperty.call(e,n)&&(t=t.replace(new RegExp("\\{"+n+"\\}","g"),e[n]));return t}function warn(t){cc.warn("WARNING: "+t)}function clone(t){let e={};for(let n in t)e[n]=t[n];return e}function I18nManager(){this.inited=!1,this.curLang="",this._polyInst=new Polyglot({phrases:{},allowMissing:!0}),this._localesHandler=null,this._localesTTFHandler=null,this._ttfUuids=null,this.ttf=null}I18nManager.prototype.extendText=function(t,e){this._polyInst.extend(t,e)},I18nManager.prototype.replaceText=function(t){this._polyInst.replace(t)},I18nManager.prototype.clearText=function(){this._polyInst.clear()},I18nManager.prototype.t=function(t,...e){return this._polyInst.t(t,...e)},I18nManager.prototype.initLocalesHandler=function(t){this._localesHandler=t},I18nManager.prototype.initLocalesTTFHandler=function(t,e){this._localesTTFHandler=t,this._ttfUuids=e},I18nManager.prototype.init=function(t,e){if(t===this.curLang)return;t||(t=this.curLang||"zh"),this.curLang=t,this._localesHandler||(this._localesHandler=this.defaultLocalesHandler);let n=!this._localesHandler,i=!this._localesTTFHandler;if(n&&i)return this.inited=!0,e&&e();this._localesHandler&&this._localesHandler(t,(t,l)=>{this.extendText(t,l),n=!0,this.inited=n&&i,this.inited&&e()}),this._localesTTFHandler&&this._localesTTFHandler(t,t=>{if(this.ttf=t,this.ttf){let t=cc.Label.prototype.onLoad;cc.Label.prototype.onLoad=function(){if(t.call(this),this.cacheMode=cc.Label.CacheMode.CHAR,!this.font&&this.useSystemFont)this.font=i18n.ttf;else{let t=this.font._uuid;i18n._ttfUuids[t]&&t!=i18n.ttf._uuid&&(this.font=i18n.ttf)}};let e=cc.RichText.prototype.onLoad;cc.RichText.prototype.onLoad=function(){if(e&&e.call(this),this.cacheMode=cc.Label.CacheMode.CHAR,!this.font&&this.useSystemFont)this.font=i18n.ttf;else{let t=this.font._uuid;i18n._ttfUuids[t]&&t!=i18n.ttf._uuid&&(this.font=i18n.ttf)}}}i=!0,this.inited=n&&i,this.inited&&e()})},I18nManager.prototype.fullPath=function(t){return"i18n/"+this.curLang+"/"+t},I18nManager.prototype.updateSceneRenderers=null;let i18nMgr=new I18nManager;window.i18n=i18nMgr;